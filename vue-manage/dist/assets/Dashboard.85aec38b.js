var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,r=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,o=(e,a)=>{for(var t in a||(a={}))n.call(a,t)&&r(e,t,a[t]);if(l)for(var t of l(a))i.call(a,t)&&r(e,t,a[t]);return e},s=(e,l)=>a(e,t(l));import{b as d,f as u,r as c,o as p,h as m,k as g,l as h,i as b,t as y,m as f,I as w,c as _,p as v,q as x,s as C,x as T}from"./vendor.ac52fd94.js";import{u as k}from"./ColSpan.be2d1729.js";import{i as j}from"./index.9abe9c67.js";import{_ as z,h as S,a as A,s as V,i as I,t as N,j as L,f as O}from"./index.1d57ac4a.js";const P={name:"dashboard",setup(){const e=d({userAddCount:0,userCount:0,tof:0,tsc:0,tac:0,bl:"",cbr:0,money:0,sumAmount:0,paidAmount:0,unpaidAmount:0,byAmount:0,czAmount:0}),a=d([]),{objectSpanMethod:t,getSpanArr:l}=k(),n=u({time:""}),i=u({pageNum:1,pageSize:10,name:"",startTime:"",endTime:"",time:"",roadId:"",type:"0",parking_type:"0"}),r=u({variance:1,pageType:1,roadId:""});(()=>{var e=new Date;n.time=[e,e];var a=e.getDate(),t=e.getMonth()+1;t<10&&(t="0"+t),a<10&&(a="0"+a),i.startTime=e.getFullYear().toString()+"-"+t.toString()+"-"+a.toString(),i.endTime=i.startTime})();const c=e=>`${e.getFullYear()}-${e.getMonth()+1>=10?e.getMonth()+1:"0"+(e.getMonth()+1)}-${e.getDate()>=10?e.getDate():"0"+e.getDate()}`,p=d([]),m=d(0),g=()=>{i.pageNum=1,""!=i.name&&null!=i.name&&null!=i.name||(i.roadId="",r.roadId=""),b()},h=e=>{null!=e&&null!=e&&""!=e&&(i.roadId=e.id,r.roadId=e.id,i.name=e.title),g(),y(),f()},b=()=>{V(i).then((t=>{const n=[];t.data.data.list.forEach((e=>{0==e.paymentOrderList.length?n.push(s(o({},e),{months_unit_price:"0.00",amount:"0.00",months:0})):e.paymentOrderList.forEach((a=>{const{months_unit_price:t,amount:l,months:i}=a;n.push(s(o({},e),{months_unit_price:t,amount:l,months:i}))}))})),a.value=n,l(n),m.value=t.data.data.total,e.value=t.data.vo}))},y=()=>{I(r).then((e=>{M.xAxis[0].data=e.data.dates,M.series[0].data=e.data.ysList,M.series[1].data=e.data.ssList;var a=document.getElementById("main");a.removeAttribute("_echarts_instance_"),j(a).setOption(M)}))},f=()=>{N(r).then((e=>{B.xAxis[0].data=e.data.dates,B.series[0].data=e.data.zong,B.series[1].data=e.data.yingj,B.series[2].data=e.data.yij;var a=document.getElementById("mainline");a.removeAttribute("_echarts_instance_"),j(a).setOption(B)}))};b(),y(),f();const w=d(!1),_=d("订单列表"),v=d([]),C=u({pageNum:1,pageSize:10,startTime:"",endTime:"",roadId:"",pageType:"",parking_type:"0"}),T=d(0);let z=setInterval((()=>{g()}),6e4);const P=d(!1),q=d("包月收入明细"),D=d([]),$=u({pageNum:1,pageSize:10,startTime:"",endTime:"",roadId:"",pageType:"",parking_type:"0"}),Q=d(0),U=localStorage.getItem("ms_username"),E="admin"===U?"超级管理员":"普通用户",F=u([{name:"2018/09/04",value:1083},{name:"2018/09/05",value:941},{name:"2018/09/06",value:1139},{name:"2018/09/07",value:816},{name:"2018/09/08",value:327},{name:"2018/09/09",value:228},{name:"2018/09/10",value:1065}]),M={title:{text:"近十天应收实收款",textStyle:{fontSize:16,fontWeight:"normal",color:"#303133"}},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{data:["应收款","实收款"]},toolbox:{feature:{saveAsImage:{}}},grid:{left:"10px",right:"16px",bottom:"3%",containLabel:!0},xAxis:[{type:"category",axisTick:{show:!1},data:[]}],yAxis:[{type:"value"}],series:[{name:"应收款",type:"bar",data:[]},{name:"实收款",type:"bar",data:[]}]},B={title:{text:"近十天订单趋势",show:!0,textStyle:{fontSize:16,fontWeight:"normal",color:"#303133"}},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{data:["订单总数","应缴费数","已缴费数"]},toolbox:{feature:{saveAsImage:{}}},grid:{left:"10px",right:"16px",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:[]}],yAxis:[{type:"value"}],series:[{name:"订单总数",type:"line",areaStyle:{},emphasis:{focus:"series"},data:[]},{name:"应缴费数",type:"line",areaStyle:{},emphasis:{focus:"series"},data:[]},{name:"已缴费数",type:"line",areaStyle:{},emphasis:{focus:"series"},data:[]}]};return{query:i,query2:r,queryTime:n,census:e,name:U,data:F,options:{type:"bar",title:{text:"近十天应收实收款",textStyle:{fontSize:16,fontWeight:"normal",color:"#303133"}},xRorate:25,labels:["12-19","12-20","12-21","12-22","12-23","12-24","12-25","12-26","12-27","12-28"],datasets:[{label:"应收款",data:[234,278,270,190,230,240,260,270,290,245]},{label:"实收款",data:[164,178,190,135,160,150,180,190,200,147]}]},options2:{type:"line",title:{text:"最近十天订单趋势",textStyle:{fontSize:16,fontWeight:"normal",color:"#303133"}},labels:["12-19","12-20","12-21","12-22","12-23","12-24","12-25","12-26","12-27","12-28"],datasets:[{label:"订单总数",data:[234,278,270,190,230,240,260,270,290,245]},{label:"应缴费数",data:[164,178,190,135,160,150,180,190,200,147]},{label:"已缴费数",data:[74,118,150,105,140,100,130,154,182,95]}]},options3:M,options4:B,todoList:a,role:E,tableData:p,pageTotal:m,rowclick:e=>{var a=e.title;i.name=a,b()},handlePageChange:e=>{i.pageNum=e,b()},getQueryDate:()=>{null==n.time||[]==n.time||""==n.time?(i.startTime="",i.endTime=""):(i.startTime=c(n.time[0]),i.endTime=c(n.time[1]))},handleSearch:g,exportSearch:()=>{x.success("正在下载中·····"),S(i).then((e=>{const a=window.URL.createObjectURL(new Blob([e])),t=document.createElement("a");t.href=a,t.setAttribute("download","路内概览.xls"),document.body.appendChild(t),t.click()}))},exportBymx:()=>{x.success("正在下载中·····"),A(i).then((e=>{const a=window.URL.createObjectURL(new Blob([e])),t=document.createElement("a");t.href=a,t.setAttribute("download","包月收入明细.xls"),document.body.appendChild(t),t.click()}))},parkLink:h,clearPark:()=>{i.roadId="",r.roadId="",h()},viewVisible:w,viewVisible2:P,dialogT:_,dialogT2:q,handleView:(e,a,t)=>{_.value=a.title+"订单列表",C.pageNum=1,C.startTime=i.startTime,C.endTime=i.endTime,C.roadId=a.id,C.pageType=t,L(C).then((e=>{v.value=e.data.list,T.value=e.data.total})),w.value=!0},handleView2:()=>{$.pageNum=1,$.startTime=i.startTime,$.endTime=i.endTime,$.roadId=i.roadId,$.pageType=i.type,O($).then((e=>{D.value=e.data.list,Q.value=e.data.total})),P.value=!0},orderData:v,byData:D,orderQuery:C,byQuery:$,pageTotal2:T,pageTotal3:Q,handlePageChange2:e=>{C.pageNum=e,C.startTime=i.startTime,C.endTime=i.endTime,L(C).then((e=>{v.value=e.data.list,T.value=e.data.total}))},handlePageChange3:e=>{$.pageNum=e,$.startTime=i.startTime,$.endTime=i.endTime,$.roadId=i.roadId,$.pageType=i.type,O($).then((e=>{D.value=e.data.list,Q.value=e.data.total}))},timerSearch:z,objectSpanMethod:t}},methods:{moneyLink(){this.$router.push({path:"/arrearsstatic",query:{menuType:"0",startTime:this.query.startTime,endTime:this.query.endTime}})}},mounted(){}},q=e=>(C("data-v-108ec7e2"),e=e(),T(),e),D={class:"list-box"},$={class:"list-item"},Q={class:"grid-content grid-con-1"},U=q((()=>b("i",{class:"el-icon-s-custom grid-con-icon"},null,-1))),E={class:"grid-cont-right"},F={class:"grid-num"},M=q((()=>b("div",null,"总营收(元)",-1))),B={class:"list-item"},R={class:"grid-content grid-con-2"},W=q((()=>b("i",{class:"el-icon-s-finance grid-con-icon"},null,-1))),H={class:"grid-cont-right"},K={class:"grid-num"},Y=q((()=>b("div",null,"包月收入(元)",-1))),G={class:"list-item"},J={class:"grid-content grid-con-6"},X=q((()=>b("i",{class:"el-icon-s-order grid-con-icon"},null,-1))),Z={class:"grid-cont-right"},ee={class:"grid-num"},ae=q((()=>b("div",null,"临停应收(元)",-1))),te={class:"list-item"},le={class:"grid-content grid-con-3"},ne=q((()=>b("i",{class:"el-icon-success grid-con-icon"},null,-1))),ie={class:"grid-cont-right"},re={class:"grid-num"},oe=q((()=>b("div",null,"临停实收(元)",-1))),se=q((()=>b("div",{class:"clearfix"},[b("span",null,"今日应收款排名(该页面以车辆停入时间统计停车订单收入金额)")],-1))),de={class:"handle-box"},ue={class:"left-panel"},ce=q((()=>b("div",{class:"clear"},null,-1))),pe={class:"pagination"},me=q((()=>b("div",{id:"main",class:"schart"},null,-1))),ge=q((()=>b("div",{id:"mainline",class:"schart"},null,-1))),he={class:"pagination"},be={class:"dialog-footer"},ye={class:"handle-box"},fe={class:"left-panel"},we=q((()=>b("div",{class:"clear"},null,-1))),_e={class:"pagination"},ve={class:"dialog-footer"};var xe=z(P,[["render",function(e,a,t,l,n,i){const r=c("el-card"),o=c("el-link"),s=c("el-tooltip"),d=c("el-input"),u=c("el-form-item"),x=c("el-date-picker"),C=c("el-button"),T=c("el-form"),k=c("el-table-column"),j=c("el-table"),z=c("el-pagination"),S=c("el-col"),A=c("el-row"),V=c("el-tag"),I=c("el-dialog");return p(),m("div",null,[g(A,{gutter:20},{default:h((()=>[g(S,{span:24},{default:h((()=>[b("div",D,[b("div",$,[g(r,{shadow:"hover","body-style":{padding:"0px"}},{default:h((()=>[b("div",Q,[U,b("div",E,[b("div",F,y(l.census.money),1),M])])])),_:1})]),b("div",B,[g(r,{shadow:"hover","body-style":{padding:"0px"}},{default:h((()=>[b("div",R,[W,b("div",H,[g(o,{type:"danger",href:"javascript:;",onClick:a[0]||(a[0]=e=>l.handleView2())},{default:h((()=>[b("div",K,y(l.census.byAmount),1)])),_:1}),Y])])])),_:1})]),b("div",G,[g(r,{shadow:"hover","body-style":{padding:"0px"}},{default:h((()=>[b("div",J,[X,b("div",Z,[b("div",ee,y(l.census.sumAmount),1),ae,g(s,{class:"item",effect:"dark",content:"临停欠费金额(元)",placement:"bottom"},{default:h((()=>[g(o,{type:"danger",href:"javascript:;",onClick:a[1]||(a[1]=e=>i.moneyLink())},{default:h((()=>[f("欠费 "+y(l.census.unpaidAmount)+"元 ",1)])),_:1})])),_:1})])])])),_:1})]),b("div",te,[g(r,{shadow:"hover","body-style":{padding:"0px"}},{default:h((()=>[b("div",le,[ne,b("div",ie,[b("div",re,y(l.census.paidAmount),1),oe])])])),_:1})])]),g(r,{shadow:"hover"},{header:h((()=>[se])),default:h((()=>[b("div",de,[b("div",ue,[g(T,{inline:"","label-width":"80",size:"small",class:"lineH0"},{default:h((()=>[g(u,{label:"路内名称",class:"search-mb0"},{default:h((()=>[g(d,{modelValue:l.query.name,"onUpdate:modelValue":a[2]||(a[2]=e=>l.query.name=e),onKeyup:w(l.handleSearch,["enter"]),size:"small",placeholder:"路内名称",clearable:"",onClear:l.clearPark},null,8,["modelValue","onKeyup","onClear"])])),_:1}),g(u,{label:"停入时间",class:"search-mb0"},{default:h((()=>[g(x,{modelValue:l.queryTime.time,"onUpdate:modelValue":a[3]||(a[3]=e=>l.queryTime.time=e),placeholder:"",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",onChange:l.getQueryDate,clearable:""},null,8,["modelValue","onChange"])])),_:1}),g(u,{label:"",class:"search-mb0"},{default:h((()=>[g(C,{size:"small",type:"primary",icon:"el-icon-search",onClick:l.handleSearch},{default:h((()=>[f("查询 ")])),_:1},8,["onClick"])])),_:1}),g(u,{label:"",class:"search-mb0"},{default:h((()=>[g(C,{size:"small",type:"success",icon:"el-icon-upload2",onClick:l.exportSearch},{default:h((()=>[f("导出 ")])),_:1},8,["onClick"])])),_:1})])),_:1})]),ce]),g(j,{"show-header":!0,height:"380",data:l.todoList,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header","span-method":l.objectSpanMethod},{default:h((()=>[g(k,{label:"路内名称",prop:"title",align:"center"},{default:h((e=>[g(o,{type:"primary",href:"javascript:;",onClick:a=>l.parkLink(e.row)},{default:h((()=>[f(y(e.row.title),1)])),_:2},1032,["onClick"])])),_:1}),g(k,{label:"泊位数",width:"100",align:"center",prop:"stopcarnum"}),g(k,{label:"月租车辆",align:"center"},{default:h((()=>[g(k,{label:"单价",width:"100",align:"center",prop:"months_unit_price"},{default:h((e=>[b("p",null,y(e.row.months_unit_price?e.row.months_unit_price:"0.00"),1)])),_:1}),g(k,{label:"数量",width:"100",align:"center",prop:"months"},{default:h((e=>[b("p",null,y(e.row.months?e.row.months:0),1)])),_:1}),g(k,{label:"金额",width:"100",align:"center",prop:"amount"},{default:h((e=>[b("p",null,y(e.row.amount?e.row.amount:"0.00"),1)])),_:1})])),_:1}),g(k,{label:"临停车辆",align:"center"},{default:h((()=>[g(k,{prop:"counts",label:"订单数",width:"100",align:"center"},{default:h((e=>[g(o,{type:"primary",href:"javascript:;",onClick:a=>l.handleView(e.$index,e.row)},{default:h((()=>[f(y(e.row.counts),1)])),_:2},1032,["onClick"])])),_:1}),g(k,{prop:"counts2",label:"非零订单数",width:"100",align:"center"},{default:h((e=>[g(o,{type:"primary",href:"javascript:;",onClick:a=>l.handleView(e.$index,e.row,0)},{default:h((()=>[f(y(e.row.counts2),1)])),_:2},1032,["onClick"])])),_:1}),g(k,{prop:"sumAmount",label:"应收金额",width:"100",align:"center"},{default:h((e=>[g(o,{type:"primary",href:"javascript:;",onClick:a=>l.handleView(e.$index,e.row,1)},{default:h((()=>[f(y(e.row.sumAmount),1)])),_:2},1032,["onClick"])])),_:1}),g(k,{prop:"paidAmount",label:"实收金额",width:"100",align:"center"},{default:h((e=>[g(o,{type:"primary",href:"javascript:;",onClick:a=>l.handleView(e.$index,e.row,2)},{default:h((()=>[f(y(e.row.paidAmount),1)])),_:2},1032,["onClick"])])),_:1}),g(k,{prop:"unpaidAmount",label:"在停金额",width:"100",align:"center"},{default:h((e=>[g(o,{type:"primary",href:"javascript:;",onClick:a=>l.handleView(e.$index,e.row,3)},{default:h((()=>[f(y(e.row.unpaidAmount),1)])),_:2},1032,["onClick"])])),_:1}),g(k,{prop:"unpaidAmount2",label:"待缴费金额",width:"100",align:"center"},{default:h((e=>[g(o,{type:"primary",href:"javascript:;",onClick:a=>l.handleView(e.$index,e.row,4)},{default:h((()=>[f(y(e.row.unpaidAmount2),1)])),_:2},1032,["onClick"])])),_:1})])),_:1}),g(k,{label:"补缴",align:"center"},{default:h((()=>[g(k,{prop:"bjcs",label:"补缴次数",width:"100",align:"center"},{default:h((e=>[b("p",null,y(e.row.bjcs),1)])),_:1}),g(k,{prop:"bjje",label:"补缴金额",width:"100",align:"center"},{default:h((e=>[b("p",null,y(e.row.bjje),1)])),_:1})])),_:1}),g(k,{label:"收费率",align:"center"},{default:h((()=>[g(k,{prop:"jfs",label:"缴费数",width:"100",align:"center"},{default:h((e=>[b("p",null,y(e.row.jfs),1)])),_:1}),g(k,{prop:"jfl",label:"缴费率",width:"100",align:"center"},{default:h((e=>[b("p",null,y(e.row.jfl),1)])),_:1}),g(k,{prop:"zzl",label:"周转率",width:"100",align:"center"},{default:h((e=>[b("p",null,y(e.row.zzl),1)])),_:1})])),_:1})])),_:1},8,["data","span-method"]),b("div",pe,[g(z,{background:"",layout:"total, prev, pager, next","current-page":l.query.pageNum,"page-size":l.query.pageSize,total:l.pageTotal,onCurrentChange:l.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])])),_:1})])),_:1})])),_:1}),g(A,{gutter:20},{default:h((()=>[g(S,{span:12},{default:h((()=>[g(r,{shadow:"hover"},{default:h((()=>[me])),_:1})])),_:1}),g(S,{span:12},{default:h((()=>[g(r,{shadow:"hover"},{default:h((()=>[ge])),_:1})])),_:1})])),_:1}),g(I,{title:l.dialogT,modelValue:l.viewVisible,"onUpdate:modelValue":a[5]||(a[5]=e=>l.viewVisible=e),width:"1200px"},{footer:h((()=>[b("span",be,[g(C,{onClick:a[4]||(a[4]=e=>l.viewVisible=!1)},{default:h((()=>[f("取 消")])),_:1})])])),default:h((()=>[g(j,{data:l.orderData,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:h((()=>[g(k,{prop:"order_no",label:"订单号",align:"center"}),g(k,{prop:"car_no",label:"车牌号",width:"120",align:"center"},{default:h((e=>["1"==e.row.car_type?(p(),_(V,{key:0,size:"small",textContent:y(e.row.car_no)},null,8,["textContent"])):"2"==e.row.car_type?(p(),_(V,{key:1,size:"small",type:"success",textContent:y(e.row.car_no)},null,8,["textContent"])):"3"==e.row.car_type?(p(),_(V,{key:2,size:"small",type:"warning",textContent:y(e.row.car_no)},null,8,["textContent"])):v("",!0)])),_:1}),g(k,{prop:"drivein_time",label:"驶入时间",width:"180",align:"center"}),g(k,{prop:"driveout_time",label:"驶离时间",width:"180",align:"center"}),g(k,{prop:"resTime",label:"停车时长",width:"100",align:"center"}),g(k,{prop:"sum_amount",width:"100",label:"应收金额",align:"center"},{default:h((e=>[b("p",null,y(Number(e.row.sum_amount).toFixed(2)),1)])),_:1}),g(k,{prop:"paid_amount",width:"100",label:"实收金额",align:"center"},{default:h((e=>[b("p",null,y(Number(e.row.paid_amount).toFixed(2)),1)])),_:1}),g(k,{prop:"unpaid_amount",width:"100",label:"在停/待缴费金额",align:"center"},{default:h((e=>[b("p",null,y(Number(e.row.unpaid_amount).toFixed(2)),1)])),_:1}),g(k,{prop:"status_name",label:"状态",width:"100",align:"center"},{default:h((e=>["1"==e.row.status?(p(),_(V,{key:0,size:"small",textContent:y(e.row.state_name)},null,8,["textContent"])):"2"==e.row.status?(p(),_(V,{key:1,size:"small",type:"success",textContent:y(e.row.state_name)},null,8,["textContent"])):"3"==e.row.status?(p(),_(V,{key:2,size:"small",type:"warning",textContent:y(e.row.state_name)},null,8,["textContent"])):"4"==e.row.status?(p(),_(V,{key:3,size:"small",type:"danger",textContent:y(e.row.state_name)},null,8,["textContent"])):v("",!0)])),_:1})])),_:1},8,["data"]),b("div",he,[g(z,{background:"",layout:"total, prev, pager, next","current-page":l.orderQuery.pageNum,"page-size":l.orderQuery.pageSize,total:l.pageTotal2,onCurrentChange:l.handlePageChange2},null,8,["current-page","page-size","total","onCurrentChange"])])])),_:1},8,["title","modelValue"]),g(I,{title:l.dialogT2,modelValue:l.viewVisible2,"onUpdate:modelValue":a[7]||(a[7]=e=>l.viewVisible2=e),width:"1200px"},{footer:h((()=>[b("span",ve,[g(C,{onClick:a[6]||(a[6]=e=>l.viewVisible2=!1)},{default:h((()=>[f("取 消")])),_:1})])])),default:h((()=>[b("div",ye,[b("div",fe,[g(T,{inline:"","label-width":"80",size:"small",class:"lineH0"},{default:h((()=>[g(C,{size:"small",type:"success",icon:"el-icon-upload2",onClick:l.exportBymx},{default:h((()=>[f(" 导出 ")])),_:1},8,["onClick"])])),_:1})]),we]),g(j,{data:l.byData,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:h((()=>[g(k,{prop:"carNo",label:"车牌",width:"100",align:"center"}),g(k,{prop:"create_time",label:"包月时间",align:"center"}),g(k,{prop:"months_unit_price",label:"单价",align:"center"},{default:h((e=>[b("p",null,y(Number(e.row.months_unit_price).toFixed(2)),1)])),_:1}),g(k,{prop:"months",label:"月数",align:"center"}),g(k,{prop:"amount",label:"总费用",align:"center"},{default:h((e=>[b("p",null,y(Number(e.row.amount).toFixed(2)),1)])),_:1}),g(k,{prop:"configName",label:"包月方案",align:"center"})])),_:1},8,["data"]),b("div",_e,[g(z,{background:"",layout:"total, prev, pager, next","current-page":l.byQuery.pageNum,"page-size":l.byQuery.pageSize,total:l.pageTotal3,onCurrentChange:l.handlePageChange3},null,8,["current-page","page-size","total","onCurrentChange"])])])),_:1},8,["title","modelValue"])])}],["__scopeId","data-v-108ec7e2"]]);export{xe as default};
