import{f as e,b as a,u as t,q as l,r,o as i,h as o,i as s,k as d,l as m,F as u,j as n,c as p,m as h,t as f,p as c}from"./vendor.ac52fd94.js";import{_,F as y,l as b,U as g}from"./index.1d57ac4a.js";import{o as w,g as v}from"./car.4b2589b1.js";import{F as V}from"./file_url.ec979fed.js";const k={name:"carList",data:()=>({isDisabl:!1,whiteStas:!1,whiteTime:!1,whiteStasName:!1,cj_whiteStas:!1,fileurl:V.file_img_url,formRules:{car_no:[{validator:(e,a,t)=>{if(!a)return t(new Error("必填项"));if(1==/[`~!@#$%^&*()_+<>?:"{},.\/;'[\]]/im.test(a)||1==/[·！#￥（——）：；“”‘、，|《。》？、【】[\]]/im.test(a))return t(new Error("车牌号码不能包含特殊字符"));t()},required:!0,trigger:"blur"}],name:[{required:!0,message:"必填项",trigger:"blur"}],phone:[{required:!0,message:"必填项",trigger:"blur"}],deformity_cert:[{required:!0,message:"必填项",trigger:"blur"}],company_name:[{required:!0,message:"必填项",trigger:"blur"}],time_pro:[{required:!0,message:"请选择时间",trigger:"blur"}]}}),setup(){const l=e({car_no:"",car_type:"1",roster_type:"1",whitelist_type:"0",deformity_cert:"",deformity_picture_id:"",company_name:"",name:"",phone:"",cut_off_date:"",parkIds:[],roadIds:[]}),r=a({}),i=a({}),o=a({}),s=a({}),d=a([]),m=a([]);let u=a({time:""});const n=t();(()=>{const e=n.currentRoute.value.query.id;null==e||""==e||v(e).then((e=>{console.log(e.data.car_no),l.car_no=e.data.car_no,l.roster_type=e.data.roster_type}))})();const p=a([]);b().then((e=>{p.value=e.data}));const h=a([]);g().then((e=>{h.value=e.data}));const f=e=>`${e.getFullYear()}-${e.getMonth()+1>=10?e.getMonth()+1:"0"+(e.getMonth()+1)}-${e.getDate()>=10?e.getDate():"0"+e.getDate()}`;return y(e({dict_type:"car_type"})).then((e=>{r.value=e.data})),y(e({dict_type:"rosterType"})).then((e=>{i.value=e.data})),y(e({dict_type:"carNatures"})).then((e=>{o.value=e.data})),y(e({dict_type:"whitelist_type"})).then((e=>{s.value=e.data})),{form:l,carTypeData:r,rosterTypeData:i,carNaturesData:o,whitelistTypeData:s,timeData:u,fileIds:d,file_img:m,parks:p,roads:h,getQueryDate:()=>{null==u.value.time||[]==u.value.time||""==u.value.time?l.cut_off_date="":l.cut_off_date=f(u.value.time)}}},methods:{backPage(){this.$router.push("/carnummana")},handleSuccess(e,a,t){this.fileIds.push(e.id+""),a.id=e.id,this.file_img=a},handlePictureCardPreview(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleRemove(e,a){let t=this.fileIds.indexOf(e.id+"");-1==t?t=this.fileIds.indexOf(e.id):this.fileIds.splice(t,1)},saveEdit(e){let a=this;if("4"==roster_type&&0==a.fileIds.length&&null!=a.fileIds)return l.error("残疾证照片"),!1;a.isDisabl=!0,this.saveCar(e)},saveCar:function(e){let a=this;a.fileIds.length>0&&(a.form.deformity_picture_id=a.fileIds.join(",")),a.$refs[e].validate((e=>{e?w(a.form).then((e=>{0==e.code?(l.success(e.msg),setTimeout((function(){a.isDisabl=!1,a.$router.push("/carnummana")}),3e3)):-1==e.code&&l.error(e.msg)})):a.isDisabl=!1}))},upperCase(){this.form.car_no=this.form.car_no.toUpperCase()},radioBtns(e){this.form.whitelist_type="0","3"==e?(this.form.name="",this.form.deformity_cert="",this.form.cut_off_date="",this.timeData.time="",this.fileIds=[],this.whiteStas=!0,this.whiteStasName=!0,this.cj_whiteStas=!1):"4"==e?(this.form.name="",this.form.phone="",this.form.company_name="",this.whiteStas=!1,this.whiteStasName=!0,this.cj_whiteStas=!0,this.whiteTime=!1):(this.whiteStas=!1,this.whiteStasName=!1,this.cj_whiteStas=!1,this.whiteTime=!1)},radioBtnsbmd(e){this.whiteTime="1"==e},resetForm(e){this.timeData.time="",this.form.parkIds="",this.form.roadIds="",this.$refs.formId.resetFields()}}},I={class:"container"},D=s("i",{class:"el-icon-plus"},null,-1);var S=_(k,[["render",function(e,a,t,l,_,y){const b=r("el-input"),g=r("el-form-item"),w=r("el-radio"),v=r("el-radio-group"),V=r("el-option"),k=r("el-select"),S=r("el-date-picker"),C=r("el-upload"),U=r("el-button"),T=r("el-form");return i(),o("div",null,[s("div",I,[d(T,{"label-width":"90px",rules:_.formRules,ref:"formId",model:l.form},{default:m((()=>[d(g,{label:"车牌号码",prop:"car_no"},{default:m((()=>[d(b,{onBlur:y.upperCase,placeholder:"车牌号",modelValue:l.form.car_no,"onUpdate:modelValue":a[0]||(a[0]=e=>l.form.car_no=e),class:"handle-input"},null,8,["onBlur","modelValue"])])),_:1}),d(g,{label:"车牌类型"},{default:m((()=>[d(v,{modelValue:l.form.car_type,"onUpdate:modelValue":a[1]||(a[1]=e=>l.form.car_type=e)},{default:m((()=>[(i(!0),o(u,null,n(l.carTypeData,(e=>(i(),p(w,{key:e.id,label:e.dc_value},{default:m((()=>[h(f(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),d(g,{label:"名单类型"},{default:m((()=>[d(v,{modelValue:l.form.roster_type,"onUpdate:modelValue":a[2]||(a[2]=e=>l.form.roster_type=e),onChange:y.radioBtns},{default:m((()=>[(i(!0),o(u,null,n(l.rosterTypeData,(e=>(i(),p(w,{key:e.id,label:e.dc_value},{default:m((()=>[h(f(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),_.whiteStas?(i(),p(g,{key:0,label:"白名单类型"},{default:m((()=>[d(v,{modelValue:l.form.whitelist_type,"onUpdate:modelValue":a[3]||(a[3]=e=>l.form.whitelist_type=e),onChange:y.radioBtnsbmd},{default:m((()=>[(i(!0),o(u,null,n(l.whitelistTypeData,(e=>(i(),p(w,{key:e.id,label:e.dc_value},{default:m((()=>[h(f(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})):c("",!0),_.whiteStasName?(i(),p(g,{key:1,label:"姓名",prop:"name"},{default:m((()=>[d(b,{placeholder:"姓名",modelValue:l.form.name,"onUpdate:modelValue":a[4]||(a[4]=e=>l.form.name=e),class:"handle-input"},null,8,["modelValue"])])),_:1})):c("",!0),_.cj_whiteStas?(i(),p(g,{key:2,label:"残疾证号",prop:"deformity_cert"},{default:m((()=>[d(b,{placeholder:"残疾证号",modelValue:l.form.deformity_cert,"onUpdate:modelValue":a[5]||(a[5]=e=>l.form.deformity_cert=e),class:"handle-input"},null,8,["modelValue"])])),_:1})):c("",!0),_.whiteStas?(i(),p(g,{key:3,label:"电话",prop:"phone"},{default:m((()=>[d(b,{placeholder:"电话",modelValue:l.form.phone,"onUpdate:modelValue":a[6]||(a[6]=e=>l.form.phone=e),class:"handle-input"},null,8,["modelValue"])])),_:1})):c("",!0),_.whiteStas?(i(),p(g,{key:4,label:"公司名称",prop:"company_name"},{default:m((()=>[d(b,{placeholder:"公司名称",modelValue:l.form.company_name,"onUpdate:modelValue":a[7]||(a[7]=e=>l.form.company_name=e),class:"handle-input"},null,8,["modelValue"])])),_:1})):c("",!0),_.whiteStas?(i(),p(g,{key:5,label:"停车场"},{default:m((()=>[d(k,{modelValue:l.form.parkIds,"onUpdate:modelValue":a[8]||(a[8]=e=>l.form.parkIds=e),multiple:"",placeholder:"请选择"},{default:m((()=>[(i(!0),o(u,null,n(l.parks,(e=>(i(),p(V,{key:e.id,label:e.park_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})):c("",!0),_.whiteStas?(i(),p(g,{key:6,label:"路内"},{default:m((()=>[d(k,{modelValue:l.form.roadIds,"onUpdate:modelValue":a[9]||(a[9]=e=>l.form.roadIds=e),multiple:"",placeholder:"请选择"},{default:m((()=>[(i(!0),o(u,null,n(l.roads,(e=>(i(),p(V,{key:e.id,label:e.road_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})):c("",!0),_.whiteTime?(i(),p(g,{key:7,label:"免费时间",prop:"time_pro"},{default:m((()=>[d(S,{modelValue:l.timeData.time,"onUpdate:modelValue":a[10]||(a[10]=e=>l.timeData.time=e),onChange:l.getQueryDate,type:"date",style:{width:"300px"},placeholder:"选择日期"},null,8,["modelValue","onChange"])])),_:1})):c("",!0),_.cj_whiteStas?(i(),p(g,{key:8,label:"上传照片(最多一张)"},{default:m((()=>[d(C,{action:_.fileurl,"list-type":"picture-card",limit:"1","on-preview":y.handlePictureCardPreview,"on-remove":y.handleRemove,"on-success":y.handleSuccess},{default:m((()=>[D])),_:1},8,["action","on-preview","on-remove","on-success"])])),_:1})):c("",!0),d(g,null,{default:m((()=>[d(U,{type:"primary",onClick:a[11]||(a[11]=e=>y.saveCar("formId")),disabled:_.isDisabl},{default:m((()=>[h("提交")])),_:1},8,["disabled"]),d(U,{onClick:a[12]||(a[12]=e=>y.resetForm("formId"))},{default:m((()=>[h("重置")])),_:1}),d(U,{type:"primary",plain:"",onClick:a[13]||(a[13]=e=>y.backPage())},{default:m((()=>[h("返回")])),_:1})])),_:1})])),_:1},8,["rules","model"])])])}]]);export{S as default};
