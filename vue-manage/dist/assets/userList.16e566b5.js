import{b as e,f as l,L as a,q as r,r as d,M as o,o as t,h as u,i as s,w as n,c as i,l as m,m as p,k as c,I as f,F as _,j as h,t as g,p as V,v,N as y}from"./vendor.ac52fd94.js";import{_ as b,k as w,q as k,l as x,m as C,n as U,o as z,r as I,u as S,v as q,w as D}from"./index.1d57ac4a.js";const R=(e,l,a)=>{l.length;if(l){if(11!=l.length||!/^(((13[0-9]{1})|(14[0-9]{1})|(19[0-9]{1})|(16[0-9]{1})|(15[0-9]{1})|(18[0-9]{1})|(17[0-9]{1}))+\d{8})$/.test(l))return a(new Error("请输入正确的手机号"))}else a()},E={name:"userList",data:()=>({tableH:0}),setup(){const d=e(""),o=l({user_name:"",login_nameme:"",pageIndex:1,pageSize:15}),t=e([]),u=e(0),s=()=>{k(o).then((e=>{t.value=e.data.list,u.value=e.data.total}))};s();const n=e([]),i=()=>{x(l({})).then((e=>{n.value=e.data}))},m=e([]),p=()=>{C({role_type:"road"}).then((e=>{m.value=e.data}))},c=e(!1),f=e(!1);let _=e({});const h=e(null),g=e(null),V=e(null),v=e(null),b=e("first");return{query:o,tableData:t,pageTotal:u,editVisible:c,addVisible:f,form:_,getParks:i,parks:n,addform:h,xjaddform:V,editform:g,xjeditform:v,dialogT:d,roles:m,formRules:{user_name:[{required:!0,message:"请输入用户名",trigger:"blur"}],login_name:[{validator:(e,a,r)=>{D(l({loginName:a,userId:_.value.id})).then((e=>{if(!e.data)return r(new Error("登录名重复"));r()}))},trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],phone:[{validator:R,trigger:["blur","change"]}],sex:[{required:!0,message:"请选择性别",trigger:"blur"}],roleId:[{required:!0,message:"请选择角色",trigger:"blur"}]},save:()=>{h.value.validate((e=>{if(e){var l=_.value.phone;if(0==_.value.user_type){if(null!=l&&l.length>0&&(11!=l.length||!/^(((13[0-9]{1})|(14[0-9]{1})|(19[0-9]{1})|(16[0-9]{1})|(15[0-9]{1})|(18[0-9]{1})|(17[0-9]{1}))+\d{8})$/.test(l)))return r.error("请输入正确的手机号"),!1}if(_.value.password!=_.value.ensure_password)return r.error("密码与确认密码不一致"),!1;if(_.value.recharge_pwd!=_.value.remima)return r.error("充值密码与确认充值密码不一致"),!1;_.value.sysRole=null,z(_.value).then((e=>{"0"==e.code?(r.success(e.msg),f.value=!1,s()):r.error(e.msg)}))}}))},listRole:p,handleSta:(e,l)=>{let a={id:e.id,status:l};q(a).then((e=>{0==e.code?(r.success(e.msg),s()):r.error(e.msg)}))},handleSearch:()=>{o.pageIndex=1,s()},handlePageChange:e=>{o.pageIndex=e,s()},handleDelete:(e,d)=>{a.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{S(l({userId:d.id})).then((e=>{-1==e.code?r.error(e.msg):r.success(e.msg),s()}))})).catch((()=>{}))},handleEdit:(e,a,r)=>{d.value="编辑",b.value="first",c.value=!0,i(),p(),U(l({userId:a.id})).then((e=>{_.value=e.data,null!=e.data.recharge_pwd&&""!=e.data.recharge_pwd&&null!=e.data.recharge_pwd?_.value.remima=e.data.recharge_pwd:(_.value.remima="",_.value.recharge_pwd="")})),y((()=>{g.value.clearValidate()}))},saveEdit:()=>{g.value.validate((e=>{if(e){var l=_.value.phone;if(0==_.value.user_type){if(null!=l&&l.length>0&&(11!=l.length||!/^(((13[0-9]{1})|(14[0-9]{1})|(19[0-9]{1})|(16[0-9]{1})|(15[0-9]{1})|(18[0-9]{1})|(17[0-9]{1}))+\d{8})$/.test(l)))return r.error("请输入正确的手机号"),!1}if(_.value.recharge_pwd!=_.value.remima)return r.error("充值密码与确认充值密码不一致"),!1;_.value.sysRole=null,I(_.value).then((e=>{"0"==e.code&&(r.success(e.msg),c.value=!1,s())}))}}))},handleadd:(e,l,a)=>{d.value="新增",b.value="first",p(),i(),_.value={recharge_pwd:"",remima:""},_.value.user_type="0",f.value=!0,y((()=>{h.value.clearValidate(),V.value.clearValidate()}))},getData:s,multipleSelection:[],value:!0,activeName:b}},created(){let e=document.documentElement.clientHeight||document.body.clientHeight;this.tableH=e-308+"px"},methods:{handleSelectionChange(e){this.selectedData=e},handleDeleteAll(){a.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{var e=this,l=this.selectedData;console.log(l);var a="";l?(l.forEach((function(e,l){a=a+e.id+","})),w({userIds:a}).then((l=>{r.success("删除成功"),e.getData()}))):r.warning("请选择一条记录")})).catch((()=>{}))}}},j={class:"container"},N={class:"handle-box"},T={class:"left-panel"},H={class:"right-panel"},$=s("div",{class:"clear"},null,-1),A={class:"pagination"},P=s("div",{class:"mt20"},null,-1),K=s("div",{class:"mt20"},null,-1),L={class:"dialog-footer"},F=s("div",{class:"mt20"},null,-1),M=s("div",{class:"mt20"},null,-1),B={class:"dialog-footer"};var G=b(E,[["render",function(e,l,a,r,y,b){const w=d("el-button"),k=d("el-input"),x=d("el-table-column"),C=d("el-tag"),U=d("el-table"),z=d("el-pagination"),I=d("el-form-item"),S=d("el-option"),q=d("el-select"),D=d("el-form"),R=d("el-tab-pane"),E=d("el-tabs"),G=d("el-dialog"),J=d("el-radio"),O=o("permission");return t(),u("div",null,[s("div",j,[s("div",N,[s("div",T,[n((t(),i(w,{type:"primary",size:"small",icon:"el-icon-plus",onClick:l[0]||(l[0]=e=>r.handleadd(0,null,!0))},{default:m((()=>[p("添加")])),_:1})),[[O,["road_user_add","park_user_add"]]]),n((t(),i(w,{type:"danger",size:"small",icon:"el-icon-delete",onClick:l[1]||(l[1]=e=>b.handleDeleteAll())},{default:m((()=>[p("批量删除")])),_:1})),[[O,["road_user_deleteAll","park_user_deleteAll"]]])]),s("div",H,[c(k,{size:"small",modelValue:r.query.user_name,"onUpdate:modelValue":l[2]||(l[2]=e=>r.query.user_name=e),placeholder:"姓名",class:"handle-input mr10",onKeyup:l[3]||(l[3]=f((e=>r.handleSearch()),["enter"]))},null,8,["modelValue"]),c(k,{size:"small",modelValue:r.query.login_name,"onUpdate:modelValue":l[4]||(l[4]=e=>r.query.login_name=e),placeholder:"登陆账号",class:"handle-input mr10",onKeyup:l[5]||(l[5]=f((e=>r.handleSearch()),["enter"]))},null,8,["modelValue"]),c(w,{size:"small",type:"primary",icon:"el-icon-search",onClick:r.handleSearch},{default:m((()=>[p("查询")])),_:1},8,["onClick"])]),$]),c(U,{data:r.tableData,border:"",class:"table",ref:"multipleTable","max-height":y.tableH,"header-cell-class-name":"table-header",onSelectionChange:b.handleSelectionChange},{default:m((()=>[c(x,{type:"selection",width:"55",align:"center"}),c(x,{type:"index",label:"序号",width:"55",align:"center"}),c(x,{prop:"user_name",label:"姓名","min-width":"120",align:"center"}),c(x,{prop:"login_name",label:"登陆账号","min-width":"100",align:"center"}),c(x,{prop:"phone",label:"手机号",width:"120",align:"center"}),c(x,{prop:"sex",label:"性别",width:"100",align:"center"},{default:m((e=>["0"==e.row.sex?(t(),i(C,{key:0,size:"small",type:"success"},{default:m((()=>[p("男")])),_:1})):(t(),i(C,{key:1,size:"small"},{default:m((()=>[p("女")])),_:1}))])),_:1}),c(x,{prop:"status",label:"状态",width:"100",align:"center"},{default:m((e=>["1"==e.row.status?(t(),i(C,{key:0,size:"small",type:"success"},{default:m((()=>[p("启用")])),_:1})):(t(),i(C,{key:1,size:"small",type:"danger"},{default:m((()=>[p("禁用")])),_:1}))])),_:1}),c(x,{prop:"roles",label:"角色",align:"center"},{default:m((e=>[(t(!0),u(_,null,h(e.row.sysRoles,((e,l)=>(t(),i(C,{size:"small",key:l,class:"mar5"},{default:m((()=>[p(g(e.role_name),1)])),_:2},1024)))),128))])),_:1}),c(x,{prop:"user_type",label:"人员类型",width:"120",align:"center"},{default:m((e=>["0"==e.row.user_type?(t(),i(C,{key:0,size:"small",type:"success"},{default:m((()=>[p("运营人员")])),_:1})):(t(),i(C,{key:1,size:"small",type:"warning"},{default:m((()=>[p("停车场管理员")])),_:1}))])),_:1}),c(x,{label:"操作",width:"220",align:"center"},{default:m((e=>[n((t(),i(w,{size:"mini",type:"text",icon:"el-icon-edit",onClick:l=>r.handleEdit(e.$index,e.row,!1)},{default:m((()=>[p("编辑 ")])),_:2},1032,["onClick"])),[[O,["road_user_edit","park_user_edit"]]]),"0"==e.row.status?n((t(),i(w,{key:0,size:"mini",type:"text",icon:"el-icon-circle-check",onClick:l=>r.handleSta(e.row,"1")},{default:m((()=>[p("启用 ")])),_:2},1032,["onClick"])),[[O,["road_user_status","park_user_status"]]]):V("",!0),"1"==e.row.status?n((t(),i(w,{key:1,size:"mini",type:"text",icon:"el-icon-circle-close",onClick:l=>r.handleSta(e.row,"0"),class:"red"},{default:m((()=>[p("禁用 ")])),_:2},1032,["onClick"])),[[O,["road_user_status","park_user_status"]]]):V("",!0),n((t(),i(w,{size:"mini",type:"text",icon:"el-icon-delete",class:"red",onClick:l=>r.handleDelete(e.$index,e.row)},{default:m((()=>[p("删除")])),_:2},1032,["onClick"])),[[O,["road_user_delete","park_user_delete"]]])])),_:1})])),_:1},8,["data","max-height","onSelectionChange"]),s("div",A,[c(z,{background:"",layout:"total, prev, pager, next","current-page":r.query.pageIndex,"page-size":r.query.pageSize,total:r.pageTotal,onCurrentChange:r.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),c(G,{title:r.dialogT,modelValue:r.editVisible,"onUpdate:modelValue":l[16]||(l[16]=e=>r.editVisible=e),width:"30%"},{footer:m((()=>[s("span",L,[c(w,{onClick:l[15]||(l[15]=e=>r.editVisible=!1)},{default:m((()=>[p("取 消")])),_:1}),c(w,{type:"primary",onClick:r.saveEdit},{default:m((()=>[p("确 定")])),_:1},8,["onClick"])])])),default:m((()=>[c(E,{type:"card",modelValue:r.activeName,"onUpdate:modelValue":l[14]||(l[14]=e=>r.activeName=e)},{default:m((()=>[c(R,{label:"账户信息",name:"first"},{default:m((()=>[P,c(D,{"label-width":"70px",rules:r.formRules,ref:"editform",model:r.form},{default:m((()=>[c(I,{label:"姓名",prop:"user_name"},{default:m((()=>[c(k,{modelValue:r.form.user_name,"onUpdate:modelValue":l[6]||(l[6]=e=>r.form.user_name=e),placeholder:"请输入姓名"},null,8,["modelValue"])])),_:1}),c(I,{label:"登录账号",prop:"login_name"},{default:m((()=>[c(k,{modelValue:r.form.login_name,"onUpdate:modelValue":l[7]||(l[7]=e=>r.form.login_name=e),placeholder:"请输入账号"},null,8,["modelValue"])])),_:1}),c(I,{label:"性别",prop:"sex"},{default:m((()=>[c(q,{modelValue:r.form.sex,"onUpdate:modelValue":l[8]||(l[8]=e=>r.form.sex=e),placeholder:"请选择",style:{width:"100%"}},{default:m((()=>[c(S,{key:"0",label:"男",value:"0"}),c(S,{key:"1",label:"女",value:"1"})])),_:1},8,["modelValue"])])),_:1}),n(c(I,{label:"停车场",prop:"park_id"},{default:m((()=>[c(q,{modelValue:r.form.park_id,"onUpdate:modelValue":l[9]||(l[9]=e=>r.form.park_id=e),placeholder:"请选择",style:{width:"100%"}},{default:m((()=>[(t(!0),u(_,null,h(r.parks,(e=>(t(),i(S,{key:e.id,label:e.park_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},512),[[v,"1"==r.form.user_type]]),n(c(I,{label:"角色",class:"w",prop:"roleId"},{default:m((()=>[c(q,{modelValue:r.form.roleId,"onUpdate:modelValue":l[10]||(l[10]=e=>r.form.roleId=e),placeholder:"请选择",style:{width:"100%"}},{default:m((()=>[(t(!0),u(_,null,h(r.roles,(e=>(t(),i(S,{key:e.id,label:e.role_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},512),[[v,"0"==r.form.user_type]])])),_:1},8,["rules","model"])])),_:1}),"0"==r.form.user_type?(t(),i(R,{key:0,label:"巡检充值信息",name:"second"},{default:m((()=>[K,c(D,{"label-width":"100px",rules:r.formRules,ref:"xjeditform",model:r.form},{default:m((()=>[c(I,{label:"手机号",prop:"phone"},{default:m((()=>[c(k,{modelValue:r.form.phone,"onUpdate:modelValue":l[11]||(l[11]=e=>r.form.phone=e),placeholder:"请输入手机号"},null,8,["modelValue"])])),_:1}),c(I,{label:"充值密码",prop:"recharge_pwd"},{default:m((()=>[c(k,{type:"password",placeholder:"请输入充值密码",autocomplete:"new-password",modelValue:r.form.recharge_pwd,"onUpdate:modelValue":l[12]||(l[12]=e=>r.form.recharge_pwd=e)},null,8,["modelValue"])])),_:1}),c(I,{label:"确认充值密码"},{default:m((()=>[c(k,{type:"password",placeholder:"请再次输入充值密码",autocomplete:"new-password",modelValue:r.form.remima,"onUpdate:modelValue":l[13]||(l[13]=e=>r.form.remima=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1})):V("",!0)])),_:1},8,["modelValue"])])),_:1},8,["title","modelValue"]),c(G,{title:r.dialogT,modelValue:r.addVisible,"onUpdate:modelValue":l[31]||(l[31]=e=>r.addVisible=e),width:"30%"},{footer:m((()=>[s("span",B,[c(w,{onClick:l[30]||(l[30]=e=>r.addVisible=!1)},{default:m((()=>[p("取 消")])),_:1}),c(w,{type:"primary",onClick:r.save},{default:m((()=>[p("确 定")])),_:1},8,["onClick"])])])),default:m((()=>[c(E,{type:"card",modelValue:r.activeName,"onUpdate:modelValue":l[29]||(l[29]=e=>r.activeName=e)},{default:m((()=>[c(R,{label:"账户信息",name:"first"},{default:m((()=>[F,c(D,{"label-width":"70px",rules:r.formRules,ref:"addform",model:r.form},{default:m((()=>[c(I,{label:"姓名",prop:"user_name"},{default:m((()=>[c(k,{modelValue:r.form.user_name,"onUpdate:modelValue":l[17]||(l[17]=e=>r.form.user_name=e),placeholder:"请输入姓名"},null,8,["modelValue"])])),_:1}),c(I,{label:"登录账号",prop:"login_name"},{default:m((()=>[c(k,{modelValue:r.form.login_name,"onUpdate:modelValue":l[18]||(l[18]=e=>r.form.login_name=e),placeholder:"请输入账号"},null,8,["modelValue"])])),_:1}),c(I,{label:"用户类型"},{default:m((()=>[c(J,{modelValue:r.form.user_type,"onUpdate:modelValue":l[19]||(l[19]=e=>r.form.user_type=e),label:"0"},{default:m((()=>[p("运营中心")])),_:1},8,["modelValue"]),c(J,{modelValue:r.form.user_type,"onUpdate:modelValue":l[20]||(l[20]=e=>r.form.user_type=e),label:"1"},{default:m((()=>[p("岗亭")])),_:1},8,["modelValue"])])),_:1}),n(c(I,{label:"停车场",prop:"park_id"},{default:m((()=>[c(q,{modelValue:r.form.park_id,"onUpdate:modelValue":l[21]||(l[21]=e=>r.form.park_id=e),placeholder:"请选择"},{default:m((()=>[(t(!0),u(_,null,h(r.parks,(e=>(t(),i(S,{key:e.id,label:e.park_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},512),[[v,"1"==r.form.user_type]]),c(I,{label:"性别",prop:"sex"},{default:m((()=>[c(q,{modelValue:r.form.sex,"onUpdate:modelValue":l[22]||(l[22]=e=>r.form.sex=e),placeholder:"请选择"},{default:m((()=>[c(S,{key:"0",label:"男",value:"0"}),c(S,{key:"1",label:"女",value:"1"})])),_:1},8,["modelValue"])])),_:1}),c(I,{label:"密码",prop:"password"},{default:m((()=>[c(k,{type:"password",placeholder:"请输入密码",modelValue:r.form.password,"onUpdate:modelValue":l[23]||(l[23]=e=>r.form.password=e)},null,8,["modelValue"])])),_:1}),c(I,{label:"确认密码",prop:"ensure_password"},{default:m((()=>[c(k,{type:"password",placeholder:"请再次输入密码",modelValue:r.form.ensure_password,"onUpdate:modelValue":l[24]||(l[24]=e=>r.form.ensure_password=e)},null,8,["modelValue"])])),_:1}),"0"==r.form.user_type?n((t(),i(I,{key:0,label:"角色",class:"w",prop:"roleId"},{default:m((()=>[c(q,{modelValue:r.form.roleId,"onUpdate:modelValue":l[25]||(l[25]=e=>r.form.roleId=e),placeholder:"请选择"},{default:m((()=>[(t(!0),u(_,null,h(r.roles,(e=>(t(),i(S,{key:e.id,label:e.role_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},512)),[[v,"0"==r.form.user_type]]):V("",!0)])),_:1},8,["rules","model"])])),_:1}),"0"==r.form.user_type?(t(),i(R,{key:0,label:"巡检充值信息",name:"second"},{default:m((()=>[M,c(D,{"label-width":"100px",rules:r.formRules,ref:"xjaddform"},{default:m((()=>[c(I,{label:"手机号",prop:"phone"},{default:m((()=>[c(k,{modelValue:r.form.phone,"onUpdate:modelValue":l[26]||(l[26]=e=>r.form.phone=e),placeholder:"请输入手机号"},null,8,["modelValue"])])),_:1}),c(I,{label:"充值密码",prop:"recharge_pwd"},{default:m((()=>[c(k,{type:"password",placeholder:"请输入充值密码",autocomplete:"new-password",modelValue:r.form.recharge_pwd,"onUpdate:modelValue":l[27]||(l[27]=e=>r.form.recharge_pwd=e)},null,8,["modelValue"])])),_:1}),c(I,{label:"确认充值密码",prop:"remima"},{default:m((()=>[c(k,{type:"password",placeholder:"请再次输入充值密码",autocomplete:"new-password",modelValue:r.form.remima,"onUpdate:modelValue":l[28]||(l[28]=e=>r.form.remima=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["rules"])])),_:1})):V("",!0)])),_:1},8,["modelValue"])])),_:1},8,["title","modelValue"])])}]]);export{G as default};
