import{y as e,u as a,b as l,f as t,r as d,o as r,h as n,i as o,k as i,l as s,c as u,F as m,j as c,p,m as g}from"./vendor.ac52fd94.js";import{_ as b,aq as h,a5 as y,a6 as f,U as T,l as I,ar as v,as as V}from"./index.1d57ac4a.js";const _={name:"roadTongji",data:()=>({tableH:0}),setup(){const d=e();a();const r=d.query;console.log(r);const n=l(""),o=l(""),i=l(""),s=l([]);void 0!==r&&null!=r&&""!=r?(void 0!==r.menuType&&null!=r.menuType&&""!=r.menuType?n.value=r.menuType:n.value=localStorage.getItem("menuType"),void 0!==r.startTime&&null!=r.startTime&&""!=r.startTime&&(o.value=r.startTime,s.value=[r.startTime,r.startTime]),void 0!==r.endTime&&null!=r.endTime&&""!=r.endTime&&(i.value=r.endTime,s.value=[r.endTime1,r.endTime1]),"undefined"!=r.startTime&&null!=r.startTime&&""!=r.startTime&&"undefined"!=r.endTime&&null!=r.endTime&&""!=r.endTime&&(s.value=[r.startTime,r.endTime1])):n.value=localStorage.getItem("menuType"),console.log(n.value);const u=t({money:0,areaId:"",streetId:"",roadId:"",startTime:o,endTime:i,pageIndex:1,pageSize:15,menuType:n.value}),m=l([]),c=l([]),p=l(!1),g=l(0),b=l("");let _=t({time:s,phone:"",areaId:"",streetId:"",roadId:"",areas:[],streets:[],roads:[]});const w=t({}),k=()=>{y(w).then((e=>{_.areas=e.data}))};k();let C=t({areaId:u.areaId});const x=t({streetId:u.streetId});let q=t({carNoId:"",menuType:"",money:0,areaId:"",streetId:"",roadId:"",startTime:o,endTime:i,pageIndex:1,pageSize:15});const U=e=>`${e.getFullYear()}-${e.getMonth()+1>=10?e.getMonth()+1:"0"+(e.getMonth()+1)}-${e.getDate()>=10?e.getDate():"0"+e.getDate()}`,z=()=>{V(u).then((e=>{m.value=e.data.list.list,g.value=e.data.list.total,b.value=e.data.typeName}))};z();return{query:u,tableData:m,tableData2:c,typeName:b,form:_,road:q,pageTotal:g,viewVisible:p,exportExcel:()=>{h(u).then((e=>{const a=window.URL.createObjectURL(new Blob([e])),l=document.createElement("a");l.href=a,l.setAttribute("download","大额欠费.xls"),document.body.appendChild(l),l.click()}))},exporLargeArrears:h,handleView:(e,a)=>{q.carNoId=a.carNoId,q.menuType=n.value,q.areaId=u.areaId,q.streetId=u.streetId,q.roadId=u.roadId,q.startTime=u.startTime,q.endTime=u.endTime,v(q).then((e=>{console.log(e),c.value=e.data.list})).then((()=>{p.value=!0}))},handleSearch:()=>{u.pageIndex=1,z()},getQueryDate:()=>{null==_.time||[]==_.time||""==_.time?(u.startTime="",u.endTime=""):(u.startTime=U(_.time[0]),u.endTime=U(_.time[1]))},getArea:k,getStreet:()=>{C.areaId=u.areaId,u.roadId="",u.streetId="",f(C).then((e=>{_.streets=e.data}))},getRoad:()=>{u.roadId="",x.streetId=u.streetId,T(x).then((e=>{_.roads=e.data}))},getPark:()=>{u.roadId="",x.streetId=u.streetId,I(x).then((e=>{_.roads=e.data}))},handlePageChange:e=>{u.pageIndex=e,z()},menuType:n}},methods:{},created(){let e=document.documentElement.clientHeight||document.body.clientHeight;this.tableH=e-308+"px"}},w={class:"container"},k={class:"top-panel"},C=o("span",{class:"color666 ml5 dispinline"},"元以上欠费",-1),x=o("span",{class:"mar5 color999"},null,-1),q=o("span",{class:"mar5 color999"},null,-1),U=o("span",{class:"mar5 color999"},null,-1),z=o("span",{class:"mar5 color999"},null,-1),S={class:"pagination"},D={class:"dialog-footer"};var N=b(_,[["render",function(e,a,l,t,b,h){const y=d("el-input"),f=d("el-form-item"),T=d("el-date-picker"),I=d("el-option"),v=d("el-select"),V=d("el-button"),_=d("el-form"),N=d("el-col"),j=d("el-row"),H=d("el-table-column"),A=d("el-table"),E=d("el-pagination"),P=d("el-dialog");return r(),n("div",null,[o("div",w,[i(j,null,{default:s((()=>[i(N,{span:24},{default:s((()=>[o("div",k,[i(_,{"label-width":"80px",inline:"",size:"small"},{default:s((()=>[i(f,null,{default:s((()=>[i(y,{placeholder:"",modelValue:t.query.money,"onUpdate:modelValue":a[0]||(a[0]=e=>t.query.money=e),class:"w40"},null,8,["modelValue"]),C])),_:1}),i(f,{label:"驶入时间"},{default:s((()=>[i(T,{size:"small",modelValue:t.form.time,"onUpdate:modelValue":a[1]||(a[1]=e=>t.form.time=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",class:"datepicker",onChange:t.getQueryDate},null,8,["modelValue","onChange"])])),_:1}),"0"==t.menuType?(r(),u(f,{key:0,label:"选择层级"},{default:s((()=>[i(v,{clearable:"",modelValue:t.query.areaId,"onUpdate:modelValue":a[2]||(a[2]=e=>t.query.areaId=e),filterable:"",placeholder:"所有区域",class:"w100",onChange:t.getStreet},{default:s((()=>[(r(!0),n(m,null,c(t.form.areas,(e=>(r(),u(I,{key:e.id,label:e.area_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),x,i(v,{clearable:"",modelValue:t.query.streetId,"onUpdate:modelValue":a[3]||(a[3]=e=>t.query.streetId=e),filterable:"",placeholder:"所有街道",class:"w100",onChange:t.getRoad},{default:s((()=>[(r(!0),n(m,null,c(t.form.streets,(e=>(r(),u(I,{key:e.id,label:e.street_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),q,i(v,{clearable:"",modelValue:t.query.roadId,"onUpdate:modelValue":a[4]||(a[4]=e=>t.query.roadId=e),filterable:"",placeholder:"所有路内",class:"w100"},{default:s((()=>[(r(!0),n(m,null,c(t.form.roads,(e=>(r(),u(I,{key:e.id,label:e.road_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})):p("",!0),"1"==t.menuType?(r(),u(f,{key:1,label:"选择层级"},{default:s((()=>[i(v,{clearable:"",modelValue:t.query.areaId,"onUpdate:modelValue":a[5]||(a[5]=e=>t.query.areaId=e),filterable:"",placeholder:"所有区域",class:"w100",onChange:t.getStreet},{default:s((()=>[(r(!0),n(m,null,c(t.form.areas,(e=>(r(),u(I,{key:e.id,label:e.area_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),U,i(v,{clearable:"",modelValue:t.query.streetId,"onUpdate:modelValue":a[6]||(a[6]=e=>t.query.streetId=e),filterable:"",placeholder:"所有街道",class:"w100",onChange:t.getPark},{default:s((()=>[(r(!0),n(m,null,c(t.form.streets,(e=>(r(),u(I,{key:e.id,label:e.street_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),z,i(v,{clearable:"",modelValue:t.query.roadId,"onUpdate:modelValue":a[7]||(a[7]=e=>t.query.roadId=e),filterable:"",size:"small",placeholder:"所有停车场",class:"w100"},{default:s((()=>["1"==t.menuType?(r(!0),n(m,{key:0},c(t.form.roads,(e=>(r(),u(I,{key:e.id,label:e.park_name,value:e.id},null,8,["label","value"])))),128)):p("",!0)])),_:1},8,["modelValue"])])),_:1})):p("",!0),i(f,null,{default:s((()=>[i(V,{size:"small",type:"primary",icon:"el-icon-search",onClick:t.handleSearch},{default:s((()=>[g("查询 ")])),_:1},8,["onClick"])])),_:1}),i(f,null,{default:s((()=>[i(V,{size:"small",type:"success",icon:"el-icon-upload2",onClick:t.exportExcel},{default:s((()=>[g("导出 ")])),_:1},8,["onClick"])])),_:1})])),_:1})])])),_:1})])),_:1}),i(A,{data:t.tableData,border:"",class:"table","max-height":b.tableH,ref:"multipleTable","header-cell-class-name":"table-header"},{default:s((()=>[i(H,{type:"index",label:"序号",width:"55",align:"center"}),i(H,{prop:"carNo",label:"车牌号",width:"200",align:"center"}),i(H,{prop:"inTime",label:"最近的驶入时间",align:"center"}),i(H,{prop:"outTime",label:"最近的驶出时间",align:"center"}),i(H,{prop:"totalArrears",label:"欠费总额(元)",width:"200",align:"center"}),p("",!0),i(H,{prop:"phone",label:"车主电话",width:"200",align:"center"}),i(H,{prop:"",label:"操作项",width:"160",align:"center"},{default:s((e=>[i(V,{size:"mini",type:"text",icon:"el-icon-view",onClick:a=>t.handleView(e.$index,e.row)},{default:s((()=>[g("详情 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","max-height"]),o("div",S,[i(E,{background:"",layout:"total, prev, pager, next","current-page":t.query.pageIndex,"page-size":t.query.pageSize,total:t.pageTotal,onCurrentChange:t.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),i(P,{title:"查看详情",modelValue:t.viewVisible,"onUpdate:modelValue":a[9]||(a[9]=e=>t.viewVisible=e),width:"50%"},{footer:s((()=>[o("span",D,[i(V,{onClick:a[8]||(a[8]=e=>t.viewVisible=!1)},{default:s((()=>[g("关 闭")])),_:1})])])),default:s((()=>[i(j,null,{default:s((()=>[i(N,{span:24},{default:s((()=>[i(A,{data:t.tableData2,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:s((()=>[i(H,{prop:"orderNo",label:"订单号",align:"center"}),i(H,{prop:"roadName",label:t.typeName,align:"center"},null,8,["label"]),i(H,{prop:"amount",label:"金额",align:"center",width:"100"}),i(H,{prop:"inTime",label:"驶入时间",width:"180",align:"center"}),i(H,{width:"180",prop:"outTime",label:"驶出时间",align:"center"}),i(H,{prop:"resitime",label:"停车时长",align:"center",width:"180"})])),_:1},8,["data"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}]]);export{N as default};
