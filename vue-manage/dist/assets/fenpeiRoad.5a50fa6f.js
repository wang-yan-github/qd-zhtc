import{f as e,b as a,q as l,r as t,M as n,o as i,h as o,i as d,k as r,l as s,I as c,m as p,F as m,j as u,c as f,w as h,p as g,t as b,L as _}from"./vendor.ac52fd94.js";import{_ as k,bj as y,bk as I,bl as w,a5 as v,a6 as S,U as C,bm as V,bn as D}from"./index.1d57ac4a.js";import{U as T}from"./UE.013b43f7.js";const R={name:"equipmentwarn",data:()=>({tableH:0}),components:{Ueditor:T},setup(){const t=e({roadName:"",areaId:"",streetId:"",roadId:"",checked:!1,pageIndex:1,pageSize:15}),n=a([]),i=a([]),o=a(0),d=a(0),r=()=>{y(t).then((e=>{n.value=e.data.page.list,o.value=e.data.page.total,d.value=e.data.parking_type}))};r();const s=()=>{w().then((e=>{g.inspectManages=e.data}))};s();const c=e({}),p=()=>{v(c).then((e=>{g.areas=e.data}))};p();let m=e({areaId:t.areaId});const u=e({streetId:t.streetId}),f=a(!1),h=a(!1);let g=e({areas:[],streets:[],roads:[],inspectManages:[],formTitle:"",startTime:"",endTime:""}),b=e({allocatedSectionIds:"",allocatedSectionId:"",inspectId:"",startTime:"",endTime:""}),k=e({allocatedSectionId:"",inspectIds:""});return{formDealSectionInspector:b,query:t,tableData:n,tableInspectorData:i,pageTotal:o,parking_type:d,viewVisible:f,editVisible:h,form:g,formDealRelieve:k,dialogT:"新增",getData:r,getArea:p,getInspectManageSelectList:s,getInspectorData:e=>{I({id:e}).then((e=>{i.value=e.data}))},getStreet:()=>{m.areaId=t.areaId,t.roadId="",t.streetId="",S(m).then((e=>{g.streets=e.data}))},getRoad:()=>{u.streetId=t.streetId,C(u).then((e=>{g.roads=e.data}))},saveDealSectionInspector:()=>{b.startTime=g.startTime,b.endTime=g.endTime,b.startTime&&b.endTime&&b.inspectId?V(b).then((e=>{g.startTime="",g.endTime="",b.inspectId="",f.value=!1,l.success("保存成功"),r()})):l.error("请指定时间和指定巡检员")},saveDdealRelieve:()=>{D(k).then((e=>{g.startTime="",g.endTime="",b.inspectId="",h.value=!1,l.success("解除成功"),r()}))},handleSearch:()=>{t.pageIndex=1,r()},handlePageChange:e=>{t.pageIndex=e,r()},handleDelete:e=>{_.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{l.success("删除成功"),n.value.splice(e,1)})).catch((()=>{}))}}},created(){let e=document.documentElement.clientHeight||document.body.clientHeight;this.tableH=e-308+"px"},methods:{handleRowClick(e,a,l){a&&"操作"==a.label||this.$refs.multipleTable.toggleRowSelection(e)},handleSelectionChange(e){this.selectedData=e},getRowKeys:e=>e.id,handleRowEditClick(e){this.$refs.multipleEditTable.toggleRowSelection(e)},handleEditSelectionChange(e){this.editSelectedData=e},handleEdit(e,a){this.formDealSectionInspector.allocatedSectionId=a.id,this.getInspectorData(a.id),this.editVisible=!0},handDealRelieve(){var e=this.editSelectedData;if(null!=e&&0!=e.length){var a="";e.forEach((function(e,l){a+=e.id+","})),this.formDealRelieve.allocatedSectionId=this.formDealSectionInspector.allocatedSectionId,this.formDealRelieve.inspectIds=a,this.saveDdealRelieve()}else l.error("请选择一条记录")},bindRoad(e){var a,t=this,n=0,i="",o="",d="";if(0==t.parking_type){if(null==(a=t.selectedData)||0==a.length)return void l.error("请选择一条记录");t.formDealSectionInspector.allocatedSectionIds="",a.forEach((function(e,a){n=a,i=e.street_name,o=e.road_name,d=e.park_name,t.formDealSectionInspector.allocatedSectionIds+=e.id+","})),t.form.formTitle=0==n?i+" > "+o:"选择了"+(n+1)+"个路内"}else 1==t.parking_type&&(a=e,t.formDealSectionInspector.allocatedSectionIds="",i=e.street_name,o=e.road_name,d=e.park_name,t.formDealSectionInspector.allocatedSectionIds+=e.id,t.form.formTitle=i+" > "+d);t.viewVisible=!0,t.getInspectManageSelectList()}}},x={class:"container"},z={class:"handle-box"},H={class:"left-panel"},U=d("div",{class:"clear"},null,-1),E={class:"pagination"},q={class:"dialog-footer"},M=["src"],j={class:"handle-title mgb20"},L=d("i",{class:"el-icon-location"},null,-1),$={class:"dialog-footer"};var K=k(R,[["render",function(e,a,l,_,k,y){const I=t("el-input"),w=t("el-form-item"),v=t("el-option"),S=t("el-select"),C=t("el-button"),V=t("el-form"),D=t("el-table-column"),T=t("el-tag"),R=t("el-table"),K=t("el-pagination"),N=t("el-dialog"),P=t("el-time-picker"),A=t("el-col"),F=t("el-row"),B=n("permission");return i(),o("div",null,[d("div",x,[d("div",z,[d("div",H,[r(V,{inline:"","label-width":"80",class:"lineH0"},{default:s((()=>[r(w,{label:"",class:"search-mb0"},{default:s((()=>[r(I,{onKeyup:a[0]||(a[0]=c((e=>_.handleSearch()),["enter"])),size:"small",modelValue:_.query.roadName,"onUpdate:modelValue":a[1]||(a[1]=e=>_.query.roadName=e),class:"handle-input",placeholder:"请输入路内/停车场名"},null,8,["modelValue"])])),_:1}),r(w,{label:"",class:"search-mb0"},{default:s((()=>[r(S,{modelValue:_.query.areaId,"onUpdate:modelValue":a[2]||(a[2]=e=>_.query.areaId=e),filterable:"",size:"small",placeholder:"所有区域",class:"w100",onChange:_.getStreet},{default:s((()=>[r(v,{value:""},{default:s((()=>[p("全部")])),_:1}),(i(!0),o(m,null,u(_.form.areas,(e=>(i(),f(v,{key:e.id,label:e.area_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),r(w,{label:"",class:"search-mb0"},{default:s((()=>[r(S,{modelValue:_.query.streetId,"onUpdate:modelValue":a[3]||(a[3]=e=>_.query.streetId=e),filterable:"",size:"small",placeholder:"所有街道",class:"w100",onChange:_.getRoad},{default:s((()=>[r(v,{value:""},{default:s((()=>[p("全部")])),_:1}),(i(!0),o(m,null,u(_.form.streets,(e=>(i(),f(v,{key:e.id,label:e.street_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),r(w,{label:"",class:"search-mb0"},{default:s((()=>[r(C,{size:"small",type:"primary",icon:"el-icon-search",onClick:_.handleSearch},{default:s((()=>[p("查询 ")])),_:1},8,["onClick"])])),_:1}),r(w,{label:"",class:"search-mb0"},{default:s((()=>[0==_.parking_type?h((i(),f(C,{key:0,type:"success",size:"small",icon:"el-icon-s-operation",onClick:a[4]||(a[4]=e=>y.bindRoad(""))},{default:s((()=>[p("分配巡检员 ")])),_:1})),[[B,"road_fenpeiroad_fpxjy"]]):g("",!0)])),_:1})])),_:1})]),U]),r(R,{data:_.tableData,border:"",class:"table",ref:"multipleTable","max-height":k.tableH,"header-cell-class-name":"table-header",onRowClick:y.handleRowClick,"row-key":y.getRowKeys,onSelectionChange:y.handleSelectionChange},{default:s((()=>[0==_.parking_type?(i(),f(D,{key:0,type:"selection",width:"55","reserve-selection":!0,align:"center"})):g("",!0),r(D,{label:"序号",width:"55",align:"center"},{default:s((e=>[p(b(e.$index+1),1)])),_:1}),r(D,{prop:"name",label:"所属街道",align:"center"},{default:s((e=>[p(b(e.row.street_name),1)])),_:1}),0==_.parking_type?(i(),f(D,{key:1,prop:"name",label:"路内名称",align:"center"},{default:s((e=>[p(b(e.row.road_name),1)])),_:1})):g("",!0),1==_.parking_type?(i(),f(D,{key:2,prop:"name",label:"停车场名称",align:"center"},{default:s((e=>[p(b(e.row.park_name),1)])),_:1})):g("",!0),0==_.parking_type?(i(),f(D,{key:3,label:"泊位数量",align:"center",width:"100"},{default:s((e=>[p(b(e.row.berth_num),1)])),_:1})):g("",!0),1==_.parking_type?(i(),f(D,{key:4,label:"泊位总数",align:"center",width:"100"},{default:s((e=>[p(b(e.row.park_num),1)])),_:1})):g("",!0),r(D,{label:"分配人数",align:"center",width:"100"},{default:s((e=>[p(b(e.row.inspectManageListSize),1)])),_:1}),0==_.parking_type?(i(),f(D,{key:5,label:"负责巡检员",prop:"name",align:"center"},{default:s((e=>[(i(!0),o(m,null,u(e.row.inspectManageList,((e,a)=>(i(),f(T,{effect:"dark",size:"small",key:a,class:"mar5 mb5"},{default:s((()=>[p(b(e),1)])),_:2},1024)))),128))])),_:1})):g("",!0),1==_.parking_type?(i(),f(D,{key:6,label:"负责收费员",prop:"name",align:"center"},{default:s((e=>[(i(!0),o(m,null,u(e.row.inspectManageList,((e,a)=>(i(),f(T,{effect:"dark",size:"small",key:a,class:"mar5 mb5"},{default:s((()=>[p(b(e),1)])),_:2},1024)))),128))])),_:1})):g("",!0),r(D,{label:"操作",width:"200",align:"center"},{default:s((e=>[h((i(),f(C,{size:"mini",type:"text",icon:"el-icon-s-operation",onClick:a=>y.handleEdit(e.$index,e.row)},{default:s((()=>[p("解除 ")])),_:2},1032,["onClick"])),[[B,["road_fenpeiroad_jc","park_fenpeipark_jc"]]]),1==_.parking_type?h((i(),f(C,{key:0,size:"mini",type:"text",icon:"el-icon-s-operation",onClick:a=>y.bindRoad(e.row)},{default:s((()=>[p("分配收费员 ")])),_:2},1032,["onClick"])),[[B,"park_fenpeipark_fpsfy"]]):g("",!0)])),_:1})])),_:1},8,["data","max-height","onRowClick","row-key","onSelectionChange"]),d("div",E,[r(K,{background:"",layout:"total, prev, pager, next","current-page":_.query.pageIndex,"page-size":_.query.pageSize,total:_.pageTotal,onCurrentChange:_.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),r(N,{title:"解绑",modelValue:_.editVisible,"onUpdate:modelValue":a[6]||(a[6]=e=>_.editVisible=e),width:"40%"},{footer:s((()=>[d("span",q,[r(C,{onClick:a[5]||(a[5]=e=>_.editVisible=!1)},{default:s((()=>[p("取 消")])),_:1}),r(C,{type:"primary",onClick:y.handDealRelieve},{default:s((()=>[p("解 绑")])),_:1},8,["onClick"])])])),default:s((()=>[r(R,{data:_.tableInspectorData,border:"",class:"table",ref:"multipleEditTable","header-cell-class-name":"table-header",onSelectionChange:y.handleEditSelectionChange,onRowClick:y.handleRowEditClick},{default:s((()=>[r(D,{type:"selection",width:"55",align:"center"}),r(D,{type:"index",label:"序号",width:"55",align:"center"}),r(D,{prop:"name",label:"姓名",width:"130"},{default:s((e=>[p(b(e.row.name),1)])),_:1}),r(D,{prop:"phone",label:"手机号",width:"130"},{default:s((e=>[p(b(e.row.phone),1)])),_:1}),r(D,{label:"时间",align:"center"},{default:s((e=>[p(b(e.row.create_time),1)])),_:1})])),_:1},8,["data","onSelectionChange","onRowClick"])])),_:1},8,["modelValue"]),r(N,{modelValue:e.ppVisible,"onUpdate:modelValue":a[7]||(a[7]=a=>e.ppVisible=a)},{default:s((()=>[d("img",{width:"100%",src:e.dialogImageUrl,alt:""},null,8,M)])),_:1},8,["modelValue"]),r(N,{title:"分配",modelValue:_.viewVisible,"onUpdate:modelValue":a[12]||(a[12]=e=>_.viewVisible=e),width:"538px"},{footer:s((()=>[d("span",$,[r(C,{onClick:a[11]||(a[11]=e=>_.viewVisible=!1)},{default:s((()=>[p("取 消")])),_:1}),r(C,{type:"primary",onClick:_.saveDealSectionInspector},{default:s((()=>[p("确 定")])),_:1},8,["onClick"])])])),default:s((()=>[d("div",j,[L,p(b(_.form.formTitle),1)]),r(V,{"label-width":"70px",size:"small"},{default:s((()=>[r(w,{label:"指定时间"},{default:s((()=>[r(F,{gutter:20},{default:s((()=>[r(A,{span:12},{default:s((()=>[r(P,{placeholder:"开时时分",class:"w",format:"HH:mm","value-format":"HH:mm",modelValue:_.form.startTime,"onUpdate:modelValue":a[8]||(a[8]=e=>_.form.startTime=e)},null,8,["modelValue"])])),_:1}),r(A,{span:12},{default:s((()=>[r(P,{placeholder:"结束时分",class:"w",format:"HH:mm","value-format":"HH:mm",modelValue:_.form.endTime,"onUpdate:modelValue":a[9]||(a[9]=e=>_.form.endTime=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),r(w,{label:"指定巡检"},{default:s((()=>[r(F,{gutter:20},{default:s((()=>[r(A,{span:24},{default:s((()=>[r(S,{modelValue:_.formDealSectionInspector.inspectId,"onUpdate:modelValue":a[10]||(a[10]=e=>_.formDealSectionInspector.inspectId=e),filterable:"",size:"small",placeholder:"所有巡检员",class:"w"},{default:s((()=>[(i(!0),o(m,null,u(_.form.inspectManages,(e=>(i(),f(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])}]]);export{K as default};
