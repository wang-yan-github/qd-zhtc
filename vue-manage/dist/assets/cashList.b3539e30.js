import{f as e,b as a,q as l,L as t,r as n,o as i,h as r,i as s,k as d,l as o,F as c,j as u,c as p,m as g,t as m,s as h,x as b}from"./vendor.ac52fd94.js";import{l as f,s as _,n as y}from"./roadParkingOrder.721e77c8.js";import{_ as v}from"./index.1d57ac4a.js";const q={name:"cashList",data:()=>({tableH:0}),setup(){const t=e({time:""}),n=e({inspect_id:"",is_verification:"0",startDate:"",endDate:"",pageIndex:1,pageSize:15}),i=a([]),r=a(0),s=a("0"),d=()=>{_(n).then((e=>{console.log(e),""==n.inspect_id||null==n.inspect_id?l.warning("请选择巡检员"):(i.value=e.data.pageInfo.list,r.value=e.data.pageInfo.total,"0"==n.is_verification?s.value=e.data.money:s.value="0")}))};d();const o=e=>`${e.getFullYear()}-${e.getMonth()+1>=10?e.getMonth()+1:"0"+(e.getMonth()+1)}-${e.getDate()>=10?e.getDate():"0"+e.getDate()}`;let c=e({inspectManages:[]});y().then((e=>{c.inspectManages=e.data}));const u=a("");return{form:c,queryTime:t,query:n,tableData:i,pageTotal:r,getData:d,handleSearch:()=>{n.pageIndex=1,d()},handlePageChange:e=>{n.pageIndex=e,d()},getQueryDate:()=>{null==c.time||[]==c.time||""==c.time?(n.startTime="",n.endTime=""):(n.startTime=o(c.time[0]),n.endTime=o(c.time[1]))},selectVal:u,money:s}},methods:{handleSelectionChange(e){this.selectedData=e},handleChange(e){let a={};a=this.form.inspectManages.find((a=>a.id===e)),null!=a&&""!=a&&null!=a&&(this.selectVal=a.name)},handleDeleteAll(){const e="确定要核销"+this.selectVal+"的所有现金订单吗？";var a=this;""==a.query.inspect_id||null==a.query.inspect_id?l.warning("请选择巡检员"):""==a.query.is_verification||null==a.query.is_verification?l.warning("请选择核销状态"):"1"==a.query.is_verification?l.warning("选择未核销状态才可核销"):t.confirm(e,"提示",{type:"warning"}).then((()=>{f({xjyId:a.query.inspect_id,startDate:a.query.startDate,endDate:a.query.endDate}).then((e=>{l.success("核销成功"),a.getData()}))})).catch((()=>{}))}},created(){let e=document.documentElement.clientHeight||document.body.clientHeight;this.tableH=e-308+"px"}},C=e=>(h("data-v-54681bb4"),e=e(),b(),e),x={class:"container"},D={class:"top-panel"},w={class:"tip"},k=C((()=>s("span",null,"待核销金额：",-1))),V=C((()=>s("span",null,"(元)",-1))),T={class:"pagination"};var z=v(q,[["render",function(e,a,l,t,h,b){const f=n("el-option"),_=n("el-select"),y=n("el-form-item"),v=n("el-date-picker"),q=n("el-button"),C=n("el-form"),z=n("el-col"),I=n("el-row"),M=n("el-table-column"),j=n("el-table"),H=n("el-pagination");return i(),r("div",null,[s("div",x,[d(I,null,{default:o((()=>[d(z,{xs:24,sm:24,md:24,lg:18,xl:18},{default:o((()=>[s("div",D,[d(C,{"label-width":"80px",inline:"",size:"small"},{default:o((()=>[d(y,{label:"巡检员"},{default:o((()=>[d(_,{onChange:b.handleChange,modelValue:t.query.inspect_id,"onUpdate:modelValue":a[0]||(a[0]=e=>t.query.inspect_id=e),filterable:"",size:"small",placeholder:"巡检员"},{default:o((()=>[d(f,{key:"",label:"请选择",value:""}),(i(!0),r(c,null,u(t.form.inspectManages,(e=>(i(),p(f,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["onChange","modelValue"])])),_:1}),d(y,{label:"核销状态"},{default:o((()=>[d(_,{onChange:b.handleChange,modelValue:t.query.is_verification,"onUpdate:modelValue":a[1]||(a[1]=e=>t.query.is_verification=e),filterable:"",size:"small",placeholder:"核销状态"},{default:o((()=>[d(f,{key:"0",label:"未核销 ",value:"0"}),d(f,{key:"1",label:"已核销",value:"1"})])),_:1},8,["onChange","modelValue"])])),_:1}),d(y,{label:"支付时间"},{default:o((()=>[d(v,{size:"small",modelValue:t.queryTime.time,"onUpdate:modelValue":a[2]||(a[2]=e=>t.queryTime.time=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",class:"datepicker",onChange:t.getQueryDate},null,8,["modelValue","onChange"])])),_:1}),d(y,null,{default:o((()=>[d(q,{size:"small",type:"primary",icon:"el-icon-search",onClick:t.handleSearch},{default:o((()=>[g("查询 ")])),_:1},8,["onClick"])])),_:1})])),_:1})])])),_:1}),d(z,{xs:24,sm:24,md:24,lg:6,xl:6},{default:o((()=>[s("div",w,[s("p",null,[k,s("b",null,m(t.money),1),g(),V]),d(q,{size:"small",type:"success",icon:"el-icon-bank-card",onClick:a[3]||(a[3]=e=>b.handleDeleteAll())},{default:o((()=>[g("核销 ")])),_:1})])])),_:1})])),_:1}),d(j,{data:t.tableData,border:"",class:"table",ref:"multipleTable","max-height":h.tableH,"header-cell-class-name":"table-header"},{default:o((()=>[d(M,{type:"index",label:"序号",width:"55",align:"center"}),d(M,{prop:"order_no",label:"订单号",width:"200",align:"center"}),d(M,{prop:"road_name",label:"路内",align:"center"}),d(M,{prop:"berth",label:"泊位编号",width:"200",align:"center"}),d(M,{prop:"car_no",label:"车牌号码",width:"100",align:"center"}),d(M,{prop:"drivein_time",label:"停入时间",width:"180",align:"center"}),d(M,{prop:"driveout_time",label:"离场时间",width:"180",align:"center"}),d(M,{prop:"resTime",width:"100",align:"center",label:"停留时间"}),d(M,{prop:"sum_amount",label:"停车费用",width:"100",align:"center"}),d(M,{prop:"state_name",label:"状态",width:"120",align:"center"})])),_:1},8,["data","max-height"]),s("div",T,[d(H,{background:"",layout:"total, prev, pager, next","current-page":t.query.pageIndex,"page-size":t.query.pageSize,total:t.pageTotal,onCurrentChange:t.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])])])}],["__scopeId","data-v-54681bb4"]]);export{z as default};
