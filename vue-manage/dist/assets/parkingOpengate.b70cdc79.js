import{f as e,b as a,r as l,M as t,o as s,h as i,i as r,k as d,l as n,I as o,F as c,j as u,c as p,m,w as h,t as g,p as k,v as _}from"./vendor.ac52fd94.js";import{U as b}from"./UE.013b43f7.js";import{_ as f,F as v,a5 as y,a6 as w,l as D}from"./index.1d57ac4a.js";import{i as I,j as V}from"./park.2748bfeb.js";import{c as C}from"./roadParkingOrder.721e77c8.js";const x={name:"parkingOrder",components:{Ueditor:b},data:()=>({liHide:!1,isShow:!1,isShowInfo:!0,stopTime:!1,tableH:0}),setup(){const l=e({areaId:"",streetId:"",parkId:"",phone:"",orderNo:"",carNo:"",startTime:"",endTime:"",driveout_gate:"",checked:!1,pageIndex:1,pageSize:15}),t=a([]),s=a(0),i=a(0),r=a([]),d=a(!1),n=()=>{V(l).then((e=>{t.value=e.data.list,s.value=e.data.total}))};n();const o=e({}),c=()=>{y(o).then((e=>{k.areas=e.data}))};c();let u=e({areaId:l.areaId});let p=a({time:""});const m=e=>`${e.getFullYear()}-${e.getMonth()+1>=10?e.getMonth()+1:"0"+(e.getMonth()+1)}-${e.getDate()>=10?e.getDate():"0"+e.getDate()}`,h=a(!1),g=a({});let k=e({areas:[],streets:[],parkss:[],id:"",car_id:"",order_no:"",car_type:"",road_name:"",berth:"",car_no:"",drivein_time:"",driveout_time:"",resitime:"",sum_amount:"",state_name:"",checked:!1,startTime:"",endTime:"",source_type:"",company_name:"",create_time:"",time:""});const _=a([]);v(e({dict_type:"car_type"})).then((e=>{_.value=e.data}));return{query:l,carType:_,tableData:t,pageTotal:s,pageTotal1:i,editVisible:h,form:k,imgurl:e=>{if(""!=e&&null!=e)return e},todoList:r,specialVisible:d,parkDetails:g,timeData:p,getData:n,getQueryDate:()=>{null==p.value.time||[]==p.value.time||""==p.value.time?(l.startTime="",l.endTime=""):(l.startTime=m(p.value.time[0]),l.endTime=m(p.value.time[1]))},handleEdit:(a,l)=>{C(e({id:l.park_id})).then((e=>{g.value=e.data})),h.value=!0},handleSearch:()=>{l.pageIndex=1,n()},handlePageChange:e=>{l.pageIndex=e,n()},getArea:c,getStreet:()=>{""==l.areaId?(k.streets=[],k.parks=[],l.streetId="",l.parkId=""):(l.streetId="",l.parkId="",k.parks=[],u.areaId=l.areaId,w(u).then((e=>{k.streets=e.data})))},getPark:()=>{""==l.streetId?(k.parks=[],l.parkId=""):(k.parks=[],l.parkId="",D(e({streetId:l.streetId})).then((e=>{k.parks=e.data})))},multipleSelection:[],dialogImageUrl:"",ppVisible:!1,isActive:!1,activeName:"first"}},methods:{handleRemove(e,a){},handlePictureCardPreview(e){this.dialogImageUrl=e.url,this.ppVisible=!0},handleSelectionChange(e){this.selectedData=e},closeBtn(e,a){var l=this;l.stopTime=!1,l.liHide=!1,l.isShow=!1,l.isShowInfo=!0,l.timeData.time1="",l.surevb=!1,l.handleEdit(e,a)},exportOpengate(){I(this.query).then((e=>{const a=window.URL.createObjectURL(new Blob([e])),l=document.createElement("a");l.href=a,l.setAttribute("download","遥控日志.xls"),document.body.appendChild(l),l.click()}))}},created(){let e=document.documentElement.clientHeight||document.body.clientHeight;this.tableH=e-308+"px"}},S={class:"container"},z={class:"handle-box"},T={class:"left-panel"},U=r("span",{class:"mar5 color999"},null,-1),q=r("span",{class:"mar5 color999"},null,-1),L=r("span",{class:"mar5 color999"},null,-1),j=r("div",{class:"clear"},null,-1),H={class:"pagination"},N=r("div",{class:"mt20"},null,-1),P={class:"desctable mgb20 w"},E=r("td",{class:"tit",width:"60"},"订单号",-1),O=r("td",{class:"tit",width:"80"},"订单状态",-1),$=r("td",{class:"tit",width:"60"},"停留时间",-1),M=r("td",{class:"tit",width:"80"},"费用",-1),A=r("td",{class:"tit",width:"60"},"停车地点",-1),B={colspan:"3"},F={key:0},R=r("td",{class:"tit",width:"60"},"车牌号码",-1),Q={colspan:"3"},K=r("td",{class:"tit",width:"60"},"车牌类型",-1),Y=r("td",{class:"tit",width:"80"},"车主手机号",-1),G=r("td",{class:"tit",width:"60"},"订单来源",-1),J={key:0},W={key:1},X=r("td",{class:"tit",width:"80"},"创建时间",-1),Z=r("td",{class:"tit",width:"60"},"进场时间",-1),ee=r("td",{class:"tit",width:"80"},"离场时间",-1),ae=r("div",{class:"mt20"},null,-1),le={class:"desctable mgb20 w"},te={key:0},se=r("td",{class:"tit",width:"60"},"进场照片",-1),ie={colspan:"3"},re={key:1},de=r("td",{class:"tit",width:"60"},"离场照片",-1),ne={colspan:"3"};var oe=f(x,[["render",function(e,a,b,f,v,y){const w=l("el-input"),D=l("el-form-item"),I=l("el-date-picker"),V=l("el-option"),C=l("el-select"),x=l("el-button"),oe=l("el-form"),ce=l("el-table-column"),ue=l("el-tag"),pe=l("el-table"),me=l("el-pagination"),he=l("el-tab-pane"),ge=l("el-image"),ke=l("el-tabs"),_e=l("el-dialog"),be=t("permission");return s(),i("div",null,[r("div",S,[r("div",z,[r("div",T,[d(oe,{inline:"","label-width":"80",size:"small",class:"lineH0"},{default:n((()=>[d(D,{label:"闸机编码",class:"search-mb0"},{default:n((()=>[d(w,{size:"small",onKeyup:a[0]||(a[0]=o((e=>f.handleSearch()),["enter"])),modelValue:f.query.driveout_gate,"onUpdate:modelValue":a[1]||(a[1]=e=>f.query.driveout_gate=e),placeholder:"请输入闸机编码",class:"handle-input mr10"},null,8,["modelValue"])])),_:1}),d(D,{label:"操作时间",class:"search-mb0"},{default:n((()=>[d(I,{modelValue:f.timeData.time,"onUpdate:modelValue":a[2]||(a[2]=e=>f.timeData.time=e),placeholder:"",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",onChange:f.getQueryDate},null,8,["modelValue","onChange"])])),_:1}),d(D,{label:"停车场",class:"search-mb0"},{default:n((()=>[d(C,{clearable:"",modelValue:f.query.areaId,"onUpdate:modelValue":a[3]||(a[3]=e=>f.query.areaId=e),filterable:"",size:"small",placeholder:"所有区域",class:"w100",onChange:f.getStreet},{default:n((()=>[(s(!0),i(c,null,u(f.form.areas,(e=>(s(),p(V,{key:e.id,label:e.area_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),U,d(C,{clearable:"",modelValue:f.query.streetId,"onUpdate:modelValue":a[4]||(a[4]=e=>f.query.streetId=e),filterable:"",size:"small",placeholder:"所有街道",class:"w100",onChange:f.getPark},{default:n((()=>[(s(!0),i(c,null,u(f.form.streets,(e=>(s(),p(V,{key:e.id,label:e.street_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),q,d(C,{clearable:"",modelValue:f.query.parkId,"onUpdate:modelValue":a[5]||(a[5]=e=>f.query.parkId=e),filterable:"",size:"small",placeholder:"所有停车场",class:"w100"},{default:n((()=>[(s(!0),i(c,null,u(f.form.parks,(e=>(s(),p(V,{key:e.id,label:e.park_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),L])),_:1}),d(D,{label:"",class:"search-mb0"},{default:n((()=>[d(x,{size:"small",type:"primary",icon:"el-icon-search",onClick:f.handleSearch},{default:n((()=>[m("查询")])),_:1},8,["onClick"]),h((s(),p(x,{size:"small",type:"success",icon:"el-icon-upload2",onClick:y.exportOpengate},{default:n((()=>[m("导出")])),_:1},8,["onClick"])),[[be,"park_opengate_excel"]])])),_:1})])),_:1})]),j]),d(pe,{data:f.tableData,border:"",class:"table","max-height":v.tableH,ref:"multipleTable","header-cell-class-name":"table-header",onSelectionChange:y.handleSelectionChange},{default:n((()=>[d(ce,{label:"序号",width:"55",align:"center"},{default:n((e=>[m(g(e.$index+1),1)])),_:1}),d(ce,{label:"类型",prop:"park_type",align:"center"},{default:n((e=>["1"==e.row.park_type?(s(),p(ue,{key:0,size:"small"},{default:n((()=>[m("进场")])),_:1})):k("",!0),"2"==e.row.park_type?(s(),p(ue,{key:1,size:"small"},{default:n((()=>[m("出场")])),_:1})):k("",!0)])),_:1}),d(ce,{label:"闸机编码",prop:"driveout_gate",align:"center"}),d(ce,{label:"停车场",prop:"parkName",align:"center"}),d(ce,{label:"操作内容",width:"500",prop:"content",align:"center"}),d(ce,{label:"订单号",prop:"park_order_id",align:"center"}),d(ce,{label:"操作",width:"100",align:"center"},{default:n((e=>[h((s(),p(x,{size:"mini",type:"text",icon:"el-icon-view",onClick:a=>y.closeBtn(e.$index,e.row)},{default:n((()=>[m("详情 ")])),_:2},1032,["onClick"])),[[be,"park_opengate_details"]])])),_:1})])),_:1},8,["data","max-height","onSelectionChange"]),r("div",H,[d(me,{background:"",layout:"total, prev, pager, next","current-page":f.query.pageIndex,"page-size":f.query.pageSize,total:f.pageTotal,onCurrentChange:f.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),d(_e,{title:"查看详情",modelValue:f.editVisible,"onUpdate:modelValue":a[11]||(a[11]=e=>f.editVisible=e),width:"40%"},{default:n((()=>[d(ke,{type:"card",modelValue:f.activeName,"onUpdate:modelValue":a[10]||(a[10]=e=>f.activeName=e)},{default:n((()=>[d(he,{label:"基本信息",name:"first"},{default:n((()=>[N,r("table",P,[r("tr",null,[E,r("td",null,g(f.parkDetails.order_no),1),O,r("td",null,[d(ue,{type:"success"},{default:n((()=>[m(g(f.parkDetails.statusName),1)])),_:1})])]),r("tr",null,[$,r("td",null,g(f.parkDetails.resitime),1),M,r("td",null,[d(ue,{type:"danger"},{default:n((()=>[m(g(f.parkDetails.sum_amount?f.parkDetails.sum_amount:"0"),1)])),_:1})])]),r("tr",null,[A,r("td",B,g(f.parkDetails.road_name),1)]),1==f.parkDetails.status||2==f.parkDetails.status?(s(),i("tr",F,[R,r("td",Q,[h(r("div",null,[r("span",null,g(f.parkDetails.car_no),1)],512),[[_,v.isShowInfo]]),h(r("div",null,[d(w,{modelValue:f.parkDetails.car_no,"onUpdate:modelValue":a[6]||(a[6]=e=>f.parkDetails.car_no=e),class:"w100",size:"small"},null,8,["modelValue"]),d(C,{modelValue:f.parkDetails.car_type,"onUpdate:modelValue":a[7]||(a[7]=e=>f.parkDetails.car_type=e),filterable:"",size:"small",placeholder:"车牌分类",class:"w100 ml5"},{default:n((()=>[(s(!0),i(c,null,u(f.carType,(e=>(s(),p(V,{key:e.dc_value,label:e.label,value:e.dc_value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),d(x,{size:"small",class:"ml5",type:"primary",icon:"el-icon-check",onClick:a[8]||(a[8]=a=>e.changeisShowInfo(1))},{default:n((()=>[m("确定 ")])),_:1}),d(x,{size:"small",icon:"el-icon-close",onClick:a[9]||(a[9]=a=>e.changeisShowInfo(2))},{default:n((()=>[m("取消")])),_:1})],512),[[_,v.isShow]])])])):k("",!0),r("tr",null,[K,r("td",null,g(f.parkDetails.carType),1),Y,r("td",null,g(f.parkDetails.phone),1)]),r("tr",null,[G,1==f.parkDetails.source?(s(),i("td",J,"视频采集")):(s(),i("td",W,"人工")),X,r("td",null,g(f.parkDetails.create_time),1)]),r("tr",null,[Z,r("td",null,g(f.parkDetails.drivein_time),1),ee,r("td",null,g(f.parkDetails.driveout_time),1)])])])),_:1}),d(he,{label:"进出场信息",name:"second"},{default:n((()=>[ae,r("table",le,[null!=f.parkDetails.scList&&f.parkDetails.scList.length>0?(s(),i("tr",te,[se,r("td",ie,[(s(!0),i(c,null,u(f.parkDetails.scList,((e,a)=>(s(),p(ge,{key:a,style:{width:"100px",height:"100px"},src:f.imgurl(e.file_url),"hide-on-click-modal":"true","preview-teleported":"true",class:"ml5","preview-src-list":[f.imgurl(e.file_url)]},null,8,["src","preview-src-list"])))),128))])])):k("",!0),null!=f.parkDetails.slList&&f.parkDetails.slList.length>0?(s(),i("tr",re,[de,r("td",ne,[(s(!0),i(c,null,u(f.parkDetails.slList,((e,a)=>(s(),p(ge,{key:a,style:{width:"100px",height:"100px"},src:f.imgurl(e.file_url),"hide-on-click-modal":"true","preview-teleported":"true",class:"ml5","preview-src-list":[f.imgurl(e.file_url)]},null,8,["src","preview-src-list"])))),128))])])):k("",!0)])])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])}]]);export{oe as default};
