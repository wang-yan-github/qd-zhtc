import{f as e,b as a,q as l,L as t,r as n,o as i,h as r,i as s,k as o,l as d,F as c,j as u,c as p,m as g,t as m,p as h,s as f,x as _}from"./vendor.ac52fd94.js";import{h as b,s as y,i as v}from"./parkingOrder.a8222210.js";import{_ as C}from"./index.1d57ac4a.js";const q={name:"cashList",data:()=>({tableH:0}),setup(){const t=e({time:""}),n=e({inspect_id:"",is_verification:"0",startDate:"",endDate:"",pageIndex:1,pageSize:15}),i=a([]),r=a(0),s=a("0"),o=a(!0);1==localStorage.getItem("user_type")&&(o.value=!1);const d=()=>{y(n).then((e=>{console.log(e),""==n.inspect_id||null==n.inspect_id?l.warning("请选择巡检员"):(i.value=e.data.pageInfo.list,r.value=e.data.pageInfo.total,"0"==n.is_verification?s.value=e.data.money:s.value="0")}))};d();const c=e=>`${e.getFullYear()}-${e.getMonth()+1>=10?e.getMonth()+1:"0"+(e.getMonth()+1)}-${e.getDate()>=10?e.getDate():"0"+e.getDate()}`;let u=e({inspectManages:[]});v().then((e=>{u.inspectManages=e.data}));const p=a("");return{form:u,isControl:o,queryTime:t,query:n,tableData:i,pageTotal:r,getData:d,handleSearch:()=>{n.pageIndex=1,d()},handlePageChange:e=>{n.pageIndex=e,d()},getQueryDate:()=>{null==u.time||[]==u.time||""==u.time?(n.startTime="",n.endTime=""):(n.startTime=c(u.time[0]),n.endTime=c(u.time[1]))},selectVal:p,money:s}},methods:{handleSelectionChange(e){this.selectedData=e},handleChange(e){let a={};a=this.form.inspectManages.find((a=>a.id===e)),null!=a&&""!=a&&null!=a&&(this.selectVal=a.name)},handleDeleteAll(){const e="确定要核销"+this.selectVal+"的所有现金订单吗？";var a=this;""==a.query.inspect_id||null==a.query.inspect_id?l.warning("请选择巡检员"):""==a.query.is_verification||null==a.query.is_verification?l.warning("请选择核销状态"):"1"==a.query.is_verification?l.warning("选择未核销状态才可核销"):t.confirm(e,"提示",{type:"warning"}).then((()=>{b({xjyId:a.query.inspect_id,startDate:a.query.startDate,endDate:a.query.endDate}).then((e=>{l.success("核销成功"),a.getData()}))})).catch((()=>{}))}},created(){let e=document.documentElement.clientHeight||document.body.clientHeight;this.tableH=e-308+"px"}},x=e=>(f("data-v-d746f564"),e=e(),_(),e),D={class:"container"},w={class:"top-panel"},k={class:"tip"},V=x((()=>s("span",null,"待核销金额：",-1))),T=x((()=>s("span",null,"(元)",-1))),z={class:"pagination"};var I=C(q,[["render",function(e,a,l,t,f,_){const b=n("el-option"),y=n("el-select"),v=n("el-form-item"),C=n("el-date-picker"),q=n("el-button"),x=n("el-form"),I=n("el-col"),M=n("el-row"),S=n("el-table-column"),j=n("el-table"),H=n("el-pagination");return i(),r("div",null,[s("div",D,[o(M,null,{default:d((()=>[o(I,{xs:24,sm:24,md:24,lg:18,xl:18},{default:d((()=>[s("div",w,[o(x,{"label-width":"80px",inline:"",size:"small"},{default:d((()=>[o(v,{label:"巡检员"},{default:d((()=>[o(y,{onChange:_.handleChange,modelValue:t.query.inspect_id,"onUpdate:modelValue":a[0]||(a[0]=e=>t.query.inspect_id=e),filterable:"",size:"small",placeholder:"巡检员"},{default:d((()=>[o(b,{key:"",label:"请选择",value:""}),(i(!0),r(c,null,u(t.form.inspectManages,(e=>(i(),p(b,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["onChange","modelValue"])])),_:1}),o(v,{label:"核销状态"},{default:d((()=>[o(y,{onChange:_.handleChange,modelValue:t.query.is_verification,"onUpdate:modelValue":a[1]||(a[1]=e=>t.query.is_verification=e),filterable:"",size:"small",placeholder:"核销状态"},{default:d((()=>[o(b,{key:"0",label:"未核销 ",value:"0"}),o(b,{key:"1",label:"已核销",value:"1"})])),_:1},8,["onChange","modelValue"])])),_:1}),o(v,{label:"支付时间"},{default:d((()=>[o(C,{size:"small",modelValue:t.queryTime.time,"onUpdate:modelValue":a[2]||(a[2]=e=>t.queryTime.time=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",class:"datepicker",onChange:t.getQueryDate},null,8,["modelValue","onChange"])])),_:1}),o(v,null,{default:d((()=>[o(q,{size:"small",type:"primary",icon:"el-icon-search",onClick:t.handleSearch},{default:d((()=>[g("查询 ")])),_:1},8,["onClick"])])),_:1})])),_:1})])])),_:1}),t.isControl?(i(),p(I,{key:0,xs:24,sm:24,md:24,lg:6,xl:6},{default:d((()=>[s("div",k,[s("p",null,[V,s("b",null,m(t.money),1),g(),T]),o(q,{size:"small",type:"success",icon:"el-icon-bank-card",onClick:a[3]||(a[3]=e=>_.handleDeleteAll())},{default:d((()=>[g("核销 ")])),_:1})])])),_:1})):h("",!0)])),_:1}),o(j,{data:t.tableData,border:"",class:"table",ref:"multipleTable","max-height":f.tableH,"header-cell-class-name":"table-header"},{default:d((()=>[o(S,{label:"序号",width:"55",align:"center"},{default:d((e=>[g(m(e.$index+1),1)])),_:1}),o(S,{prop:"order_no",label:"订单号",width:"200",align:"center"}),o(S,{prop:"park_name",label:"停车场"}),o(S,{prop:"berth",label:"泊位编号",width:"200",align:"center"}),o(S,{prop:"car_no",label:"车牌号码",width:"100",align:"center"}),o(S,{prop:"drivein_time",label:"停入时间",width:"180",align:"center"}),o(S,{prop:"driveout_time",label:"离场时间",width:"180",align:"center"}),o(S,{prop:"resTime",width:"100",label:"停留时间",align:"center"}),o(S,{prop:"sum_amount",label:"停车费用",width:"100",align:"center"}),o(S,{prop:"state_name",label:"状态",width:"120",align:"center"})])),_:1},8,["data","max-height"]),s("div",z,[o(H,{background:"",layout:"total, prev, pager, next","current-page":t.query.pageIndex,"page-size":t.query.pageSize,total:t.pageTotal,onCurrentChange:t.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])])])}],["__scopeId","data-v-d746f564"]]);export{I as default};
