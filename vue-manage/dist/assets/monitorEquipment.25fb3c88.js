import{f as e,b as l,q as a,r as t,M as d,o as n,h as r,i as o,w as i,c as u,l as s,m,k as p,I as c,F as h,j as g,L as f}from"./vendor.ac52fd94.js";import{I as _,_ as b}from"./index.1d57ac4a.js";const q=e=>_({url:"/monitorEquipment/addMonitorEquipment",method:"post",params:e}),V={name:"monitorEquipment",data:()=>({tableH:0}),setup(t,d){const n=e({equipName:"",areaId:"",pageIndex:1,pageSize:15}),r=l([]),o=l(0);let i=l(""),u=l([]),s=l("新增");const m=l(!1);let p=l({});const c=()=>{(e=>_({url:"/monitorEquipment/selectList",method:"post",params:e}))(n).then((e=>{r.value=e.data.list,o.value=e.data.total}))};c(),(e=>_({url:"/monitorEquipment/getAreas",method:"post",params:e}))(n).then((e=>{u.value=e.data}));const h=l(null);return{query:n,tableData:r,pageTotal:o,editVisible:m,form:p,formId:h,areas:u,equipId:i,formRules:{equipment_name:[{required:!0,message:"请输入设备名称",trigger:"blur"}],equipment_code:[{required:!0,message:"请输入设备编码",trigger:"blur"}],token:[{required:!0,message:"请输入设备token",trigger:"blur"}],equipment_account:[{required:!0,message:"请输入设备账号",trigger:"blur"}],equipment_pwd:[{required:!0,message:"请输入设备密码",trigger:"blur"}],rtsp_address:[{required:!0,message:"请输入rtsp地址",trigger:"blur"}],area_id:[{required:!0,message:"请选择区域",trigger:"blur"}]},dialogT:s,handleSearch:()=>{n.pageIndex=1,c()},handlePageChange:e=>{n.pageIndex=e,c()},handleDelete:(l,t)=>{f.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{(e=>_({url:"/monitorEquipment/delMonitorEquipment",method:"post",params:e}))(e({id:t.id})).then((e=>{0==e.code?(a.success("删除成功"),r.value.splice(l,1)):a.error(e.msg)}))})).catch((()=>{}))},handleEdit:(l,a,t)=>{if(t)p.value={},i="",s.value="新增";else{s.value="编辑",p.value.id=a.id,i=a.id;(e=>_({url:"/monitorEquipment/getMonitorEquipment",method:"post",params:e}))(e({id:i})).then((e=>{p.value=e.data}))}m.value=!0,h.value.clearValidate()},saveEdit:()=>{h.value.validate((e=>{if(!e)return a.error("请输入必填项！"),!1;null!=i&&""!=i?q(p.value).then((e=>{0==e.code?(a.success("修改成功"),m.value=!1):a.error(e.msg)})):q(p.value).then((e=>{0==e.code?(a.success("新增成功"),m.value=!1):a.error(e.msg)}))}))},multipleSelection:[],value:!0,activeName:"first"}},created(){let e=document.documentElement.clientHeight||document.body.clientHeight;this.tableH=e-308+"px"},methods:{handleSelectionChange(e){this.selectedData=e},handleDeleteAll(){var e=this,l=this.selectedData;l?(l.forEach((function(l,a){e.tableData.forEach((function(a,t){l===a&&e.tableData.splice(t,1)}))})),a.success("删除成功"),this.$refs.multipleTable.clearSelection()):a.warning("请选择一条记录")}}},v={class:"container"},k={class:"handle-box"},y={class:"left-panel"},w={class:"right-panel"},C=o("div",{class:"clear"},null,-1),E={class:"pagination"},x={class:"dialog-footer"};var S=b(V,[["render",function(e,l,a,f,_,b){const q=t("el-button"),V=t("el-input"),S=t("el-form-item"),I=t("el-option"),U=t("el-select"),z=t("el-form"),T=t("el-table-column"),D=t("el-table"),H=t("el-pagination"),N=t("el-dialog"),M=d("permission"),P=d("loading");return n(),r("div",null,[o("div",v,[o("div",k,[o("div",y,[i((n(),u(q,{type:"primary",size:"small",icon:"el-icon-plus",onClick:l[0]||(l[0]=e=>f.handleEdit(null,null,!0))},{default:s((()=>[m("添加")])),_:1})),[[M,["road_equipment_add","park_equipment_add"]]])]),o("div",w,[p(z,{inline:"","label-width":"80",class:"lineH0"},{default:s((()=>[p(S,{label:"",class:"search-mb0"},{default:s((()=>[p(V,{onKeyup:l[1]||(l[1]=c((e=>f.handleSearch()),["enter"])),size:"small",modelValue:f.query.equipName,"onUpdate:modelValue":l[2]||(l[2]=e=>f.query.equipName=e),class:"handle-input",placeholder:"输入设备名称"},null,8,["modelValue"])])),_:1}),p(S,{label:"",class:"search-mb0"},{default:s((()=>[p(U,{modelValue:f.query.areaId,"onUpdate:modelValue":l[3]||(l[3]=e=>f.query.areaId=e),filterable:"",size:"small",placeholder:"所有区域"},{default:s((()=>[p(I,{key:"",label:"选择区域",value:""}),(n(!0),r(h,null,g(f.areas,((e,l)=>(n(),u(I,{key:l,label:e.area_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),p(S,{label:"",class:"search-mb0"},{default:s((()=>[p(q,{size:"small",type:"primary",icon:"el-icon-search",onClick:f.handleSearch},{default:s((()=>[m("查询")])),_:1},8,["onClick"])])),_:1})])),_:1})]),C]),p(D,{data:f.tableData,border:"",class:"table","max-height":_.tableH,ref:"multipleTable","header-cell-class-name":"table-header",onSelectionChange:b.handleSelectionChange},{default:s((()=>[p(T,{type:"index",label:"序号",width:"55",align:"center"}),p(T,{prop:"equipment_name",label:"设备名称",width:"300",align:"center"}),p(T,{prop:"equipment_code",label:"设备编码",width:"300",align:"center"}),p(T,{prop:"areaName",label:"区域",align:"center",width:"200"}),p(T,{prop:"install_address",label:"安装地址",align:"center"}),p(T,{prop:"rtsp_address",label:"rtsp地址",width:"400",align:"center"}),p(T,{label:"操作",width:"220",align:"center"},{default:s((e=>[i((n(),u(q,{size:"mini",type:"text",icon:"el-icon-edit",onClick:l=>f.handleEdit(e.id,e.row,!1)},{default:s((()=>[m("编辑 ")])),_:2},1032,["onClick"])),[[M,["road_equipment_edit","park_equipment_edit"]]]),i((n(),u(q,{size:"mini",type:"text",icon:"el-icon-delete",class:"red",onClick:l=>f.handleDelete(e.$index,e.row)},{default:s((()=>[m("删除")])),_:2},1032,["onClick"])),[[M,["road_equipment_delete","park_equipment_delete"]]])])),_:1})])),_:1},8,["data","max-height","onSelectionChange"]),o("div",E,[p(H,{background:"",layout:"total, prev, pager, next","current-page":f.query.pageIndex,"page-size":f.query.pageSize,total:f.pageTotal,onCurrentChange:f.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),i((n(),u(N,{title:f.dialogT,modelValue:f.editVisible,"onUpdate:modelValue":l[14]||(l[14]=e=>f.editVisible=e),width:"30%"},{footer:s((()=>[o("span",x,[p(q,{onClick:l[12]||(l[12]=e=>f.editVisible=!1)},{default:s((()=>[m("取 消")])),_:1}),p(q,{type:"primary",onClick:l[13]||(l[13]=e=>f.saveEdit())},{default:s((()=>[m("确 定")])),_:1})])])),default:s((()=>[p(z,{"label-width":"100px",rules:f.formRules,ref:"formId",model:f.form},{default:s((()=>[p(S,{label:"设备名称",prop:"equipment_name"},{default:s((()=>[p(V,{modelValue:f.form.equipment_name,"onUpdate:modelValue":l[4]||(l[4]=e=>f.form.equipment_name=e),placeholder:"请输入设备名称"},null,8,["modelValue"])])),_:1}),p(S,{label:"设备编号",prop:"equipment_code"},{default:s((()=>[p(V,{modelValue:f.form.equipment_code,"onUpdate:modelValue":l[5]||(l[5]=e=>f.form.equipment_code=e),placeholder:"请输入设备编号"},null,8,["modelValue"])])),_:1}),p(S,{label:"Token",prop:"token"},{default:s((()=>[p(V,{modelValue:f.form.token,"onUpdate:modelValue":l[6]||(l[6]=e=>f.form.token=e),placeholder:"请输入Token"},null,8,["modelValue"])])),_:1}),p(S,{label:"设备账号",prop:"equipment_account"},{default:s((()=>[p(V,{modelValue:f.form.equipment_account,"onUpdate:modelValue":l[7]||(l[7]=e=>f.form.equipment_account=e),placeholder:"请输入设备账号"},null,8,["modelValue"])])),_:1}),p(S,{label:"设备密码",prop:"equipment_pwd"},{default:s((()=>[p(V,{modelValue:f.form.equipment_pwd,"onUpdate:modelValue":l[8]||(l[8]=e=>f.form.equipment_pwd=e),placeholder:"请输入设备密码"},null,8,["modelValue"])])),_:1}),p(S,{label:"RTSP地址",prop:"rtsp_address"},{default:s((()=>[p(V,{modelValue:f.form.rtsp_address,"onUpdate:modelValue":l[9]||(l[9]=e=>f.form.rtsp_address=e),placeholder:"请输入RTSP地址"},null,8,["modelValue"])])),_:1}),p(S,{label:"安装地址"},{default:s((()=>[p(V,{modelValue:f.form.install_address,"onUpdate:modelValue":l[10]||(l[10]=e=>f.form.install_address=e),placeholder:"请输入安装地址"},null,8,["modelValue"])])),_:1}),p(S,{label:"区域",class:"w",prop:"area_id"},{default:s((()=>[p(U,{modelValue:f.form.area_id,"onUpdate:modelValue":l[11]||(l[11]=e=>f.form.area_id=e),placeholder:"请选择",class:"w100p"},{default:s((()=>[(n(!0),r(h,null,g(f.areas,((e,l)=>(n(),u(I,{key:l,label:e.area_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["title","modelValue"])),[[P,e.loading]])])}]]);export{S as default};
