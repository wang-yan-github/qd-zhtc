import{f as e,b as a,q as l,r as t,M as n,o as i,h as o,i as r,k as d,l as s,I as c,F as p,j as u,c as h,m as b,t as m,w as g,L as _}from"./vendor.ac52fd94.js";import{g as f,a as v,i as w,b as k}from"./fapiao.bf772239.js";import{_ as y}from"./index.1d57ac4a.js";const x={name:"dkfplist",data:()=>({tableH:0}),setup(){const t=e({phone:"",invoice_mode:"",pageIndex:1,pageSize:10}),n=a([]),i=a([]),o=a(0),r=a([]),d=()=>{f(e({type:"invoice_mode"})).then((e=>{r.value=e.data}))};d();const s=()=>{v(t).then((e=>{let a=e.data;n.value=a.list,o.value=a.total}))};s();const c=a(!1);let p=e({});return{query:t,tableData:n,tableDetailsData:i,pageTotal:o,dateFormat:(e,a)=>{var l=new Date(e.application_time),t=l.getFullYear(),n=l.getMonth()+1,i=l.getDate(),o=l.getHours(),r=l.getMinutes(),d=l.getSeconds();return t+"-"+(n<10?"0"+n:n)+"-"+(i<10?"0"+i:i)+" "+(o<10?"0"+o:o)+":"+(r<10?"0"+r:r)+":"+(d<10?"0"+d:d)},detailsVisible:c,form:p,dialogT:"新增",invoicesMode:r,getDictsMode:d,handleSearch:()=>{t.pageIndex=1,s()},handlePageChange:e=>{t.pageIndex=e,s()},approvalInvoicing:(a,t)=>{_.confirm("确定开票完成","提示",{type:"warning"}).then((()=>{const a=e({id:t.id});w(a).then((e=>{0==e.code?(l.success("操作成功！"),s()):l.error(e.msg)}))})).catch((()=>{}))},openDetails:(e,a)=>{k({invoicesId:a.id}).then((e=>{i.value=e.data,c.value=!0}))},multipleSelection:[],value:!0,activeName:"first"}},methods:{handleSelectionChange(e){this.selectedData=e},handleDeleteAll(){var e=this,a=this.selectedData;a?(a.forEach((function(a,l){e.tableData.forEach((function(l,t){a===l&&e.tableData.splice(t,1)}))})),l.success("删除成功"),this.$refs.multipleTable.clearSelection()):l.warning("请选择一条记录")}},created(){let e=document.documentElement.clientHeight||document.body.clientHeight;this.tableH=e-308+"px"}},D={class:"container"},C={class:"handle-box f-cb"},V=r("br",null,null,-1),q=r("br",null,null,-1),z=r("br",null,null,-1),S=r("br",null,null,-1),I=r("br",null,null,-1),H=r("br",null,null,-1),M={class:"pagination"},T={class:"dialog-footer"};var j=y(x,[["render",function(e,a,l,_,f,v){const w=t("el-input"),k=t("el-form-item"),y=t("el-option"),x=t("el-select"),j=t("el-button"),F=t("el-form"),$=t("el-table-column"),E=t("el-table"),U=t("el-pagination"),N=t("el-dialog"),P=n("permission");return i(),o("div",null,[r("div",D,[r("div",C,[d(F,{size:"small",inline:"",class:"lineH0"},{default:s((()=>[d(k,{label:"手机号",class:"search-mb0"},{default:s((()=>[d(w,{onKeyup:a[0]||(a[0]=c((e=>_.handleSearch()),["enter"])),modelValue:_.query.phone,"onUpdate:modelValue":a[1]||(a[1]=e=>_.query.phone=e),placeholder:"手机号",class:"handle-input mr10 w170"},null,8,["modelValue"])])),_:1}),d(k,{label:"开票状态",class:"search-mb0"},{default:s((()=>[d(x,{modelValue:_.query.invoice_mode,"onUpdate:modelValue":a[2]||(a[2]=e=>_.query.invoice_mode=e),filterable:"",size:"small",placeholder:"全部",class:"w100"},{default:s((()=>[d(y,{key:"",label:"所有",value:""}),(i(!0),o(p,null,u(_.invoicesMode,(e=>(i(),h(y,{key:e.dc_value,label:e.label,value:e.dc_value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),d(k,{label:"",class:"search-mb0"},{default:s((()=>[d(j,{size:"small",type:"primary",icon:"el-icon-search",onClick:_.handleSearch},{default:s((()=>[b("查询 ")])),_:1},8,["onClick"])])),_:1})])),_:1})]),d(E,{data:_.tableData,border:"",class:"table",ref:"multipleTable","max-height":f.tableH,"header-cell-class-name":"table-header"},{default:s((()=>[d($,{type:"index",label:"序号",width:"55",align:"center"},{default:s((e=>[b(m(e.$index+1),1)])),_:1}),d($,{prop:"memberName",label:"申请人",width:"100",align:"center"}),d($,{prop:"phone",label:"手机号",width:"150",align:"center"}),d($,{prop:"invoice_type",label:"发票类型",width:"150",align:"center"}),d($,{label:"发票信息",align:"center"},{default:s((e=>[b(m(null==e.row.invoice_header||""==e.row.invoice_header?"--":e.row.invoice_header),1),V,b(" "+m(null==e.row.duty_paragraph||""==e.row.duty_paragraph?"--":e.row.duty_paragraph),1),q,b(" "+m(null==e.row.address||""==e.row.address?"--":e.row.address),1),z,b(" "+m(null==e.row.bank_of_deposit||""==e.row.bank_of_deposit?"--":e.row.bank_of_deposit),1),S,b(" "+m(null==e.row.bank_account||""==e.row.bank_account?"--":e.row.bank_account),1),I,b(" "+m(null==e.row.contact_info||""==e.row.contact_info?"--":e.row.contact_info),1),H])),_:1}),d($,{align:"center",label:"收票人",prop:"receiver",width:"100"}),d($,{align:"center",label:"收票人手机号",prop:"receive_phone",width:"150"}),d($,{align:"center",label:"收票人地址",prop:"receive_address",width:"100"}),d($,{prop:"application_time",label:"申请时间",align:"center",formatter:_.dateFormat,width:"180"},null,8,["formatter"]),d($,{prop:"invoice_mode",label:"状态",align:"center",width:"100"}),d($,{label:"操作",width:"200",align:"center"},{default:s((e=>["已开票"==e.row.invoice_mode?(i(),h(j,{key:0,size:"mini",type:"text",icon:"el-icon-finished",disabled:""},{default:s((()=>[b(" 开票完成 ")])),_:1})):g((i(),h(j,{key:1,size:"mini",type:"text",icon:"el-icon-finished",onClick:a=>_.approvalInvoicing(e.$index,e.row)},{default:s((()=>[b(" 开票完成 ")])),_:2},1032,["onClick"])),[[P,["road_dkfplist_kpwc","park_dkfplist_kpwc"]]]),g((i(),h(j,{size:"mini",type:"text",icon:"el-icon-finished",onClick:a=>_.openDetails(e.$index,e.row)},{default:s((()=>[b(" 开票详情 ")])),_:2},1032,["onClick"])),[[P,["road_dkfplist_kpxq","park_dkfplist_kpxq"]]])])),_:1})])),_:1},8,["data","max-height"]),r("div",M,[d(U,{background:"",layout:"total, prev, pager, next","current-page":_.query.pageIndex,"page-size":_.query.pageSize,total:_.pageTotal,onCurrentChange:_.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),d(N,{title:"发票详情",modelValue:_.detailsVisible,"onUpdate:modelValue":a[4]||(a[4]=e=>_.detailsVisible=e),width:"45%"},{footer:s((()=>[r("span",T,[d(j,{onClick:a[3]||(a[3]=e=>_.detailsVisible=!1)},{default:s((()=>[b("关 闭")])),_:1})])])),default:s((()=>[d(E,{data:_.tableDetailsData,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:s((()=>[d($,{type:"index",label:"序号",width:"55",align:"center"}),d($,{prop:"order_no",label:"订单号",align:"center"}),d($,{prop:"drivein_time",label:"进场时间",align:"center"}),d($,{prop:"driveout_time",label:"出场时间",align:"center"}),d($,{prop:"paid_amount",label:"已付金额",align:"center"})])),_:1},8,["data"])])),_:1},8,["modelValue"])])}]]);export{j as default};
