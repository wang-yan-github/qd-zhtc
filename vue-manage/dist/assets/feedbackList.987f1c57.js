import{f as e,b as a,q as l,r as t,M as i,o as n,h as d,i as s,k as o,l as r,I as c,m as u,w as p,c as m,t as h,p as f,F as g,j as b}from"./vendor.ac52fd94.js";import{g as _,h as y,i as k,j as w}from"./operateAppeal.32354e90.js";import{_ as v}from"./index.1d57ac4a.js";const V={name:"userList",data:()=>({tableH:0,formRules:{reply_content:[{required:!0,message:"必填项",trigger:"blur"}]}}),components:{},setup(){const l=e({car_no:"",feedback_content:"",pageIndex:1,pageSize:15}),t=a([]),i=a(0),n=()=>{k(l).then((e=>{console.log(e.data),t.value=e.data.list,i.value=e.data.total}))};n();const d=a(!1);let s=a({}),o=a(!0);const r=a({id:"",reply_content:""});return{query:l,tableData:t,pageTotal:i,viewVisible:d,detailData:s,form:r,liHide:o,handleView:(a,l)=>{w(e({id:l.id})).then((e=>{s.value=e.data,r.value.id=l.id,2==l.feedback_status&&(o.value=!1)})),d.value=!0},handleSearch:()=>{l.pageIndex=1,n()},handlePageChange:e=>{l.pageIndex=e,n()},getData:n,multipleSelection:[],dialogImageUrl:"",ppVisible:!1}},created(){let e=document.documentElement.clientHeight||document.body.clientHeight;this.tableH=e-308+"px"},methods:{handleRemove(e,a){console.log(e,a)},handlePictureCardPreview(e){this.dialogImageUrl=e.url,this.ppVisible=!0},handleSelectionChange(e){this.selectedData=e},handleCommand(e){this.$message("click on item "+e)},imgurl:function(e){if(""!=e&&null!=e)return e},saveEdit(e){let a=0,t="",i=this;this.$refs[e].validate((e=>{e&&_(i.form).then((e=>{a=e.code,t=e.msg})).then((()=>{0==a?(l.success(t),i.viewVisible=!1,i.query.pageIndex=1,i.getData()):-1==a&&l.error(t)}))}))},exportFeedBack(){l.success("正在下载中·····"),y(this.query).then((e=>{const a=window.URL.createObjectURL(new Blob([e])),l=document.createElement("a");l.href=a,l.setAttribute("download","反馈建议.xls"),document.body.appendChild(l),l.click()}))}}},x={class:"container"},C={class:"handle-box"},D={class:"left-panel"},z=s("div",{class:"clear"},null,-1),q={class:"pagination"},S={class:"desctable"},H=s("td",{class:"tit",width:"80"},"内容",-1),I={colspan:"3"},U=s("td",{class:"tit",width:"80"},"车牌号",-1),L=s("td",{class:"tit",width:"80"},"联系方式",-1),j={key:0},R=s("td",{class:"tit",width:"80"},"附件",-1),E={colspan:"3"},P=s("td",{class:"tit",width:"80"},"状态",-1),$={key:0,colspan:"3"},B={key:1,colspan:"3"},F={key:1},T=s("td",{class:"tit",width:"80"},"回复详情",-1),A={colspan:"3"},K={key:0,class:"dialog-footer"};var M=v(V,[["render",function(e,a,l,_,y,k){const w=t("el-input"),v=t("el-form-item"),V=t("el-button"),M=t("el-form"),O=t("el-table-column"),G=t("el-tag"),J=t("el-table"),N=t("el-pagination"),Q=t("el-image"),W=t("el-dialog"),X=i("permission");return n(),d("div",null,[s("div",x,[s("div",C,[s("div",D,[o(M,{inline:"",size:"small",class:"lineH0"},{default:r((()=>[o(v,{label:"关键字",class:"search-mb0"},{default:r((()=>[o(w,{onKeyup:a[0]||(a[0]=c((e=>_.handleSearch()),["enter"])),size:"small",modelValue:_.query.feedback_content,"onUpdate:modelValue":a[1]||(a[1]=e=>_.query.feedback_content=e),placeholder:"请输入内容关键字",class:"handle-input mr10 w170"},null,8,["modelValue"])])),_:1}),o(v,{label:"车牌号",class:"search-mb0"},{default:r((()=>[o(w,{onKeyup:a[2]||(a[2]=c((e=>_.handleSearch()),["enter"])),size:"small",modelValue:_.query.carno,"onUpdate:modelValue":a[3]||(a[3]=e=>_.query.carno=e),placeholder:"请输入车牌号",class:"handle-input mr10 w170"},null,8,["modelValue"])])),_:1}),o(v,{class:"search-mb0"},{default:r((()=>[o(V,{size:"small",type:"primary",icon:"el-icon-search",onClick:_.handleSearch},{default:r((()=>[u("查询")])),_:1},8,["onClick"]),p((n(),m(V,{size:"small",type:"success",icon:"el-icon-upload2",onClick:k.exportFeedBack},{default:r((()=>[u("导出")])),_:1},8,["onClick"])),[[X,["park_feedbacklist_excel","road_feedbacklist_excel"]]])])),_:1})])),_:1})]),z]),o(J,{data:_.tableData,border:"",class:"table",ref:"multipleTable","max-height":y.tableH,"header-cell-class-name":"table-header",onSelectionChange:k.handleSelectionChange},{default:r((()=>[o(O,{label:"序号",width:"55",align:"center"},{default:r((e=>[u(h(e.$index+1),1)])),_:1}),o(O,{prop:"feedback_content",label:"内容"}),o(O,{label:"用户账号",prop:"phone",width:"120",align:"center"}),o(O,{prop:"carno",label:"车牌号码",align:"center",width:"180"}),o(O,{prop:"feedback_time",label:"反馈时间",width:"180",align:"center"}),o(O,{label:"状态",align:"center",width:"100"},{default:r((e=>[1==e.row.feedback_status?(n(),m(G,{key:0,size:"small",type:"warning"},{default:r((()=>[u("待回复")])),_:1})):(n(),m(G,{key:1,size:"small"},{default:r((()=>[u("已回复")])),_:1}))])),_:1}),o(O,{label:"操作",width:"120",align:"center"},{default:r((e=>[p((n(),m(V,{size:"mini",type:"text",icon:"el-icon-view",onClick:a=>_.handleView(e.$index,e.row)},{default:r((()=>[u(" 详情 ")])),_:2},1032,["onClick"])),[[X,["road_feedbacklist_details","park_feedbacklist_details"]]])])),_:1})])),_:1},8,["data","max-height","onSelectionChange"]),s("div",q,[o(N,{background:"",layout:"total, prev, pager, next","current-page":_.query.pageIndex,"page-size":_.query.pageSize,total:_.pageTotal,onCurrentChange:_.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),o(W,{title:"反馈详情",modelValue:_.viewVisible,"onUpdate:modelValue":a[8]||(a[8]=e=>_.viewVisible=e),width:"40%"},{footer:r((()=>[_.liHide?(n(),d("span",K,[o(V,{onClick:a[6]||(a[6]=e=>_.viewVisible=!1)},{default:r((()=>[u("取 消")])),_:1}),o(V,{type:"primary",onClick:a[7]||(a[7]=e=>k.saveEdit("formId"))},{default:r((()=>[u("确 定")])),_:1})])):f("",!0)])),default:r((()=>[s("table",S,[s("tr",null,[H,s("td",I,h(_.detailData.feedback_content),1)]),s("tr",null,[U,s("td",null,h(_.detailData.carno),1),L,s("td",null,h(_.detailData.tel_phone),1)]),void 0!==_.detailData.fileList&&_.detailData.fileList.length>0?(n(),d("tr",j,[R,s("td",E,[(n(!0),d(g,null,b(_.detailData.fileList,((e,a)=>(n(),m(Q,{key:a,style:{width:"100px",height:"100px"},"hide-on-click-modal":"true","preview-teleported":"true",src:k.imgurl(e),class:"ml5","preview-src-list":[k.imgurl(e)]},null,8,["src","preview-src-list"])))),128))])])):f("",!0),s("tr",null,[P,1==_.detailData.feedback_status?(n(),d("td",$,[o(G,{type:"warning"},{default:r((()=>[u("待回复")])),_:1})])):(n(),d("td",B,[o(G,{type:"success"},{default:r((()=>[u("已回复")])),_:1})]))]),1!=_.detailData.feedback_status?(n(),d("tr",F,[T,s("td",A,[(n(!0),d(g,null,b(_.detailData.replyList,((e,a)=>(n(),d(g,{key:a},[u(h(e.reply_content)+" ",1),s("p",null,h(e.reply_time),1)],64)))),128))])])):f("",!0)]),o(M,{"label-width":"80",class:"mt20","label-position":"top",rules:y.formRules,ref:"formId",model:_.form},{default:r((()=>[(e.idHide=!1)?(n(),m(w,{key:0,modelValue:_.form.id,"onUpdate:modelValue":a[4]||(a[4]=e=>_.form.id=e)},null,8,["modelValue"])):f("",!0),_.liHide?(n(),m(v,{key:1,label:"回复"},{default:r((()=>[o(w,{type:"textarea",rows:8,modelValue:_.form.reply_content,"onUpdate:modelValue":a[5]||(a[5]=e=>_.form.reply_content=e)},null,8,["modelValue"])])),_:1})):f("",!0)])),_:1},8,["rules","model"])])),_:1},8,["modelValue"])])}]]);export{M as default};
