import{f as e,b as l,q as a,L as t,r as i,M as n,o,h as d,i as s,w as r,c,l as u,m,k as h,I as f,t as p}from"./vendor.ac52fd94.js";import{U as g}from"./UE.013b43f7.js";import{d as _,a as b,e as v,s as y,b as C}from"./sysResourceIndex.2c650a03.js";import{_ as V}from"./index.1d57ac4a.js";const x={name:"actionList",components:{Ueditor:g},data:()=>({tableH:0,formRules:{title:[{required:!0,message:"必填项",trigger:"blur"}]}}),setup(){const i=e({title:"",category:"1",pageIndex:1,pageSize:15}),n=l([]),o=l(0),d=()=>{y(i).then((e=>{console.log(e),n.value=e.data.list,o.value=e.data.total}))};d();let s=l("编辑");const r=l(!1),c=l(!1),u=l({}),m=l([]),h=l([]);let f=e({config:{initialFrameHeight:300,initialFrameWidth:"100%"}});return{query:i,tableData:n,pageTotal:o,editVisible:r,form:u,uform:f,fileIds:m,fileList2:h,dialogT:s,getData:d,handleSearch:()=>{i.pageIndex=1,d()},handlePageChange:e=>{i.pageIndex=e,d()},handleDelete:(l,i)=>{t.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{let l=e({is_del:"1",id:i.id});v(l).then((e=>{console.log(e),a.success("删除成功")})).then((()=>{d()}))})).catch((()=>{}))},handleEdit:(l,a,t)=>{r.value=!0,u.value={},m.value=[],h.value=[],t?s.value="新增":(s.value="编辑",C(e({id:a.id})).then((e=>{u.value=e.data,""!=e.data.picture_id&&null!=e.data.picture_id?m.value=e.data.picture_id.split(","):m.value=[],""!=e.data.fileList&&null!=e.data.fileList?h.value=e.data.fileList:h.value=[]})))},multipleSelection:[],dialogImageUrl:"",dialogVisible:c}},created(){let e=document.documentElement.clientHeight||document.body.clientHeight;this.tableH=e-308+"px"},methods:{handleSuccess(e,l,a){this.fileIds.push(e.id+""),l.id=e.id,console.log(e,l,a)},handleRemove(l,t){console.log(l,t);let i=this.fileIds.indexOf(l.id+"");-1==i&&(i=this.fileIds.indexOf(l.id));let n=0;-1!=i&&_(e({id:l.id})).then((e=>{n=e.success})).then((()=>{0==n?(a.success("操作成功"),this.fileIds.splice(i,1)):-1==n&&a.error("操作失败!")}))},handlePictureCardPreview(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleSelectionChange(e){this.selectedData=e},handleDeleteAll(){t.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{var e=this,l=this.selectedData;console.log(l);var t="";l?(l.forEach((function(e,l){t=t+e.id+","})),b({ids:t}).then((l=>{a.success("删除成功"),e.getData()}))):a.warning("请选择一条记录")})).catch((()=>{}))},editorReady(e){this.$refs.ue.setText(this.form.content)},saveEdit(e){let l=0,t=this;this.$refs[e].validate((e=>{e&&(t.form.content=this.$refs.ue.getUEContent(),""==t.form.content||null==t.form.content||null==t.form.content?a.error("请填写内容!"):(t.form.category="1",t.form.fileList=[],t.fileIds.length>0?t.form.picture_id=t.fileIds.join(","):t.form.picture_id="",v(t.form).then((e=>{l=e.code})).then((()=>{0==l?(a.success("操作成功"),t.editVisible=!1,t.query.pageIndex=1,t.form.fileList=[],t.fileIds=[],this.$refs.ue.setText(""),t.getData()):-1==l&&a.error("操作失败!")}))))}))}}},I={class:"container"},z={class:"handle-box"},k={class:"left-panel"},w={class:"right-panel"},U=s("div",{class:"clear"},null,-1),D={class:"pagination"},S={class:"dialog-footer"},E={class:"customWidth"},q=["src"];var L=V(x,[["render",function(e,l,a,t,g,_){const b=i("el-button"),v=i("el-input"),y=i("el-table-column"),C=i("el-table"),V=i("el-pagination"),x=i("el-form-item"),L=i("Ueditor"),R=i("el-form"),T=i("el-dialog"),$=n("permission");return o(),d("div",null,[s("div",I,[s("div",z,[s("div",k,[r((o(),c(b,{type:"primary",size:"small",icon:"el-icon-plus",onClick:l[0]||(l[0]=e=>t.handleEdit(0,null,!0,null))},{default:u((()=>[m("添加 ")])),_:1})),[[$,["road_actionzn_add","park_actionzn_add"]]]),r((o(),c(b,{type:"danger",size:"small",icon:"el-icon-delete",onClick:l[1]||(l[1]=e=>_.handleDeleteAll())},{default:u((()=>[m("批量删除 ")])),_:1})),[[$,["park_actionzn_deleteAll","road_actionzn_deleteAll"]]])]),s("div",w,[h(v,{onKeyup:l[2]||(l[2]=f((e=>t.handleSearch()),["enter"])),size:"small",modelValue:t.query.title,"onUpdate:modelValue":l[3]||(l[3]=e=>t.query.title=e),placeholder:"标题",class:"handle-input mr10"},null,8,["modelValue"]),h(b,{size:"small",type:"primary",icon:"el-icon-search",onClick:t.handleSearch},{default:u((()=>[m("查询 ")])),_:1},8,["onClick"])]),U]),h(C,{data:t.tableData,border:"",class:"table",ref:"multipleTable","max-height":g.tableH,"header-cell-class-name":"table-header",onSelectionChange:_.handleSelectionChange},{default:u((()=>[h(y,{type:"selection",width:"55",align:"center"}),h(y,{label:"序号",width:"55",align:"center"},{default:u((e=>[m(p(e.$index+1),1)])),_:1}),h(y,{prop:"title",label:"标题"}),h(y,{label:"创建时间",prop:"create_time",width:"180",align:"center"}),h(y,{prop:"update_time",label:"更新时间",align:"center",width:"180"}),h(y,{label:"操作",width:"220",align:"center"},{default:u((e=>[r((o(),c(b,{size:"mini",type:"text",icon:"el-icon-edit",onClick:l=>t.handleEdit(e.$index,e.row,!1)},{default:u((()=>[m("编辑 ")])),_:2},1032,["onClick"])),[[$,["road_actionzn_edit","park_actionzn_edit"]]]),r((o(),c(b,{size:"mini",type:"text",icon:"el-icon-delete",class:"red",onClick:l=>t.handleDelete(e.$index,e.row)},{default:u((()=>[m("删除 ")])),_:2},1032,["onClick"])),[[$,["road_actionzn_delete","park_actionzn_delete"]]])])),_:1})])),_:1},8,["data","max-height","onSelectionChange"]),s("div",D,[h(V,{background:"",layout:"total, prev, pager, next","current-page":t.query.pageIndex,"page-size":t.query.pageSize,total:t.pageTotal,onCurrentChange:t.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),h(T,{title:t.dialogT,modelValue:t.editVisible,"onUpdate:modelValue":l[8]||(l[8]=e=>t.editVisible=e),width:"35%"},{footer:u((()=>[s("span",S,[h(b,{onClick:l[6]||(l[6]=e=>t.editVisible=!1)},{default:u((()=>[m("取 消")])),_:1}),h(b,{type:"primary",onClick:l[7]||(l[7]=e=>_.saveEdit("formId"))},{default:u((()=>[m("确 定")])),_:1})])])),default:u((()=>[h(R,{"label-width":"70px",size:"small",rules:g.formRules,ref:"formId","label-position":"top",model:t.form},{default:u((()=>[h(x,{label:"标题",prop:"title"},{default:u((()=>[h(v,{modelValue:t.form.title,"onUpdate:modelValue":l[4]||(l[4]=e=>t.form.title=e),placeholder:"请输入标题"},null,8,["modelValue"])])),_:1}),h(x,{label:"排序",prop:"sort"},{default:u((()=>[h(v,{modelValue:t.form.sort,"onUpdate:modelValue":l[5]||(l[5]=e=>t.form.sort=e),placeholder:"请输入排序",oninput:"value=value.replace(/[^\\d]/g,'')"},null,8,["modelValue"])])),_:1}),h(x,{label:"详情"},{default:u((()=>[h(L,{onReady:_.editorReady,ref:"ue",value:t.form.content,ueditorConfig:t.uform.config},null,8,["onReady","value","ueditorConfig"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["title","modelValue"]),h(T,{modelValue:t.dialogVisible,"onUpdate:modelValue":l[9]||(l[9]=e=>t.dialogVisible=e)},{default:u((()=>[s("div",E,[s("img",{class:"imgWidth",src:t.dialogImageUrl,alt:""},null,8,q)])])),_:1},8,["modelValue"])])}]]);export{L as default};
