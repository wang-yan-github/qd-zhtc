import{f as e,b as l,q as a,L as i,r as t,M as n,o as d,h as r,i as o,w as s,c as u,l as c,m,k as p,I as f,F as g,j as _,t as h,p as b}from"./vendor.ac52fd94.js";import{d as v}from"./sysResourceIndex.2c650a03.js";import{_ as V,a5 as w,a6 as y,U as x}from"./index.1d57ac4a.js";import{F as k}from"./file_url.ec979fed.js";import{i as j,a as C,b as I,c as z}from"./inspectManage.eb50b138.js";const D={name:"inspectManage",components:{},data:()=>({tableH:0,fileurl:k.file_img_url,formRules:{job_no:[{required:!0,message:"必填项",trigger:"blur"}],name:[{required:!0,message:"必填项",trigger:"blur"}],login_name:[{validator:(e,l,a)=>{if(!l)return a(new Error("必填项"));if(!/^[A-Za-z0-9]+$/.test(l))return a(new Error("登陆账号只能是字母或数字"));a()},required:!0,trigger:"blur"}],logpwd:[{required:!0,message:"必填项",trigger:"blur"}],qrpwd:[{required:!0,message:"必填项",trigger:"blur"}],phone:[{validator:(e,l,a)=>{if(!l)return a(new Error("必填项"));if(!/^1[3|4|5|6|7|8|9][0-9]\d{8}$/.test(l))return a(new Error("请输入正确的手机号"));a()},required:!0,trigger:"blur"}],age:[{validator:(e,l,a)=>{const i=/^[0-9]+$/;if(console.log(l),null!=l){if(!i.test(l))return a(new Error("请输入正确的年龄格式"));a()}else a()},trigger:"blur"}],idCard:[{validator:(e,l,a)=>{let i=/^\d{15}|(\d{17}(\d|x|X))$/.test(l);if(console.log(l),null!=l){if(!i)return a(new Error("请输入正确的身份证号"));if(15==l.length)a();else{if(18!=l.length)return a(new Error("请输入正确的身份证号"));a()}}else a()},trigger:"blur"}]}}),setup(){const a=e({area_id:"",street_id:"",road_id:"",name:"",pageIndex:1,pageSize:15}),i=e({area_list:[],street_list:[],road_list:[]}),t=l([]),n=l(0),d=()=>{I(a).then((e=>{t.value=e.data.list,n.value=e.data.total}))};d();w(a).then((e=>{i.area_list=e.data,console.log(e.data)}));let r=e({areaId:a.area_id});const o=e({streetId:a.street_id});let s=l("编辑");const u=l(!1),c=l(!1);l(!1);const m=l({}),p=l({berth_num:0,pic_url:""}),f=l({}),g=l([]),_=l([]),h=l(!1);return{query:a,tableData:t,pageTotal:n,editVisible:u,viewVisible:c,form:m,fileIds:g,fileList2:_,xjData:p,ldData:f,dialogT:s,getStreetList:e=>{r.areaId=a.area_id,i.road_list=[],a.road_id="",a.street_id="",y(r).then((e=>{i.street_list=e.data}))},getRoadList:()=>{o.streetId=a.street_id,a.road_id="",x(o).then((e=>{i.road_list=e.data}))},result:i,dialogVisible:h,handleSearch:()=>{a.pageIndex=1,d()},handlePageChange:e=>{a.pageIndex=e,d()},handleEdit:(l,a,i)=>{m.value="",g.value=[],_.value=[],i?(m.value={gender:0,personType:0},s.value="新增",u.value=!0):(s.value="编辑",z(e({id:a.id})).then((e=>{let l=e.data.manages;l.gender=parseInt(l.gender),l.personType=parseInt(l.personType),""!=l.picture_id&&null!=l.picture_id?g.value=l.picture_id.split(","):g.value=[],""!=l.fileList&&null!=l.fileList?_.value=l.fileList:_.value=[],m.value=l,u.value=!0})))},handleView:(l,a)=>{z(e({id:a.id})).then((e=>{p.value=e.data.manages;e.data.manages.fileList.length>0&&(p.value.pic_url=p.value.fileList[0].file_url),p.value.berth_num=a.berth_num,f.value=e.data.list,c.value=!0}))},getData:d,multipleSelection:[],dialogImageUrl:"",ppVisible:!1}},created(){let e=document.documentElement.clientHeight||document.body.clientHeight;this.tableH=e-308+"px"},methods:{handleSuccess(e,l,a){this.fileIds.push(e.id+""),l.id=e.id},handleRemove(l,i){let t=this.fileIds.indexOf(l.id+"");-1==t&&(t=this.fileIds.indexOf(l.id));let n=0;-1!=t&&v(e({id:l.id})).then((e=>{n=e.success})).then((()=>{0==n?(a.success("操作成功"),this.fileIds.splice(t,1)):-1==n&&a.error("操作失败!")}))},handlePictureCardPreview(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},imgurl:function(e){if(""!=e&&null!=e)return e},handleCommand(l){let t=this,n=1;i.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{j(e({id:l.id})).then((e=>{n=e})).then((()=>{1==n?(a.success("操作成功"),t.editVisible=!1,t.query.pageIndex=1,t.getData()):a.error("操作失败")}))})).catch((()=>{a.info("取消删除")}))},saveEdit(e){let l=0,i=this,t="";this.$refs[e].validate((e=>{e&&(i.form.fileList=[],i.fileIds.length>0?i.form.picture_id=i.fileIds.join(","):i.form.picture_id="",C(i.form).then((e=>{l=e.code,t=e.msg})).then((()=>{0==l?(a.success(t),i.editVisible=!1,i.form.fileList=[],i.fileIds=[],i.query.pageIndex=1,i.getData()):-1==l&&a.error(t)})))}))},addxunjian:function(e,l,a){this.$nextTick((()=>{this.$refs.formId.clearValidate()})),this.handleEdit(e,l,a)},resetBtn:function(){this.form.logpwd=""}}},q={class:"container"},U={class:"handle-box"},L={class:"left-panel"},S={class:"right-panel"},E=o("span",{class:"dispinline ml5"},null,-1),$=o("span",{class:"dispinline ml5"},null,-1),T=o("span",{class:"dispinline ml5"},null,-1),R=o("div",{class:"clear"},null,-1),P={key:0},H={key:1},W={key:0},M={key:1},F={key:0},O={key:1},A={class:"pagination"},B=o("i",{class:"el-icon-plus"},null,-1),K={class:"dialog-footer"},X=["src"],Z=o("i",{class:"el-icon-user"},null,-1),G=o("i",{class:"el-icon-user"},null,-1),J=o("i",{class:"el-icon-user"},null,-1),N=o("i",{class:"el-icon-help"},null,-1),Q={key:0},Y={key:1},ee=o("i",{class:"el-icon-time"},null,-1),le=o("i",{class:"el-icon-mobile-phone"},null,-1),ae=o("i",{class:"el-icon-bank-card"},null,-1),ie=o("i",{class:"el-icon-bank-card"},null,-1),te=o("i",{class:"el-icon-picture-outline"},null,-1),ne=o("i",{class:"el-icon-tickets"},null,-1),de=o("i",{class:"el-icon-tickets"},null,-1),re=o("i",{class:"el-icon-office-building"},null,-1),oe={class:"customWidth"},se=["src"];var ue=V(D,[["render",function(e,l,a,i,v,V){const w=t("el-button"),y=t("el-input"),x=t("el-option"),k=t("el-select"),j=t("el-form"),C=t("el-table-column"),I=t("el-table"),z=t("el-pagination"),D=t("el-form-item"),ue=t("el-radio"),ce=t("el-radio-group"),me=t("el-upload"),pe=t("el-dialog"),fe=t("el-descriptions-item"),ge=t("el-image"),_e=t("el-descriptions"),he=t("el-tag"),be=n("permission");return d(),r("div",null,[o("div",q,[o("div",U,[o("div",L,[s((d(),u(w,{type:"primary",size:"small",icon:"el-icon-plus",onClick:l[0]||(l[0]=e=>V.addxunjian(0,null,!0,null))},{default:c((()=>[m("添加")])),_:1})),[[be,["road_onsitemanaxj_add","park_onsitemana_add"]]])]),o("div",S,[p(j,{inline:"",size:"small"},{default:c((()=>[p(y,{size:"small",modelValue:i.query.name,"onUpdate:modelValue":l[1]||(l[1]=e=>i.query.name=e),onKeyup:l[2]||(l[2]=f((e=>i.handleSearch()),["enter"])),placeholder:"请输入姓名/手机号码",class:"handle-input mr10"},null,8,["modelValue"]),p(k,{modelValue:i.query.area_id,"onUpdate:modelValue":l[3]||(l[3]=e=>i.query.area_id=e),filterable:"",size:"small",placeholder:"所有区域",class:"w100",onChange:l[4]||(l[4]=e=>i.getStreetList())},{default:c((()=>[p(x,{value:""},{default:c((()=>[m("全部")])),_:1}),(d(!0),r(g,null,_(i.result.area_list,((e,l)=>(d(),u(x,{key:l,label:e.area_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),E,p(k,{modelValue:i.query.street_id,"onUpdate:modelValue":l[5]||(l[5]=e=>i.query.street_id=e),filterable:"",size:"small",placeholder:"所有街道",class:"w100",onChange:l[6]||(l[6]=e=>i.getRoadList())},{default:c((()=>[p(x,{value:""},{default:c((()=>[m("全部")])),_:1}),(d(!0),r(g,null,_(i.result.street_list,((e,l)=>(d(),u(x,{key:l,label:e.street_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),$,p(k,{modelValue:i.query.road_id,"onUpdate:modelValue":l[7]||(l[7]=e=>i.query.road_id=e),filterable:"",size:"small",placeholder:"所有路内",class:"w100"},{default:c((()=>[p(x,{value:""},{default:c((()=>[m("全部")])),_:1}),(d(!0),r(g,null,_(i.result.road_list,((e,l)=>(d(),u(x,{key:l,label:e.road_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),T,p(w,{size:"small",type:"primary",icon:"el-icon-search",onClick:i.handleSearch},{default:c((()=>[m("查询")])),_:1},8,["onClick"])])),_:1})]),R]),p(I,{data:i.tableData,border:"",class:"table",ref:"multipleTable","max-height":v.tableH,"header-cell-class-name":"table-header",onSelectionChange:e.handleSelectionChange},{default:c((()=>[p(C,{type:"index",label:"序号",width:"55",align:"center"},{default:c((e=>[m(h(e.$index+1),1)])),_:1}),p(C,{prop:"job_no",label:"工号",align:"center"}),p(C,{prop:"login_name",label:"登陆账号",align:"center"}),p(C,{prop:"name",label:"姓名",width:"100",align:"center"}),p(C,{label:"性别",align:"center",width:"100",prop:"gender"},{default:c((e=>["0"==e.row.gender?(d(),r("p",P,"男")):b("",!0),"1"==e.row.gender?(d(),r("p",H,"女")):b("",!0)])),_:1}),p(C,{prop:"age",label:"年龄",width:"100",align:"center"}),p(C,{prop:"idCard",label:"身份证号码",align:"center",width:"200"}),p(C,{prop:"phone",label:"电话",align:"center",width:"120"}),p(C,{prop:"invoice_balance",label:"发票余额",align:"center",width:"120"},{default:c((e=>[null==e.row.invoice_balance?(d(),r("p",W,"0.00")):(d(),r("p",M,h(e.row.invoice_balance),1))])),_:1}),p(C,{prop:"berth_num",label:"负责泊位总数",width:"140",align:"center"},{default:c((e=>[null==e.row.berth_num?(d(),r("p",F,"0")):(d(),r("p",O,h(e.row.berth_num),1))])),_:1}),p(C,{label:"操作",width:"220",align:"center"},{default:c((e=>[s((d(),u(w,{size:"mini",type:"text",icon:"el-icon-view",onClick:l=>i.handleView(e.$index,e.row)},{default:c((()=>[m("查看 ")])),_:2},1032,["onClick"])),[[be,["road_onsitemanaxj_details","park_onsitemana_details"]]]),s((d(),u(w,{size:"mini",type:"text",icon:"el-icon-edit",onClick:l=>V.addxunjian(e.$index,e.row,!1)},{default:c((()=>[m("编辑 ")])),_:2},1032,["onClick"])),[[be,["road_onsitemanaxj_edit","park_onsitemana_edit"]]]),s((d(),u(w,{size:"mini",type:"text",icon:"el-icon-delete",class:"red",onClick:l=>V.handleCommand(e.row,!1)},{default:c((()=>[m("删除 ")])),_:2},1032,["onClick"])),[[be,["road_onsitemanaxj_delete","park_onsitemana_delete"]]])])),_:1})])),_:1},8,["data","max-height","onSelectionChange"]),o("div",A,[p(z,{background:"",layout:"total, prev, pager, next","current-page":i.query.pageIndex,"page-size":i.query.pageSize,total:i.pageTotal,onCurrentChange:i.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),p(pe,{title:i.dialogT,modelValue:i.editVisible,"onUpdate:modelValue":l[18]||(l[18]=e=>i.editVisible=e),width:"35%",top:"5vh"},{footer:c((()=>[o("span",K,[p(w,{onClick:l[16]||(l[16]=e=>i.editVisible=!1)},{default:c((()=>[m("取 消")])),_:1}),p(w,{type:"primary",onClick:l[17]||(l[17]=e=>V.saveEdit("formId"))},{default:c((()=>[m("确 定")])),_:1})])])),default:c((()=>[p(j,{"label-width":"80px",rules:v.formRules,ref:"formId",model:i.form},{default:c((()=>[p(D,{label:"工号",prop:"job_no"},{default:c((()=>[p(y,{modelValue:i.form.job_no,"onUpdate:modelValue":l[8]||(l[8]=e=>i.form.job_no=e),placeholder:"请输入工号"},null,8,["modelValue"])])),_:1}),p(D,{label:"登陆账号",prop:"login_name","label-width":e.formLabelWidth},{default:c((()=>[p(y,{modelValue:i.form.login_name,"onUpdate:modelValue":l[9]||(l[9]=e=>i.form.login_name=e),placeholder:"请输入账号"},null,8,["modelValue"])])),_:1},8,["label-width"]),p(D,{label:"姓名",prop:"name"},{default:c((()=>[p(y,{modelValue:i.form.name,"onUpdate:modelValue":l[10]||(l[10]=e=>i.form.name=e),placeholder:"请输入姓名"},null,8,["modelValue"])])),_:1}),p(D,{label:"密码",prop:"logpwd"},{default:c((()=>[p(y,{type:"password",autocomplete:"new-password",modelValue:i.form.logpwd,"onUpdate:modelValue":l[11]||(l[11]=e=>i.form.logpwd=e),placeholder:"请输入密码"},null,8,["modelValue"])])),_:1}),p(D,{label:"性别"},{default:c((()=>[p(ce,{modelValue:i.form.gender,"onUpdate:modelValue":l[12]||(l[12]=e=>i.form.gender=e)},{default:c((()=>[p(ue,{label:0},{default:c((()=>[m("男")])),_:1}),p(ue,{label:1},{default:c((()=>[m("女")])),_:1})])),_:1},8,["modelValue"])])),_:1}),p(D,{label:"年龄",prop:"age"},{default:c((()=>[p(y,{modelValue:i.form.age,"onUpdate:modelValue":l[13]||(l[13]=e=>i.form.age=e),placeholder:"请输入年龄",type:"number"},null,8,["modelValue"])])),_:1}),p(D,{label:"联系电话",prop:"phone","label-width":e.formLabelWidth},{default:c((()=>[p(y,{modelValue:i.form.phone,"onUpdate:modelValue":l[14]||(l[14]=e=>i.form.phone=e),placeholder:"请输入电话"},null,8,["modelValue"])])),_:1},8,["label-width"]),p(D,{label:"身份证号",prop:"idCard"},{default:c((()=>[p(y,{modelValue:i.form.idCard,"onUpdate:modelValue":l[15]||(l[15]=e=>i.form.idCard=e),placeholder:"请输入身份证号"},null,8,["modelValue"])])),_:1}),p(D,{label:"上传照片(最多一张)"},{default:c((()=>[p(me,{action:v.fileurl,"list-type":"picture-card",limit:"1","on-preview":V.handlePictureCardPreview,"on-remove":V.handleRemove,"on-success":V.handleSuccess,"file-list":i.fileList2},{default:c((()=>[B])),_:1},8,["action","on-preview","on-remove","on-success","file-list"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["title","modelValue"]),p(pe,{modelValue:i.ppVisible,"onUpdate:modelValue":l[19]||(l[19]=e=>i.ppVisible=e)},{default:c((()=>[o("img",{width:"100%",src:i.dialogImageUrl,alt:""},null,8,X)])),_:1},8,["modelValue"]),p(pe,{title:"",modelValue:i.viewVisible,"onUpdate:modelValue":l[20]||(l[20]=e=>i.viewVisible=e),width:"40%"},{default:c((()=>[p(_e,{class:"margin-top handle-box",title:"基本信息",column:3,size:e.size,border:""},{default:c((()=>[p(fe,null,{label:c((()=>[Z,m(" 工号 ")])),default:c((()=>[m(" "+h(i.xjData.job_no),1)])),_:1}),p(fe,null,{label:c((()=>[G,m(" 登陆账号 ")])),default:c((()=>[m(" "+h(i.xjData.login_name),1)])),_:1}),p(fe,null,{label:c((()=>[J,m(" 姓名 ")])),default:c((()=>[m(" "+h(i.xjData.name),1)])),_:1}),p(fe,null,{label:c((()=>[N,m(" 性别 ")])),default:c((()=>[0==i.xjData.gender?(d(),r("p",Q,"男")):b("",!0),1==i.xjData.gender?(d(),r("p",Y,"女")):b("",!0)])),_:1}),p(fe,null,{label:c((()=>[ee,m(" 年龄 ")])),default:c((()=>[m(" "+h(i.xjData.age),1)])),_:1}),p(fe,null,{label:c((()=>[le,m(" 联系电话 ")])),default:c((()=>[m(" "+h(i.xjData.phone),1)])),_:1}),p(fe,null,{label:c((()=>[ae,m(" 身份证号 ")])),default:c((()=>[m(" "+h(i.xjData.idCard),1)])),_:1}),p(fe,null,{label:c((()=>[ie,m(" 发票余额 ")])),default:c((()=>[m(" "+h(i.xjData.invoice_balance),1)])),_:1}),p(fe,null,{label:c((()=>[te,m(" 照片 ")])),default:c((()=>[p(ge,{class:"table-td-thumb",src:V.imgurl(i.xjData.pic_url),"hide-on-click-modal":"true","preview-teleported":"true","preview-src-list":[V.imgurl(i.xjData.pic_url)]},null,8,["src","preview-src-list"])])),_:1})])),_:1},8,["size"]),p(_e,{class:"margin-top",title:"值班信息",column:1,size:e.size,border:""},{default:c((()=>[0!=i.ldData.length?(d(),u(fe,{key:0},{label:c((()=>[ne,m(" 负责停车场 ")])),default:c((()=>[(d(!0),r(g,null,_(i.ldData,((e,l)=>(d(),u(he,{size:"small",class:"mar5 mb5",key:l},{default:c((()=>[m(h(e.road_name),1)])),_:2},1024)))),128))])),_:1})):b("",!0),0==i.ldData.length?(d(),u(fe,{key:1},{label:c((()=>[de,m(" 负责停车场 ")])),default:c((()=>[p(he,{size:"small"},{default:c((()=>[m("无")])),_:1})])),_:1})):b("",!0),p(fe,null,{label:c((()=>[re,m(" 负责总泊位数 ")])),default:c((()=>[m(" "+h(i.xjData.berth_num),1)])),_:1})])),_:1},8,["size"])])),_:1},8,["modelValue"]),p(pe,{modelValue:i.dialogVisible,"onUpdate:modelValue":l[21]||(l[21]=e=>i.dialogVisible=e)},{default:c((()=>[o("div",oe,[o("img",{class:"imgWidth",src:i.dialogImageUrl,alt:""},null,8,se)])])),_:1},8,["modelValue"])])}]]);export{ue as default};
