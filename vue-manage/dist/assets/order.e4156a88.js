import{f as e,b as t,q as l,r as a,M as s,o as i,h as n,i as o,k as d,l as r,I as u,m as c,t as p,c as m,p as h,w as _,v as f,F as w,j as b,L as g,s as k,x as y}from"./vendor.ac52fd94.js";import{s as v,a as D}from"./store.8cdd8afe.js";import{_ as V,F as x}from"./index.1d57ac4a.js";import{g as C,r as S}from"./roadParkingOrder.721e77c8.js";const z={name:"order",components:{},data:()=>({isShow:!1,isShowInfo:!0,stopTime:!1,value1:"",carNum:"青A-20893"}),setup(){const a=e({address:"",name:"",checked:!1,pageIndex:1,pageSize:10}),s=t([]),i=t(0),n=()=>{v(a).then((e=>{console.log(e),s.value=e.data.list,i.value=e.data.total||0}))};n();const o=t(!1),d=t(!1),r=t({}),u=t(!1),c=t(!0);let p=e({id:"",car_id:"",order_no:"",car_type:"",road_name:"",berth:"",car_no:"",drivein_time:"",driveout_time:"",resitime:"",sum_amount:"",state_name:"",checked:!1,startTime:"",endTime:"",source_type:"",company_name:"",create_time:""});const m=t([]);x(e({dict_type:"car_type"})).then((e=>{m.value=e.data}));return{carType:m,query:a,tableData:s,pageTotal:i,editVisible:o,viewVisible:d,parkDetails:r,form:p,isShow:u,isShowInfo:c,handleSearch:()=>{a.pageIndex=1,n()},handlePageChange:e=>{a.pageIndex=e,n()},handleEdit:(t,l)=>{u.value=!1,c.value=!0,D(e({id:l.id})).then((e=>{e.data.is_discount=null==l.is_discount?1:0,r.value=e.data})),o.value=!0},handleView:(e,t)=>{g.confirm("将解除车牌现有绑定者，重新绑定到申诉用户，确定审核通过吗？","提示",{type:"warning"}).then((()=>{l.success("解除成功"),that.tableData.splice(indexI,1)})).catch((()=>{l.info("取消解除")}))},saveEdit:()=>{o.value=!1,l.success(`修改第 ${idx+1} 行成功`),Object.keys(p).forEach((e=>{s.value[idx][e]=p[e]}))},multipleSelection:[],dialogImageUrl:"",ppVisible:!1,isActive:!1,activeName:"first",url:"https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg",srcList:["https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg","https://fuss10.elemecdn.com/1/8e/aeffeb4de74e2fde4bd74fc7b4486jpeg.jpeg"]}},methods:{handleRemove(e,t){console.log(e,t)},handlePictureCardPreview(e){this.dialogImageUrl=e.url,this.ppVisible=!0},imgurl:function(e){if(""!=e&&null!=e)return e},carUpdDate(){this.isShow=!this.isShow,this.isShowInfo=!this.isShowInfo},changeisShowInfo(t){let a=this;this.isShow=!this.isShow,this.isShowInfo=!this.isShowInfo,1==t&&C(e({id:a.parkDetails.id,car_id:a.parkDetails.car_id,car_no:a.parkDetails.car_no,car_type:a.parkDetails.car_type})).then((e=>{0==e.code?(l.success(e.msg),a.editVisible=!1,a.getData()):l.error(e.msg)}))},bindRoad(){var e=this,t=this.selectedData;t?(t.forEach((function(t,l){e.tableData.forEach((function(e,t){}))})),this.viewVisible=!0,this.$refs.multipleTable.clearSelection()):l.warning("请选择一条记录")},changeisShow(){this.isShow=!this.isShow,this.isShowInfo=!this.isShowInfo},changeisShowInfo(){this.isShow=!this.isShow,this.isShowInfo=!this.isShowInfo},stopTimeShow(){this.stopTime=!this.stopTime},endTimeMethod(){let t=this,a=e({id:t.parkDetails.id,driveout_time:t.form.startTime});S(a).then((e=>{0==e.code?(l.success(e.msg),t.editVisible=!1,t.getData()):l.success(e.msg)}))},endTimeTK(){this.stopTime=!this.stopTime,this.surevb=!0}}},I=e=>(k("data-v-577f6c08"),e=e(),y(),e),T={class:"container"},N={class:"handle-box"},U={class:"left-panel"},j={key:0,size:"small"},q=["textContent"],E={class:"pagination"},P=I((()=>o("div",{class:"mt20"},null,-1))),K={class:"desctable mgb20 w"},L=I((()=>o("td",{class:"tit",width:"60"},"订单号",-1))),O=I((()=>o("td",{class:"tit",width:"80"},"订单状态",-1))),$=I((()=>o("td",{class:"tit",width:"60"},"停留时间",-1))),M=I((()=>o("td",{class:"tit",width:"80"},"费用",-1))),A=I((()=>o("td",{class:"tit",width:"60"},"停车地点",-1))),F={colspan:"3"},R=I((()=>o("td",{class:"tit",width:"60"},"车牌号码",-1))),B={colspan:"3"},G=I((()=>o("td",{class:"tit",width:"60"},"车牌类型",-1))),H=I((()=>o("td",{class:"tit",width:"80"},"车主手机号",-1))),J=I((()=>o("td",{class:"tit",width:"60"},"订单来源",-1))),Q={key:0},W={key:1},X=I((()=>o("td",{class:"tit",width:"80"},"创建时间",-1))),Y=I((()=>o("td",{class:"tit",width:"60"},"进场时间",-1))),Z=I((()=>o("td",{class:"tit",width:"80"},"离场时间",-1))),ee=I((()=>o("td",{class:"tit",width:"60"},"商家优惠",-1))),te=I((()=>o("td",{class:"tit",width:"80"},"商家电话",-1))),le=I((()=>o("td",{class:"tit",width:"60"},"实际扣款",-1))),ae=I((()=>o("td",{class:"tit",width:"80"},"扣款类型",-1))),se=I((()=>o("div",{class:"mt20"},null,-1))),ie={class:"desctable mgb20 w"},ne=I((()=>o("td",{class:"tit",width:"60"},"进场照片",-1))),oe={colspan:"3"},de=I((()=>o("td",{class:"tit",width:"60"},"出场照片",-1))),re={colspan:"3"},ue={class:"dialog-footer"};var ce=V(z,[["render",function(e,t,l,g,k,y){const v=a("el-input"),D=a("el-form-item"),V=a("el-checkbox"),x=a("el-option"),C=a("el-select"),S=a("el-button"),z=a("el-form"),I=a("el-table-column"),ce=a("el-tag"),pe=a("el-table"),me=a("el-pagination"),he=a("el-tab-pane"),_e=a("el-image"),fe=a("el-tabs"),we=a("el-date-picker"),be=a("el-dialog"),ge=s("permission");return i(),n("div",null,[o("div",T,[o("div",N,[o("div",U,[d(z,{inline:"","label-width":"80",size:"small"},{default:r((()=>[d(D,{label:"车牌号"},{default:r((()=>[d(v,{onKeyup:t[0]||(t[0]=u((e=>g.handleSearch()),["enter"])),size:"small",modelValue:g.query.carNo,"onUpdate:modelValue":t[1]||(t[1]=e=>g.query.carNo=e),placeholder:"车牌号"},null,8,["modelValue"])])),_:1}),d(D,{label:""},{default:r((()=>[d(V,{modelValue:g.form.checked,"onUpdate:modelValue":t[2]||(t[2]=e=>g.form.checked=e)},{default:r((()=>[c("黄牌")])),_:1},8,["modelValue"])])),_:1}),d(D,{label:"订单状态"},{default:r((()=>[d(C,{clearable:"",modelValue:g.query.status,"onUpdate:modelValue":t[3]||(t[3]=e=>g.query.status=e),filterable:"",size:"small"},{default:r((()=>[d(x,{key:"1",label:"在停 ",value:"1"}),d(x,{key:"2",label:"待缴费 ",value:"2"}),d(x,{key:"3",label:"已缴费 ",value:"3"}),d(x,{key:"4",label:"已完成 ",value:"4"})])),_:1},8,["modelValue"])])),_:1}),d(D,{label:"商家电话"},{default:r((()=>[d(v,{onKeyup:t[4]||(t[4]=u((e=>g.handleSearch()),["enter"])),size:"small",modelValue:g.query.business_phone,"onUpdate:modelValue":t[5]||(t[5]=e=>g.query.business_phone=e),placeholder:"手机号"},null,8,["modelValue"])])),_:1}),d(D,{label:""},{default:r((()=>[d(S,{size:"small",type:"primary",icon:"el-icon-search",onClick:g.handleSearch},{default:r((()=>[c("查询 ")])),_:1},8,["onClick"])])),_:1})])),_:1})])]),d(pe,{data:g.tableData,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:r((()=>[d(I,{pro:"ID",label:"序号",width:"55",align:"center"},{default:r((e=>[c(p(e.$index+1),1)])),_:1}),d(I,{prop:"orderNo",label:"订单号",align:"center",width:"190"}),d(I,{prop:"placeName",label:"路内",align:"center","min-width":"200"}),d(I,{prop:"carNo",label:"车牌号",align:"center",width:"110"},{default:r((e=>["1"==e.row.car_type?(i(),m(ce,{key:0,size:"small",textContent:p(e.row.carNo)},null,8,["textContent"])):"2"==e.row.car_type?(i(),m(ce,{key:1,size:"small",type:"success",textContent:p(e.row.carNo)},null,8,["textContent"])):"3"==e.row.car_type?(i(),m(ce,{key:2,size:"small",type:"warning",textContent:p(e.row.carNo)},null,8,["textContent"])):h("",!0)])),_:1}),d(I,{prop:"phone",label:"手机号",align:"center",width:"120"}),d(I,{prop:"driveinTime",label:"停入时间",align:"center",width:"170"}),d(I,{prop:"driveoutTime",label:"离场时间",align:"center",width:"170"}),d(I,{prop:"resitime",label:"停留时间",align:"center",width:"150"}),d(I,{prop:"status_name",label:"状态",align:"center",width:"100"},{default:r((e=>["1"==e.row.status?(i(),m(ce,{key:0,size:"small",textContent:p(e.row.status_name)},null,8,["textContent"])):"2"==e.row.status?(i(),m(ce,{key:1,size:"small",type:"success",textContent:p(e.row.status_name)},null,8,["textContent"])):"3"==e.row.status?(i(),m(ce,{key:2,size:"small",type:"warning",textContent:p(e.row.status_name)},null,8,["textContent"])):"4"==e.row.status?(i(),m(ce,{key:3,size:"small",type:"danger",textContent:p(e.row.status_name)},null,8,["textContent"])):h("",!0)])),_:1}),d(I,{prop:"sum_amount",label:"停车费用",align:"center",width:"100"}),d(I,{prop:"business_amount",label:"商家扣款",align:"center",width:"100"},{default:r((e=>["0"!=e.row.is_discount?(i(),n("span",j,"0")):h("",!0),"0"==e.row.is_discount?(i(),n("span",{key:1,size:"small",textContent:p(e.row.business_amount)},null,8,q)):h("",!0)])),_:1}),d(I,{label:"商家优惠",align:"center",width:"100"},{default:r((e=>["0"==e.row.is_discount?(i(),m(ce,{key:0,size:"small",type:"success"},{default:r((()=>[c("是")])),_:1})):h("",!0),"0"!=e.row.is_discount?(i(),m(ce,{key:1,size:"small",type:"warning"},{default:r((()=>[c("否")])),_:1})):h("",!0)])),_:1}),d(I,{prop:"business_phone",label:"商家电话",align:"center",width:"120"}),d(I,{label:"操作",width:"100",align:"center",fixed:"right"},{default:r((e=>[_((i(),m(S,{size:"mini",type:"text",icon:"el-icon-view",onClick:t=>g.handleEdit(e.$index,e.row)},{default:r((()=>[c("详情 ")])),_:2},1032,["onClick"])),[[ge,["road_businessOrder_details","park_businessOrder_details"]]])])),_:1})])),_:1},8,["data"]),o("div",E,[d(me,{background:"",layout:"total, prev, pager, next","current-page":g.query.pageIndex,"page-size":g.query.pageSize,total:g.pageTotal,onCurrentChange:g.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),d(be,{title:"查看详情",modelValue:g.editVisible,"onUpdate:modelValue":t[13]||(t[13]=e=>g.editVisible=e),width:"40%"},{footer:r((()=>[o("span",ue,[d(S,{onClick:t[12]||(t[12]=e=>g.editVisible=!1)},{default:r((()=>[c("取 消")])),_:1}),_(d(S,{type:"primary",onClick:y.endTimeMethod},{default:r((()=>[c("确 定")])),_:1},8,["onClick"]),[[f,e.surevb]]),null!=g.form.driveout_time&&null!=g.form.driveout_time&&""!=g.form.driveout_time||1!=g.parkDetails.status?h("",!0):_((i(),m(S,{key:0,type:"danger",onClick:y.endTimeTK},{default:r((()=>[c("结束计时")])),_:1},8,["onClick"])),[[f,!e.surevb]])])])),default:r((()=>[d(fe,{type:"card",modelValue:g.activeName,"onUpdate:modelValue":t[10]||(t[10]=e=>g.activeName=e)},{default:r((()=>[d(he,{label:"基本信息",name:"first"},{default:r((()=>[P,o("table",K,[o("tr",null,[L,o("td",null,p(g.parkDetails.order_no),1),O,o("td",null,[d(ce,{type:"success"},{default:r((()=>[c(p(g.parkDetails.statusName),1)])),_:1})])]),o("tr",null,[$,o("td",null,p(g.parkDetails.resitime),1),M,o("td",null,[d(ce,{type:"danger"},{default:r((()=>[c(p(g.parkDetails.sum_amount?g.parkDetails.sum_amount:"0"),1)])),_:1})])]),o("tr",null,[A,o("td",F,p(g.parkDetails.road_name),1)]),o("tr",null,[R,o("td",B,[_(o("div",null,[o("span",null,p(g.parkDetails.car_no),1),d(S,{size:"small",class:"ml5",type:"primary",icon:"el-icon-edit",onClick:y.carUpdDate},{default:r((()=>[c("修改车牌号码")])),_:1},8,["onClick"])],512),[[f,g.isShowInfo]]),_(o("div",null,[d(v,{modelValue:g.parkDetails.car_no,"onUpdate:modelValue":t[6]||(t[6]=e=>g.parkDetails.car_no=e),class:"w100",size:"small"},null,8,["modelValue"]),d(C,{modelValue:g.parkDetails.car_type,"onUpdate:modelValue":t[7]||(t[7]=e=>g.parkDetails.car_type=e),filterable:"",size:"small",placeholder:"车牌分类",class:"w100 ml5"},{default:r((()=>[(i(!0),n(w,null,b(g.carType,(e=>(i(),m(x,{key:e.dc_value,label:e.label,value:e.dc_value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),d(S,{size:"small",class:"ml5",type:"primary",icon:"el-icon-check",onClick:t[8]||(t[8]=e=>y.changeisShowInfo(1))},{default:r((()=>[c("确定 ")])),_:1}),d(S,{size:"small",icon:"el-icon-close",onClick:t[9]||(t[9]=e=>y.changeisShowInfo(2))},{default:r((()=>[c("取消")])),_:1})],512),[[f,g.isShow]])])]),o("tr",null,[G,o("td",null,p(g.parkDetails.carType),1),H,o("td",null,p(g.parkDetails.phone),1)]),o("tr",null,[J,"1"==g.parkDetails.source?(i(),n("td",Q,"视频采集")):(i(),n("td",W,"人工")),X,o("td",null,p(g.parkDetails.create_time),1)]),o("tr",null,[Y,o("td",null,p(g.parkDetails.drivein_time),1),Z,o("td",null,p(g.parkDetails.driveout_time),1)]),o("tr",null,[ee,o("td",null,[d(ce,null,{default:r((()=>[c(p(0==g.parkDetails.is_discount?"是":"否"),1)])),_:1})]),te,o("td",null,p(g.parkDetails.business_phone),1)]),o("tr",null,[le,o("td",null,[d(ce,{type:"danger"},{default:r((()=>[c(p(0==g.parkDetails.is_discount?g.parkDetails.business_amount:0),1)])),_:1})]),ae,o("td",null,[d(ce,{type:"success"},{default:r((()=>[c("钱包余额")])),_:1})])])])])),_:1}),d(he,{label:"进出场信息",name:"second"},{default:r((()=>[se,o("table",ie,[o("tr",null,[ne,o("td",oe,[(i(!0),n(w,null,b(g.parkDetails.scList,((e,t)=>(i(),m(_e,{key:t,"hide-on-click-modal":"true","preview-teleported":"true",style:{width:"100px",height:"100px"},src:y.imgurl(e.file_url),class:"ml5","preview-src-list":[y.imgurl(e.file_url)]},null,8,["src","preview-src-list"])))),128))])]),o("tr",null,[de,o("td",re,[(i(!0),n(w,null,b(g.parkDetails.slList,((e,t)=>(i(),m(_e,{key:t,"hide-on-click-modal":"true","preview-teleported":"true",style:{width:"100px",height:"100px"},src:y.imgurl(e.file_url),class:"ml5","preview-src-list":[y.imgurl(e.file_url)]},null,8,["src","preview-src-list"])))),128))])])])])),_:1})])),_:1},8,["modelValue"]),_(d(z,null,{default:r((()=>[d(D,{label:"结束计时时间"},{default:r((()=>[d(we,{modelValue:k.value1,"onUpdate:modelValue":t[11]||(t[11]=e=>k.value1=e),type:"datetime",placeholder:"选择日期时间"},null,8,["modelValue"])])),_:1})])),_:1},512),[[f,k.stopTime]])])),_:1},8,["modelValue"])])}],["__scopeId","data-v-577f6c08"]]);export{ce as default};
