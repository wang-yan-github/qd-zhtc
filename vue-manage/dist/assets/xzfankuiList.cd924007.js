import{f as e,b as a,q as t,r as l,M as i,o as d,h as s,i as n,k as r,l as o,I as c,m as u,t as p,c as m,w as h,p as f,F as g,j as b,L as _}from"./vendor.ac52fd94.js";import{_ as w,a5 as k,a6 as y,U as V}from"./index.1d57ac4a.js";import{d as v,e as x,f as C,g as D}from"./inspectManage.eb50b138.js";const I={name:"inspectFeedback",components:{},data:()=>({formRules:{feedback:[{required:!0,message:"必填项",trigger:"blur"}]}}),setup(){const l=e({name:"",start:"",road_id:"",area_id:"",street_id:"",pageIndex:1,pageSize:10}),i=e({area_list:[],street_list:[],road_list:[]}),d=a([]),s=a(0),n=()=>{x(l).then((e=>{d.value=e.data.list,s.value=e.data.total}))};n();k(l).then((e=>{i.area_list=e.data}));let r=e({areaId:l.area_id});const o=e({streetId:l.street_id}),c=a(!1),u=a(!1);a(!1);const p=a({id:"",feedback:""}),m=a({pic_id:""});return{query:l,tableData:d,pageTotal:s,editVisible:c,viewVisible:u,form:p,detailData:m,result:i,getStreetList:e=>{r.areaId=l.area_id,i.road_list=[],l.road_id="",l.street_id="",y(r).then((e=>{i.street_list=e.data}))},getRoadList:()=>{o.streetId=l.street_id,l.road_id="",V(o).then((e=>{i.road_list=e.data}))},getData:n,handleSearch:()=>{l.pageIndex=1,n()},handlePageChange:e=>{l.pageIndex=e,n()},handleDelete:(a,i)=>{let d=0;_.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{C(e({id:i.id})).then((e=>{d=e.code})).then((()=>{0==d?(t.success("操作成功！"),c.value=!1,l.pageIndex=1,n()):t.success("操作失败！")}))})).catch((()=>{}))},handleEdit:(e,a,t)=>{p.value={id:a.id},c.value=!0},handleView:(a,t)=>{D(e({id:t.id})).then((e=>{m.value=e.data,u.value=!0}))},multipleSelection:[],ppVisible:!1,url:"https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg",srcList:["https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg"]}},methods:{handleRemove(e,a){console.log(e,a)},handlePictureCardPreview(e){this.dialogImageUrl=e.url,this.ppVisible=!0},handleSelectionChange(e){this.selectedData=e},handleCommand(e){this.$message("click on item "+e)},saveEdit(e){let a=0,l=this;this.$refs[e].validate((e=>{e&&v(l.form).then((e=>{a=e.code})).then((()=>{0==a?(t.success("操作成功"),l.editVisible=!1,l.query.pageIndex=1,l.getData()):-1==a&&t.error("操作失败!")}))}))},imgurl:function(e){if(""!=e&&null!=e)return e}}},j={class:"container"},S={class:"handle-box"},z={class:"right-panel"},q=n("span",{class:"dispinline ml5"},null,-1),U=n("span",{class:"dispinline ml5"},null,-1),$=n("div",{class:"clear"},null,-1),L={class:"pagination"},E={class:"dialog-footer"},P=["src"],R={class:"desctable mgb20 w"},T=n("td",{class:"tit",width:"60"},"姓名",-1),F=n("td",{class:"tit",width:"80"},"时间",-1),M=n("td",{class:"tit",width:"60"},"工号",-1),K=n("td",{class:"tit",width:"80"},"联系电话",-1),A=n("td",{class:"tit",width:"60"},"反馈时间",-1),B=n("td",{class:"tit",width:"60"},"反馈类型",-1),G=n("td",{class:"tit",width:"60"},"内容",-1),H={colspan:"3"},J={key:0},N=n("td",{class:"tit",width:"60"},"反馈内容",-1),O={colspan:"3"},Q=n("td",{class:"tit",width:"60"},"照片",-1),W={colspan:"3"};var X=w(I,[["render",function(e,a,t,_,w,k){const y=l("el-input"),V=l("el-button"),v=l("el-form"),x=l("el-table-column"),C=l("el-tab"),D=l("el-table"),I=l("el-pagination"),X=l("el-form-item"),Y=l("el-dialog"),Z=l("el-tag"),ee=l("el-image"),ae=i("permission");return d(),s("div",null,[n("div",j,[n("div",S,[n("div",z,[r(v,{inline:"",size:"small"},{default:o((()=>[r(y,{size:"small",modelValue:_.query.keyword,"onUpdate:modelValue":a[0]||(a[0]=e=>_.query.keyword=e),onKeyup:a[1]||(a[1]=c((e=>_.handleSearch()),["enter"])),placeholder:"请输入姓名/工号",class:"handle-input mr10"},null,8,["modelValue"]),q,U,r(V,{size:"small",type:"primary",icon:"el-icon-search",onClick:_.handleSearch},{default:o((()=>[u("查询")])),_:1},8,["onClick"])])),_:1})]),$]),r(D,{data:_.tableData,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header",onSelectionChange:k.handleSelectionChange},{default:o((()=>[r(x,{pro:"ID",label:"ID",width:"55",align:"center"},{default:o((e=>[u(p((_.query.pageIndex-1)*_.query.pageSize+e.$index+1),1)])),_:1}),r(x,{prop:"content",label:"内容"}),r(x,{prop:"name",label:"姓名",width:"180",align:"center"}),r(x,{prop:"create_time",label:"时间",width:"200",align:"center"}),r(x,{label:"状态",align:"center",width:"100"},{default:o((e=>[1==e.row.fkstate?(d(),m(C,{key:0},{default:o((()=>[u("已反馈")])),_:1})):(d(),m(C,{key:1},{default:o((()=>[u("未反馈")])),_:1}))])),_:1}),r(x,{label:"操作",width:"220",align:"center"},{default:o((e=>[0==e.row.fkstate?h((d(),m(V,{key:0,size:"mini",type:"text",icon:"el-icon-edit",onClick:a=>_.handleEdit(e.$index,e.row,!1)},{default:o((()=>[u("反馈 ")])),_:2},1032,["onClick"])),[[ae,"road_onsitefeedbackxj_fk"]]):f("",!0),h((d(),m(V,{size:"mini",type:"text",icon:"el-icon-view",onClick:a=>_.handleView(e.$index,e.row)},{default:o((()=>[u("查看 ")])),_:2},1032,["onClick"])),[[ae,"road_onsitefeedbackxj_details"]]),h((d(),m(V,{size:"mini",type:"text",icon:"el-icon-delete",class:"red",onClick:a=>_.handleDelete(e.$index,e.row)},{default:o((()=>[u("删除")])),_:2},1032,["onClick"])),[[ae,"road_onsitefeedbackxj_delete"]])])),_:1})])),_:1},8,["data","onSelectionChange"]),n("div",L,[r(I,{background:"",layout:"total, prev, pager, next","current-page":_.query.pageIndex,"page-size":_.query.pageSize,total:_.pageTotal,onCurrentChange:_.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),r(Y,{title:"上报反馈",modelValue:_.editVisible,"onUpdate:modelValue":a[5]||(a[5]=e=>_.editVisible=e),width:"35%"},{footer:o((()=>[n("span",E,[r(V,{onClick:a[3]||(a[3]=e=>_.editVisible=!1)},{default:o((()=>[u("取 消")])),_:1}),r(V,{type:"primary",onClick:a[4]||(a[4]=e=>k.saveEdit("formId"))},{default:o((()=>[u("确 定")])),_:1})])])),default:o((()=>[r(v,{"label-width":"80px",rules:w.formRules,ref:"formId",model:_.form},{default:o((()=>[r(X,{label:"反馈内容",prop:"feedback"},{default:o((()=>[r(y,{modelValue:_.form.feedback,"onUpdate:modelValue":a[2]||(a[2]=e=>_.form.feedback=e),type:"textarea",rows:8,placeholder:"请输入反馈内容"},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue"]),r(Y,{modelValue:_.ppVisible,"onUpdate:modelValue":a[6]||(a[6]=e=>_.ppVisible=e)},{default:o((()=>[n("img",{width:"100%",src:e.dialogImageUrl,alt:""},null,8,P)])),_:1},8,["modelValue"]),r(Y,{title:"反馈详情",modelValue:_.viewVisible,"onUpdate:modelValue":a[7]||(a[7]=e=>_.viewVisible=e),width:"40%"},{default:o((()=>[n("table",R,[n("tr",null,[T,n("td",null,p(_.detailData.name),1),F,n("td",null,[r(Z,{type:"success"},{default:o((()=>[u(p(_.detailData.create_time),1)])),_:1})])]),n("tr",null,[M,n("td",null,p(_.detailData.job_no),1),K,n("td",null,p(_.detailData.phone?_.detailData.phone:"无"),1)]),n("tr",null,[A,n("td",null,p(_.detailData.feedback_time),1),B,n("td",null,p(_.detailData.feedback_type),1)]),n("tr",null,[G,n("td",H,p(_.detailData.content),1)]),1==_.detailData.fkstate?(d(),s("tr",J,[N,n("td",O,p(_.detailData.feedback),1)])):f("",!0),n("tr",null,[Q,n("td",W,[(d(!0),s(g,null,b(_.detailData.fileList,((e,a)=>(d(),m(ee,{key:a,style:{width:"100px",height:"100px"},"hide-on-click-modal":"true","preview-teleported":"true",src:k.imgurl(e.file_url),class:"ml5","preview-src-list":[k.imgurl(e.file_url)]},null,8,["src","preview-src-list"])))),128))])])])])),_:1},8,["modelValue"])])}]]);export{X as default};
