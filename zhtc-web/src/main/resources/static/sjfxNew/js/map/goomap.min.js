var $jscomp={scope:{},checkStringArgs:function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""}};
$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,c,d){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==d||d>b)d=b;d=Number(d);0>d&&(d=Math.max(0,b+d));for(c=Number(c||0);c<d;c++)this[c]=a;return this}},"es6-impl","es3");$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var g=a[e];if(b.call(c,g,e,a))return{i:e,v:g}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.findIndex",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).i}},"es6-impl","es3");$jscomp.polyfill("String.prototype.repeat",function(a){return a?a:function(a){var b=$jscomp.checkStringArgs(this,null,"repeat");if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var d="";a;)if(a&1&&(d+=b),a>>>=1)b+=b;return d}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");$jscomp.polyfill("Array.from",function(a){return a?a:function(a,c,d){$jscomp.initSymbolIterator();c=null!=c?c:function(a){return a};var b=[],g=a[Symbol.iterator];if("function"==typeof g)for(a=g.call(a);!(g=a.next()).done;)b.push(c.call(d,g.value));else for(var g=a.length,h=0;h<g;h++)b.push(c.call(d,a[h]));return b}},"es6-impl","es3");
(function(a,b){"object"===typeof exports&&"undefined"!==typeof module?b(exports):"function"===typeof define&&define.amd?define(["exports"],b):b(a.G={})})(this,function(a){function b(f){var a,b,c,d;b=1;for(c=arguments.length;b<c;b++)for(a in d=arguments[b],d)f[a]=d[a];return f}function c(f,a){var b=Array.prototype.slice;if(f.bind)return f.bind.apply(f,b.call(arguments,1));var n=b.call(arguments,2);return function(){return f.apply(a,n.length?n.concat(b.call(arguments)):arguments)}}function d(f){f._goomap_id=
f._goomap_id||++oc;return f._goomap_id}function e(f,a,b){var n,c,d,t;t=function(){n=!1;c&&(d.apply(b,c),c=!1)};return d=function(){n?c=arguments:(f.apply(b,arguments),setTimeout(t,a),n=!0)}}function g(f,a,b){var n=a[1];a=a[0];var c=n-a;return f===n&&b?f:((f-a)%c+c)%c+a}function h(){return!1}function k(f,a){var b=Math.pow(10,a||5);return Math.round(f*b)/b}function m(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")}function l(f){return m(f).split(/\s+/)}function p(f,a){f.hasOwnProperty("options")||
(f.options=f.options?bb(f.options):{});for(var b in a)f.options[b]=a[b];return f.options}function q(f,a,b){var n=[],c;for(c in f)n.push(encodeURIComponent(b?c.toUpperCase():c)+"="+encodeURIComponent(f[c]));return(a&&-1!==a.indexOf("?")?"&":"?")+n.join("&")}function r(f,a){return f.replace(gd,function(f,b){var n=a[b];if(void 0===n)throw Error("No value provided for variable "+f);"function"===typeof n&&(n=n(a));return n})}function u(f,a){for(var b=0;b<f.length;b++)if(f[b]===a)return b;return-1}function D(f){return window["webkit"+
f]||window["moz"+f]||window["ms"+f]}function ea(f){var a=+new Date,b=Math.max(0,16-(a-pc));pc=a+b;return window.setTimeout(f,b)}function I(f,a,b){if(b&&vb===ea)f.call(a);else return vb.call(window,c(f,a))}function P(f){f&&qc.call(window,f)}function W(){}function M(f){if(G&&G.Mixin){f=aa(f)?f:[f];for(var a=0;a<f.length;a++)f[a]===G.Mixin.Events&&console.warn("Deprecated include of G.Mixin.Events: this property will be removed in future releases, please inherit from G.Evented instead.",Error().stack)}}
function v(f,a,b){this.x=b?Math.round(f):f;this.y=b?Math.round(a):a}function w(f,a,b){return f instanceof v?f:aa(f)?new v(f[0],f[1]):void 0===f||null===f?f:"object"===typeof f&&"x"in f&&"y"in f?new v(f.x,f.y):new v(f,a,b)}function C(f,a){if(f)for(var b=a?[f,a]:f,n=0,c=b.length;n<c;n++)this.extend(b[n])}function O(f,a){return!f||f instanceof C?f:new C(f,a)}function H(f,a){if(f)for(var b=a?[f,a]:f,n=0,c=b.length;n<c;n++)this.extend(b[n])}function E(f,a){return f instanceof H?f:new H(f,a)}function y(f,
a,b){if(isNaN(f)||isNaN(a))throw Error("Invalid LatLng object: ("+f+", "+a+")");this.lat=+f;this.lng=+a;void 0!==b&&(this.alt=+b)}function F(f,a,b){return f instanceof y?f:aa(f)&&"object"!==typeof f[0]?3===f.length?new y(f[0],f[1],f[2]):2===f.length?new y(f[0],f[1]):null:void 0===f||null===f?f:"object"===typeof f&&"lat"in f?new y(f.lat,"lng"in f?f.lng:f.lon,f.alt):void 0===a?null:new y(f,a,b)}function wa(f,a,b,c){aa(f)?(this._a=f[0],this._b=f[1],this._c=f[2],this._d=f[3]):(this._a=f,this._b=a,this._c=
b,this._d=c)}function la(f,a,b,c){return new wa(f,a,b,c)}function La(f){return document.createElementNS("http://www.w3.org/2000/svg",f)}function xa(f,a){var b="",n,c,d,e,g,h;n=0;for(d=f.length;n<d;n++){g=f[n];c=0;for(e=g.length;c<e;c++)h=g[c],b+=(c?"L":"M")+h.x+" "+h.y;b+=a?cb?"z":"x":""}return b||"M0 0"}function Q(f){return 0<=navigator.userAgent.toLowerCase().indexOf(f)}function db(f,a,b,c){"touchstart"===a?hd(f,b,c):"touchmove"===a?id(f,b,c):"touchend"===a&&jd(f,b,c);return this}function Ma(f,
a,b){b=f["_goomap_"+a+b];"touchstart"===a?f.removeEventListener(wb,b,!1):"touchmove"===a?f.removeEventListener(xb,b,!1):"touchend"===a&&(f.removeEventListener(yb,b,!1),f.removeEventListener(zb,b,!1));return this}function hd(f,a,b){var n=c(function(f){if("mouse"!==f.pointerType&&f.pointerType!==f.MSPOINTER_TYPE_MOUSE&&f.pointerType!==f.MSPOINTER_TYPE_MOUSE)if(0>kd.indexOf(f.target.tagName))S(f);else return;Ab(f,a)});f["_goomap_touchstart"+b]=n;f.addEventListener(wb,n,!1);rc||(document.documentElement.addEventListener(wb,
ld,!0),document.documentElement.addEventListener(xb,md,!0),document.documentElement.addEventListener(yb,sc,!0),document.documentElement.addEventListener(zb,sc,!0),rc=!0)}function ld(f){ya[f.pointerId]=f;Bb++}function md(f){ya[f.pointerId]&&(ya[f.pointerId]=f)}function sc(f){delete ya[f.pointerId];Bb--}function Ab(f,a){f.touches=[];for(var b in ya)f.touches.push(ya[b]);f.changedTouches=[f];a(f)}function id(f,a,b){var n=function(f){(f.pointerType!==f.MSPOINTER_TYPE_MOUSE&&"mouse"!==f.pointerType||0!==
f.buttons)&&Ab(f,a)};f["_goomap_touchmove"+b]=n;f.addEventListener(xb,n,!1)}function jd(f,a,b){var n=function(f){Ab(f,a)};f["_goomap_touchend"+b]=n;f.addEventListener(yb,n,!1);f.addEventListener(zb,n,!1)}function tc(f,a,b){function n(f){var a;if(ba){if(!Na||"mouse"===f.pointerType)return;a=Bb}else a=f.touches.length;if(!(1<a)){a=Date.now();var b=a-(d||a);t=f.touches?f.touches[0]:f;e=0<b&&250>=b;d=a}}function c(f){if(e&&!t.cancelBubble){if(ba){if(!Na||"mouse"===f.pointerType)return;f={};var b,n;for(n in t)b=
t[n],f[n]=b&&b.bind?b.bind(t):b;t=f}t.type="dblclick";a(t);d=null}}var d,t,e=!1;f["_goomap_"+eb+b]=n;f["_goomap_"+fb+b]=c;f["_goomap_dblclick"+b]=a;f.addEventListener(eb,n,!1);f.addEventListener(fb,c,!1);f.addEventListener("dblclick",a,!1);return this}function uc(f,a){var b=f["_goomap_"+fb+a],n=f["_goomap_dblclick"+a];f.removeEventListener(eb,f["_goomap_"+eb+a],!1);f.removeEventListener(fb,b,!1);Na||f.removeEventListener("dblclick",n,!1);return this}function x(f,a,b,c){if("object"===typeof a)for(var n in a)gb(f,
n,a[n],b);else{a=l(a);n=0;for(var d=a.length;n<d;n++)gb(f,a[n],b,c)}return this}function L(f,a,b,c){if("object"===typeof a)for(var n in a)Cb(f,n,a[n],b);else if(a){a=l(a);n=0;for(var d=a.length;n<d;n++)Cb(f,a[n],b,c)}else{for(d in f[X])Cb(f,d,f[X][d]);delete f[X]}return this}function gb(f,a,b,c){var n=a+d(b)+(c?"_"+d(c):"");if(f[X]&&f[X][n])return this;var t=function(a){return b.call(c||f,a||window.event)},e=t;ba&&0===a.indexOf("touch")?db(f,a,t,n):!Y||"dblclick"!==a||!tc||ba&&hb?"addEventListener"in
f?"mousewheel"===a?f.addEventListener("onwheel"in f?"wheel":"mousewheel",t,!1):"mouseenter"===a||"mouseleave"===a?(t=function(a){a=a||window.event;ib(f,a)&&e(a)},f.addEventListener("mouseenter"===a?"mouseover":"mouseout",t,!1)):("click"===a&&Oa&&(t=function(a){var f=a.timeStamp||a.originalEvent&&a.originalEvent.timeStamp,b=Db&&f-Db;b&&100<b&&500>b||a.target._simulatedClick&&!a._simulated?ca(a):(Db=f,e(a))}),f.addEventListener(a,t,!1)):"attachEvent"in f&&f.attachEvent("on"+a,t):tc(f,t,n);f[X]=f[X]||
{};f[X][n]=t}function Cb(a,b,c,e){c=b+d(c)+(e?"_"+d(e):"");e=a[X]&&a[X][c];if(!e)return this;ba&&0===b.indexOf("touch")?Ma(a,b,c):Y&&"dblclick"===b&&uc?uc(a,c):"removeEventListener"in a?"mousewheel"===b?a.removeEventListener("onwheel"in a?"wheel":"mousewheel",e,!1):a.removeEventListener("mouseenter"===b?"mouseover":"mouseleave"===b?"mouseout":b,e,!1):"detachEvent"in a&&a.detachEvent("on"+b,e);a[X][c]=null}function qa(a){a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=
!0:a.cancelBubble=!0;Eb(a);return this}function Fb(a){gb(a,"mousewheel",qa);return this}function Pa(a){x(a,"mousedown touchstart dblclick",qa);gb(a,"click",Gb);return this}function S(a){a.preventDefault?a.preventDefault():a.returnValue=!1;return this}function ca(a){S(a);qa(a);return this}function vc(a,b){if(!b)return new v(a.clientX,a.clientY);var f=b.getBoundingClientRect();return new v(a.clientX-f.left-b.clientLeft,a.clientY-f.top-b.clientTop)}function wc(a){return Na?a.wheelDeltaY/2:a.deltaY&&
0===a.deltaMode?-a.deltaY/nd:a.deltaY&&1===a.deltaMode?20*-a.deltaY:a.deltaY&&2===a.deltaMode?60*-a.deltaY:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&32765>Math.abs(a.detail)?20*-a.detail:a.detail?a.detail/-32765*60:0}function Gb(a){Hb[a.type]=!0}function Eb(a){var f=Hb[a.type];Hb[a.type]=!1;return f}function ib(a,b){var f=b.relatedTarget;if(!f)return!0;try{for(;f&&f!==a;)f=f.parentNode}catch(Ed){return!1}return f!==a}function xc(a){return"string"===typeof a?document.getElementById(a):
a}function Qa(a,b){var f=a.style[b]||a.currentStyle&&a.currentStyle[b];f&&"auto"!==f||!document.defaultView||(f=(f=document.defaultView.getComputedStyle(a,null))?f[b]:null);return"auto"===f?null:f}function A(a,b,c){a=document.createElement(a);a.className=b||"";c&&c.appendChild(a);return a}function J(a){var f=a.parentNode;f&&f.removeChild(a)}function Ib(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function za(a){var f=a.parentNode;f.lastChild!==a&&f.appendChild(a)}function Aa(a){var f=a.parentNode;
f.firstChild!==a&&f.insertBefore(a,f.firstChild)}function Jb(a,b){if(void 0!==a.classList)return a.classList.contains(b);var f=jb(a);return 0<f.length&&(new RegExp("(^|\\s)"+b+"(\\s|$)")).test(f)}function B(a,b){if(void 0!==a.classList)for(var f=l(b),c=0,n=f.length;c<n;c++)a.classList.add(f[c]);else Jb(a,b)||(f=jb(a),Kb(a,(f?f+" ":"")+b))}function K(a,b){void 0!==a.classList?a.classList.remove(b):Kb(a,m((" "+jb(a)+" ").replace(" "+b+" "," ")))}function Kb(a,b){void 0===a.className.baseVal?a.className=
b:a.className.baseVal=b}function jb(a){return void 0===a.className.baseVal?a.className:a.className.baseVal}function T(a,b){if("opacity"in a.style)a.style.opacity=b;else if("filter"in a.style)a:{var f=b,c=!1;try{c=a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(Fd){if(1===f)break a}f=Math.round(100*f);c?(c.Enabled=100!==f,c.Opacity=f):a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity="+f+")"}}function kb(a){for(var f=document.documentElement.style,b=0;b<a.length;b++)if(a[b]in
f)return a[b];return!1}function ra(a,b,c){b=b||new v(0,0);a.style[Lb]=(Mb?"translate("+b.x+"px,"+b.y+"px)":"translate3d("+b.x+"px,"+b.y+"px,0)")+(c?" scale("+c+")":"")}function N(a,b){a._goomap_pos=b;U?ra(a,b):(a.style.left=b.x+"px",a.style.top=b.y+"px")}function sa(a){return a._goomap_pos||new v(0,0)}function Nb(){x(window,"dragstart",S)}function Ob(){L(window,"dragstart",S)}function Pb(a){for(;-1===a.tabIndex;)a=a.parentNode;a.style&&(lb(),mb=a,Qb=a.style.outline,a.style.outline="none",x(window,
"keydown",lb))}function lb(){mb&&(mb.style.outline=Qb,Qb=mb=void 0,L(window,"keydown",lb))}function yc(a,b){if(!b||!a.length)return a.slice();for(var f=b*b,c=a,n=[c[0]],d=1,e=0,g=c.length;d<g;d++){var h=c[d],k=c[e],l=k.x-h.x,h=k.y-h.y;l*l+h*h>f&&(n.push(c[d]),e=d)}e<g-1&&n.push(c[g-1]);c=n;n=c.length;d=new ("undefined"!==typeof Uint8Array?Uint8Array:Array)(n);d[0]=d[n-1]=1;Rb(c,d,f,0,n-1);e=[];for(f=0;f<n;f++)d[f]&&e.push(c[f]);return e}function zc(a,b,c){return Math.sqrt(Ra(a,b,c,!0))}function Rb(a,
b,c,d,e){var f=0,n,t,g;for(t=d+1;t<=e-1;t++)g=Ra(a[t],a[d],a[e],!0),g>f&&(n=t,f=g);f>c&&(b[n]=1,Rb(a,b,c,d,n),Rb(a,b,c,n,e))}function Ac(a,b,c,d,e){d=d?Bc:ta(a,c);var f=ta(b,c),n,t,g;for(Bc=f;;){if(!(d|f))return[a,b];if(d&f)return!1;n=d||f;t=nb(a,b,n,c,e);g=ta(t,c);n===d?(a=t,d=g):(b=t,f=g)}}function nb(a,b,c,d,e){var f=b.x-a.x;b=b.y-a.y;var n=d.min;d=d.max;var t,g;c&8?(t=a.x+f*(d.y-a.y)/b,g=d.y):c&4?(t=a.x+f*(n.y-a.y)/b,g=n.y):c&2?(t=d.x,g=a.y+b*(d.x-a.x)/f):c&1&&(t=n.x,g=a.y+b*(n.x-a.x)/f);return new v(t,
g,e)}function ta(a,b){var f=0;a.x<b.min.x?f|=1:a.x>b.max.x&&(f|=2);a.y<b.min.y?f|=4:a.y>b.max.y&&(f|=8);return f}function Ra(a,b,c,d){var f=b.x;b=b.y;var n=c.x-f,e=c.y-b,t=n*n+e*e;0<t&&(t=((a.x-f)*n+(a.y-b)*e)/t,1<t?(f=c.x,b=c.y):0<t&&(f+=n*t,b+=e*t));n=a.x-f;e=a.y-b;return d?n*n+e*e:new v(f,b)}function fa(a){return!aa(a[0])||"object"!==typeof a[0][0]&&"undefined"!==typeof a[0][0]}function Cc(a){console.warn("Deprecated use of _flat, please use G.LineUtil.isFlat instead.");return fa(a)}function Dc(a,
b,c){var f,n=[1,4,2,8],d,e,t,g,h,k;d=0;for(h=a.length;d<h;d++)a[d]._code=ta(a[d],b);for(t=0;4>t;t++){k=n[t];f=[];d=0;h=a.length;for(e=h-1;d<h;e=d++)(g=a[d],e=a[e],g._code&k)?e._code&k||(e=nb(e,g,k,b,c),e._code=ta(e,b),f.push(e)):(e._code&k&&(e=nb(e,g,k,b,c),e._code=ta(e,b),f.push(e)),f.push(g));a=f}return a}function Sb(a,b){var f="Feature"===a.type?a.geometry:a,c=f?f.coordinates:null,n=[],d=b&&b.pointToLayer,e=b&&b.coordsToLatLng||Tb,g,h;if(!c&&!f)return null;switch(f.type){case "Point":return f=
e(c),d?d(a,f):new Sa(f);case "MultiPoint":g=0;for(h=c.length;g<h;g++)f=e(c[g]),n.push(d?d(a,f):new Sa(f));return new ua(n);case "LineString":case "MultiLineString":return n=ob(c,"LineString"===f.type?0:1,e),new ga(n,b);case "Polygon":case "MultiPolygon":return n=ob(c,"Polygon"===f.type?1:2,e),new Ba(n,b);case "GeometryCollection":g=0;for(h=f.geometries.length;g<h;g++)(c=Sb({geometry:f.geometries[g],type:"Feature",properties:a.properties},b))&&n.push(c);return new ua(n);default:throw Error("Invalid GeoJSON object.");
}}function Tb(a){return new y(a[1],a[0],a[2])}function ob(a,b,c){for(var f=[],n=0,d=a.length,e;n<d;n++)e=b?ob(a[n],b-1,c):(c||Tb)(a[n]),f.push(e);return f}function Ub(a,b){b="number"===typeof b?b:6;return void 0!==a.alt?[k(a.lng,b),k(a.lat,b),k(a.alt,b)]:[k(a.lng,b),k(a.lat,b)]}function pb(a,b,c,d){for(var f=[],n=0,e=a.length;n<e;n++)f.push(b?pb(a[n],b-1,c,d):Ub(a[n],d));!b&&c&&f.push(f[0]);return f}function Ca(a,c){return a.feature?b({},a.feature,{geometry:c}):qb(c)}function qb(a){return"Feature"===
a.type||"FeatureCollection"===a.type?a:{type:"Feature",properties:{},geometry:a}}function Ec(a,b){return new ha(a,b)}function Fc(a,b){return new Da(a,b)}function Vb(a){return Gc?new Wb(a):null}function Xb(a){return cb||rb?new Ea(a):null}var Hc=Object.freeze;Object.freeze=function(a){return a};var bb=Object.create||function(){function a(){}return function(f){a.prototype=f;return new a}}(),oc=0,gd=/\{ *([\w_\-]+) *\}/g,aa=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},
pc=0,vb=window.requestAnimationFrame||D("RequestAnimationFrame")||ea,qc=window.cancelAnimationFrame||D("CancelAnimationFrame")||D("CancelRequestAnimationFrame")||function(a){window.clearTimeout(a)},od=(Object.freeze||Object)({freeze:Hc,extend:b,create:bb,bind:c,lastId:oc,stamp:d,throttle:e,wrapNum:g,falseFn:h,formatNum:k,trim:m,splitWords:l,setOptions:p,getParamString:q,template:r,isArray:aa,indexOf:u,emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",requestFn:vb,cancelFn:qc,
requestAnimFrame:I,cancelAnimFrame:P});W.extend=function(a){var f=function(){this.initialize&&this.initialize.apply(this,arguments);this.callInitHooks()},c=f.__super__=this.prototype,d=bb(c);d.constructor=f;f.prototype=d;for(var e in this)this.hasOwnProperty(e)&&"prototype"!==e&&"__super__"!==e&&(f[e]=this[e]);a.statics&&(b(f,a.statics),delete a.statics);a.includes&&(M(a.includes),b.apply(null,[d].concat(a.includes)),delete a.includes);d.options&&(a.options=b(bb(d.options),a.options));b(d,a);d._initHooks=
[];d.callInitHooks=function(){if(!this._initHooksCalled){c.callInitHooks&&c.callInitHooks.call(this);this._initHooksCalled=!0;for(var a=0,f=d._initHooks.length;a<f;a++)d._initHooks[a].call(this)}};return f};W.include=function(a){b(this.prototype,a);return this};W.mergeOptions=function(a){b(this.prototype.options,a);return this};W.addInitHook=function(a){var f=Array.prototype.slice.call(arguments,1);this.prototype._initHooks=this.prototype._initHooks||[];this.prototype._initHooks.push("function"===
typeof a?a:function(){this[a].apply(this,f)});return this};var R={on:function(a,b,c){if("object"===typeof a)for(var f in a)this._on(f,a[f],b);else{a=l(a);f=0;for(var n=a.length;f<n;f++)this._on(a[f],b,c)}return this},off:function(a,b,c){if(a)if("object"===typeof a)for(var f in a)this._off(f,a[f],b);else{a=l(a);f=0;for(var n=a.length;f<n;f++)this._off(a[f],b,c)}else delete this._events;return this},_on:function(a,b,c){this._events=this._events||{};var f=this._events[a];f||(f=[],this._events[a]=f);
c===this&&(c=void 0);a={fn:b,ctx:c};for(var n=0,d=f.length;n<d;n++)if(f[n].fn===b&&f[n].ctx===c)return;f.push(a)},_off:function(a,b,c){var f,n,d;if(this._events&&(f=this._events[a]))if(b){if(c===this&&(c=void 0),f)for(n=0,d=f.length;n<d;n++){var e=f[n];if(e.ctx===c&&e.fn===b){e.fn=h;this._firingCount&&(this._events[a]=f=f.slice());f.splice(n,1);break}}}else{n=0;for(d=f.length;n<d;n++)f[n].fn=h;delete this._events[a]}},fire:function(a,c,d){if(!this.listens(a,d))return this;c=b({},c,{type:a,target:this});
if(this._events&&(a=this._events[a])){this._firingCount=this._firingCount+1||1;for(var f=0,n=a.length;f<n;f++){var e=a[f];e.fn.call(e.ctx||this,c)}this._firingCount--}d&&this._propagateEvent(c);return this},listens:function(a,b){var f=this._events&&this._events[a];if(f&&f.length)return!0;if(b)for(var c in this._eventParents)if(this._eventParents[c].listens(a,b))return!0;return!1},once:function(a,b,d){if("object"===typeof a){for(var f in a)this.once(f,a[f],b);return this}var n=c(function(){this.off(a,
b,d).off(a,n,d)},this);return this.on(a,b,d).on(a,n,d)},addEventParent:function(a){this._eventParents=this._eventParents||{};this._eventParents[d(a)]=a;return this},removeEventParent:function(a){this._eventParents&&delete this._eventParents[d(a)];return this},_propagateEvent:function(a){for(var f in this._eventParents)this._eventParents[f].fire(a.type,b({layer:a.target},a),!0)}};R.addEventListener=R.on;R.removeEventListener=R.clearAllEventListeners=R.off;R.addOneTimeEventListener=R.once;R.fireEvent=
R.fire;R.hasEventListeners=R.listens;var Ta=W.extend(R);v.prototype={clone:function(){return new v(this.x,this.y)},add:function(a){return this.clone()._add(w(a))},_add:function(a){this.x+=a.x;this.y+=a.y;return this},subtract:function(a){return this.clone()._subtract(w(a))},_subtract:function(a){this.x-=a.x;this.y-=a.y;return this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){this.x/=a;this.y/=a;return this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},
_multiplyBy:function(a){this.x*=a;this.y*=a;return this},scaleBy:function(a){return new v(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new v(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},floor:function(){return this.clone()._floor()},_floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){return this.clone()._ceil()},_ceil:function(){this.x=
Math.ceil(this.x);this.y=Math.ceil(this.y);return this},distanceTo:function(a){a=w(a);var f=a.x-this.x;a=a.y-this.y;return Math.sqrt(f*f+a*a)},equals:function(a){a=w(a);return a.x===this.x&&a.y===this.y},contains:function(a){a=w(a);return Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+k(this.x)+", "+k(this.y)+")"}};C.prototype={extend:function(a){a=w(a);this.min||this.max?(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),
this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)):(this.min=a.clone(),this.max=a.clone());return this},getCenter:function(a){return new v((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return new v(this.min.x,this.max.y)},getTopRight:function(){return new v(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var f;
a="number"===typeof a[0]||a instanceof v?w(a):O(a);a instanceof C?(f=a.min,a=a.max):f=a;return f.x>=this.min.x&&a.x<=this.max.x&&f.y>=this.min.y&&a.y<=this.max.y},intersects:function(a){a=O(a);var f=this.min,b=this.max,c=a.min;a=a.max;var d=a.y>=f.y&&c.y<=b.y;return a.x>=f.x&&c.x<=b.x&&d},overlaps:function(a){a=O(a);var f=this.min,b=this.max,c=a.min;a=a.max;var d=a.y>f.y&&c.y<b.y;return a.x>f.x&&c.x<b.x&&d},isValid:function(){return!(!this.min||!this.max)}};H.prototype={extend:function(a){var f=this._southWest,
b=this._northEast,c;if(a instanceof y)c=a;else if(a instanceof H){if(c=a._southWest,a=a._northEast,!c||!a)return this}else return a?this.extend(F(a)||E(a)):this;f||b?(f.lat=Math.min(c.lat,f.lat),f.lng=Math.min(c.lng,f.lng),b.lat=Math.max(a.lat,b.lat),b.lng=Math.max(a.lng,b.lng)):(this._southWest=new y(c.lat,c.lng),this._northEast=new y(a.lat,a.lng));return this},pad:function(a){var f=this._southWest,b=this._northEast,c=Math.abs(f.lat-b.lat)*a;a*=Math.abs(f.lng-b.lng);return new H(new y(f.lat-c,f.lng-
a),new y(b.lat+c,b.lng+a))},getCenter:function(){return new y((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new y(this.getNorth(),this.getWest())},getSouthEast:function(){return new y(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},
getNorth:function(){return this._northEast.lat},contains:function(a){a="number"===typeof a[0]||a instanceof y||"lat"in a?F(a):E(a);var f=this._southWest,b=this._northEast,c;a instanceof H?(c=a.getSouthWest(),a=a.getNorthEast()):c=a;return c.lat>=f.lat&&a.lat<=b.lat&&c.lng>=f.lng&&a.lng<=b.lng},intersects:function(a){a=E(a);var f=this._southWest,b=this._northEast,c=a.getSouthWest();a=a.getNorthEast();var d=a.lng>=f.lng&&c.lng<=b.lng;return a.lat>=f.lat&&c.lat<=b.lat&&d},overlaps:function(a){a=E(a);
var f=this._southWest,b=this._northEast,c=a.getSouthWest();a=a.getNorthEast();var d=a.lng>f.lng&&c.lng<b.lng;return a.lat>f.lat&&c.lat<b.lat&&d},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join()},equals:function(a,b){if(!a)return!1;a=E(a);return this._southWest.equals(a.getSouthWest(),b)&&this._northEast.equals(a.getNorthEast(),b)},isValid:function(){return!(!this._southWest||!this._northEast)}};y.prototype={equals:function(a,b){if(!a)return!1;a=
F(a);return Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng))<=(void 0===b?1E-9:b)},toString:function(a){return"LatLng("+k(this.lat,a)+", "+k(this.lng,a)+")"},distanceTo:function(a){return ma.distance(this,F(a))},wrap:function(){return ma.wrapLatLng(this)},toBounds:function(a){a=180*a/40075017;var f=a/Math.cos(Math.PI/180*this.lat);return E([this.lat-a,this.lng-f],[this.lat+a,this.lng+f])},clone:function(){return new y(this.lat,this.lng,this.alt)}};var ia={latLngToPoint:function(a,b){var f=
this.projection.project(a),c=this.scale(b);return this.transformation._transform(f,c)},pointToLatLng:function(a,b){var f=this.scale(b),f=this.transformation.untransform(a,f);return this.projection.unproject(f)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var f=this.projection.bounds,
b=this.scale(a);a=this.transformation.transform(f.min,b);f=this.transformation.transform(f.max,b);return new C(a,f)},infinite:!1,wrapLatLng:function(a){var f=this.wrapLng?g(a.lng,this.wrapLng,!0):a.lng,b=this.wrapLat?g(a.lat,this.wrapLat,!0):a.lat;return new y(b,f,a.alt)},wrapLatLngBounds:function(a){var f=a.getCenter(),b=this.wrapLatLng(f),c=f.lat-b.lat,f=f.lng-b.lng;if(0===c&&0===f)return a;b=a.getSouthWest();a=a.getNorthEast();b=new y(b.lat-c,b.lng-f);c=new y(a.lat-c,a.lng-f);return new H(b,c)}},
ma=b({},ia,{wrapLng:[-180,180],R:6371E3,distance:function(a,b){var f=Math.PI/180,c=a.lat*f,n=b.lat*f;return this.R*Math.acos(Math.min(Math.sin(c)*Math.sin(n)+Math.cos(c)*Math.cos(n)*Math.cos((b.lng-a.lng)*f),1))}}),Yb={R:6378137,MAX_LATITUDE:85.0511287798,project:function(a){var f=Math.PI/180,b=this.MAX_LATITUDE,b=Math.sin(Math.max(Math.min(b,a.lat),-b)*f);return new v(this.R*a.lng*f,this.R*Math.log((1+b)/(1-b))/2)},unproject:function(a){var f=180/Math.PI;return new y((2*Math.atan(Math.exp(a.y/this.R))-
Math.PI/2)*f,a.x*f/this.R)},bounds:function(){var a=6378137*Math.PI;return new C([-a,-a],[a,a])}()};wa.prototype={transform:function(a,b){return this._transform(a.clone(),b)},_transform:function(a,b){b=b||1;a.x=b*(this._a*a.x+this._b);a.y=b*(this._c*a.y+this._d);return a},untransform:function(a,b){b=b||1;return new v((a.x/b-this._b)/this._a,(a.y/b-this._d)/this._c)}};var Zb=b({},ma,{code:"EPSG:3857",projection:Yb,transformation:function(){var a=.5/(Math.PI*Yb.R);return la(a,.5,-a,.5)}()}),pd=b({},
Zb,{code:"EPSG:900913"}),$b=document.documentElement.style,sb="ActiveXObject"in window,Fa=sb&&!document.addEventListener,Na="msLaunchUri"in navigator&&!("documentMode"in document),ac=Q("webkit"),Oa=Q("android"),Ua=Q("android 2")||Q("android 3"),bc=!!window.opera,hb=Q("chrome"),cc=Q("gecko")&&!ac&&!bc&&!sb,Ic=!hb&&Q("safari"),Jc=Q("phantom"),Kc="OTransition"in $b,Lc=0===navigator.platform.indexOf("Win"),Mb=sb&&"transition"in $b,dc="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ua,
Mc="MozPerspective"in $b,U=!window.L_DISABLE_3D&&(Mb||dc||Mc)&&!Kc&&!Jc,Ga="undefined"!==typeof orientation||Q("mobile"),qd=Ga&&ac,rd=Ga&&dc,na=!window.PointerEvent&&window.MSPointerEvent,ba=!(!window.PointerEvent&&!na),Y=!window.L_NO_TOUCH&&(ba||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),Nc=Ga&&bc,sd=Ga&&cc,oa=1<(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI),Gc=!!document.createElement("canvas").getContext,cb=!(!document.createElementNS||
!La("svg").createSVGRect),rb=!cb&&function(){try{var a=document.createElement("div");a.innerHTML='<v:shape adj="1"/>';var b=a.firstChild;b.style.behavior="url(#default#VML)";return b&&"object"===typeof b.adj}catch(t){return!1}}(),td=(Object.freeze||Object)({ie:sb,ielt9:Fa,edge:Na,webkit:ac,android:Oa,android23:Ua,opera:bc,chrome:hb,gecko:cc,safari:Ic,phantom:Jc,opera12:Kc,win:Lc,ie3d:Mb,webkit3d:dc,gecko3d:Mc,any3d:U,mobile:Ga,mobileWebkit:qd,mobileWebkit3d:rd,msPointer:na,pointer:ba,touch:Y,mobileOpera:Nc,
mobileGecko:sd,retina:oa,canvas:Gc,svg:cb,vml:rb}),wb=na?"MSPointerDown":"pointerdown",xb=na?"MSPointerMove":"pointermove",yb=na?"MSPointerUp":"pointerup",zb=na?"MSPointerCancel":"pointercancel",kd=["INPUT","SELECT","OPTION"],ya={},rc=!1,Bb=0,eb=na?"MSPointerDown":ba?"pointerdown":"touchstart",fb=na?"MSPointerUp":ba?"pointerup":"touchend",X="_goomap_events",nd=Lc&&hb?2*window.devicePixelRatio:cc?window.devicePixelRatio:1,Hb={},Db,ud=(Object.freeze||Object)({on:x,off:L,stopPropagation:qa,disableScrollPropagation:Fb,
disableClickPropagation:Pa,preventDefault:S,stop:ca,getMousePosition:vc,getWheelDelta:wc,fakeStop:Gb,skipped:Eb,isExternalTarget:ib,addListener:x,removeListener:L}),Lb=kb(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),Va=kb(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Oc="webkitTransition"===Va||"OTransition"===Va?Va+"End":"transitionend",Wa,Xa,ec;if("onselectstart"in document)Wa=function(){x(window,"selectstart",S)},Xa=function(){L(window,
"selectstart",S)};else{var Ya=kb(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Wa=function(){if(Ya){var a=document.documentElement.style;ec=a[Ya];a[Ya]="none"}};Xa=function(){Ya&&(document.documentElement.style[Ya]=ec,ec=void 0)}}var mb,Qb,vd=(Object.freeze||Object)({TRANSFORM:Lb,TRANSITION:Va,TRANSITION_END:Oc,get:xc,getStyle:Qa,create:A,remove:J,empty:Ib,toFront:za,toBack:Aa,hasClass:Jb,addClass:B,removeClass:K,setClass:Kb,getClass:jb,setOpacity:T,testProp:kb,setTransform:ra,
setPosition:N,getPosition:sa,disableTextSelection:Wa,enableTextSelection:Xa,disableImageDrag:Nb,enableImageDrag:Ob,preventOutline:Pb,restoreOutline:lb}),Pc=Ta.extend({run:function(a,b,c,d){this.stop();this._el=a;this._inProgress=!0;this._duration=c||.25;this._easeOutPower=1/Math.max(d||.5,.2);this._startPos=sa(a);this._offset=b.subtract(this._startPos);this._startTime=+new Date;this.fire("start");this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=
I(this._animate,this);this._step()},_step:function(a){var f=+new Date-this._startTime,b=1E3*this._duration;f<b?this._runFrame(this._easeOut(f/b),a):(this._runFrame(1),this._complete())},_runFrame:function(a,b){var f=this._startPos.add(this._offset.multiplyBy(a));b&&f._round();N(this._el,f);this.fire("step")},_complete:function(){P(this._animId);this._inProgress=!1;this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}}),z=Ta.extend({options:{crs:Zb,center:void 0,zoom:void 0,
minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,b){b=p(this,b);this._initContainer(a);this._initLayout();this._onResize=c(this._onResize,this);this._initEvents();b.maxBounds&&this.setMaxBounds(b.maxBounds);void 0!==b.zoom&&(this._zoom=this._limitZoom(b.zoom));b.center&&void 0!==b.zoom&&this.setView(F(b.center),
b.zoom,{reset:!0});this._handlers=[];this._layers={};this._zoomBoundLayers={};this._sizeChanged=!0;this.callInitHooks();if(this._zoomAnimated=Va&&U&&!Nc&&this.options.zoomAnimation)this._createAnimProxy(),x(this._proxy,Oc,this._catchTransitionEnd,this);this._addLayers(this.options.layers)},setView:function(a,c,d){c=void 0===c?this._zoom:this._limitZoom(c);a=this._limitCenter(F(a),c,this.options.maxBounds);d=d||{};this._stop();if(this._loaded&&!d.reset&&!0!==d&&(void 0!==d.animate&&(d.zoom=b({animate:d.animate},
d.zoom),d.pan=b({animate:d.animate,duration:d.duration},d.pan)),this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,c,d.zoom):this._tryAnimatedPan(a,d.pan)))return clearTimeout(this._sizeTimer),this;this._resetView(a,c);return this},setZoom:function(a,b){return this._loaded?this.setView(this.getCenter(),a,{zoom:b}):(this._zoom=a,this)},zoomIn:function(a,b){a=a||(U?this.options.zoomDelta:1);return this.setZoom(this._zoom+a,b)},zoomOut:function(a,b){a=a||(U?this.options.zoomDelta:1);return this.setZoom(this._zoom-
a,b)},setZoomAround:function(a,b,c){var f=this.getZoomScale(b),d=this.getSize().divideBy(2);a=(a instanceof v?a:this.latLngToContainerPoint(a)).subtract(d).multiplyBy(1-1/f);d=this.containerPointToLatLng(d.add(a));return this.setView(d,b,{zoom:c})},_getBoundsCenterZoom:function(a,b){b=b||{};a=a.getBounds?a.getBounds():E(a);var f=w(b.paddingTopLeft||b.padding||[0,0]),c=w(b.paddingBottomRight||b.padding||[0,0]),d=this.getBoundsZoom(a,!1,f.add(c)),d="number"===typeof b.maxZoom?Math.min(b.maxZoom,d):
d;if(Infinity===d)return{center:a.getCenter(),zoom:d};var f=c.subtract(f).divideBy(2),c=this.project(a.getSouthWest(),d),n=this.project(a.getNorthEast(),d);return{center:this.unproject(c.add(n).divideBy(2).add(f),d),zoom:d}},fitBounds:function(a,b){a=E(a);if(!a.isValid())throw Error("Bounds are not valid.");var f=this._getBoundsCenterZoom(a,b);return this.setView(f.center,f.zoom,b)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,b){return this.setView(a,this._zoom,
{pan:b})},panBy:function(a,b){a=w(a).round();b=b||{};if(!a.x&&!a.y)return this.fire("moveend");if(!0!==b.animate&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;this._panAnim||(this._panAnim=new Pc,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this));b.noMoveStart||this.fire("movestart");if(!1!==b.animate){B(this._mapPane,"goomap-pan-anim");var f=this._getMapPanePos().subtract(a).round();
this._panAnim.run(this._mapPane,f,b.duration||.25,b.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,b,c){function f(a){a=(u*u-m*m+2.0164*(a?-1:1)*2.0164*D*D)/(4.0328*(a?u:m)*D);a=Math.sqrt(a*a+1)-a;return 1E-9>a?-18:Math.log(a)}function d(a){return(Math.exp(a)+Math.exp(-a))/2}function n(a){return m*(d(p)/d(p+1.42*a))}function e(a){var f=d(p);a=p+1.42*a;a=(Math.exp(a)-Math.exp(-a))/2/d(a);return m*(f*a-(Math.exp(p)-Math.exp(-p))/2)/2.0164}function t(){var f=
(Date.now()-r)/q,c=(1-Math.pow(1-f,1.5))*ea;1>=f?(this._flyToFrame=I(t,this),this._move(this.unproject(g.add(h.subtract(g).multiplyBy(e(c)/D)),l),this.getScaleZoom(m/n(c),l),{flyTo:!0})):this._move(a,b)._moveEnd(!0)}c=c||{};if(!1===c.animate||!U)return this.setView(a,b,c);this._stop();var g=this.project(this.getCenter()),h=this.project(a),k=this.getSize(),l=this._zoom;a=F(a);b=void 0===b?l:b;var m=Math.max(k.x,k.y),u=m*this.getZoomScale(l,b),D=h.distanceTo(g)||1,p=f(0),r=Date.now(),ea=(f(1)-p)/1.42,
q=c.duration?1E3*c.duration:800*ea;this._moveStart(!0);t.call(this);return this},flyToBounds:function(a,b){var f=this._getBoundsCenterZoom(a,b);return this.flyTo(f.center,f.zoom,b)},setMaxBounds:function(a){a=E(a);if(a.isValid())this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds);else return this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds);this.options.maxBounds=a;this._loaded&&this._panInsideMaxBounds();return this.on("moveend",this._panInsideMaxBounds)},
setMinZoom:function(a){this.options.minZoom=a;return this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(a):this},setMaxZoom:function(a){this.options.maxZoom=a;return this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(a):this},panInsideBounds:function(a,b){this._enforcingBounds=!0;var f=this.getCenter(),c=this._limitCenter(f,this._zoom,E(a));f.equals(c)||this.panTo(c,b);this._enforcingBounds=!1;return this},invalidateSize:function(a){if(!this._loaded)return this;a=b({animate:!1,
pan:!0},!0===a?{animate:!0}:a);var f=this.getSize();this._sizeChanged=!0;this._lastCenter=null;var d=this.getSize(),e=f.divideBy(2).round(),g=d.divideBy(2).round(),e=e.subtract(g);if(!e.x&&!e.y)return this;a.animate&&a.pan?this.panBy(e):(a.pan&&this._rawPanBy(e),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend"));return this.fire("resize",{oldSize:f,newSize:d})},stop:function(){this.setZoom(this._limitZoom(this._zoom));
this.options.zoomSnap||this.fire("viewreset");return this._stop()},locate:function(a){a=this._locateOptions=b({timeout:1E4,watch:!1},a);if(!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var f=c(this._handleGeolocationResponse,this),d=c(this._handleGeolocationError,this);a.watch?this._locationWatchId=navigator.geolocation.watchPosition(f,d,a):navigator.geolocation.getCurrentPosition(f,d,a);return this},stopLocate:function(){navigator.geolocation&&
navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId);this._locateOptions&&(this._locateOptions.setView=!1);return this},_handleGeolocationError:function(a){var f=a.code;a=a.message||(1===f?"permission denied":2===f?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld();this.fire("locationerror",{code:f,message:"Geolocation error: "+a+"."})},_handleGeolocationResponse:function(a){var f=new y(a.coords.latitude,a.coords.longitude),
b=f.toBounds(a.coords.accuracy),c=this._locateOptions;if(c.setView){var d=this.getBoundsZoom(b);this.setView(f,c.maxZoom?Math.min(d,c.maxZoom):d)}var f={latlng:f,bounds:b,timestamp:a.timestamp},e;for(e in a.coords)"number"===typeof a.coords[e]&&(f[e]=a.coords[e]);this.fire("locationfound",f)},addHandler:function(a,b){if(!b)return this;var f=this[a]=new b(this);this._handlers.push(f);this.options[a]&&f.enable();return this},remove:function(){this._initEvents(!0);if(this._containerId!==this._container._goomap_id)throw Error("Map container is being reused by another instance");
try{delete this._container._goomap_id,delete this._containerId}catch(n){this._containerId=this._container._goomap_id=void 0}J(this._mapPane);this._clearControlPos&&this._clearControlPos();this._clearHandlers();this._loaded&&this.fire("unload");for(var a in this._layers)this._layers[a].remove();for(a in this._panes)J(this._panes[a]);this._layers=[];this._panes=[];delete this._mapPane;delete this._renderer;return this},createPane:function(a,b){var f="goomap-pane"+(a?" goomap-"+a.replace("Pane","")+
"-pane":""),f=A("div",f,b||this._mapPane);a&&(this._panes[a]=f);return f},getCenter:function(){this._checkIfLoaded();return this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),b=this.unproject(a.getBottomLeft()),a=this.unproject(a.getTopRight());return new H(b,a)},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},
getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?Infinity:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,b,c){a=E(a);c=w(c||[0,0]);var f=this.getZoom()||0,d=this.getMinZoom(),n=this.getMaxZoom(),e=a.getNorthWest();a=a.getSouthEast();c=this.getSize().subtract(c);var t=O(this.project(a,f),this.project(e,f)).getSize(),e=U?this.options.zoomSnap:1;a=c.x/t.x;c=c.y/t.y;f=this.getScaleZoom(b?Math.max(a,c):Math.min(a,c),f);e&&(f=e/100*Math.round(f/
(e/100)),f=b?Math.ceil(f/e)*e:Math.floor(f/e)*e);return Math.max(d,Math.min(n,f))},getSize:function(){if(!this._size||this._sizeChanged)this._size=new v(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1;return this._size.clone()},getPixelBounds:function(a,b){var f=this._getTopLeftPoint(a,b);return new C(f,f.add(this.getSize()))},getPixelOrigin:function(){this._checkIfLoaded();return this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(void 0===
a?this.getZoom():a)},getPane:function(a){return"string"===typeof a?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,b){var f=this.options.crs;b=void 0===b?this._zoom:b;return f.scale(a)/f.scale(b)},getScaleZoom:function(a,b){var f=this.options.crs;b=void 0===b?this._zoom:b;f=f.zoom(a*f.scale(b));return isNaN(f)?Infinity:f},project:function(a,b){b=void 0===b?this._zoom:b;return this.options.crs.latLngToPoint(F(a),b)},
unproject:function(a,b){b=void 0===b?this._zoom:b;return this.options.crs.pointToLatLng(w(a),b)},layerPointToLatLng:function(a){a=w(a).add(this.getPixelOrigin());return this.unproject(a)},latLngToLayerPoint:function(a){return this.project(F(a))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(F(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(E(a))},distance:function(a,b){return this.options.crs.distance(F(a),F(b))},containerPointToLayerPoint:function(a){return w(a).subtract(this._getMapPanePos())},
layerPointToContainerPoint:function(a){return w(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){a=this.containerPointToLayerPoint(w(a));return this.layerPointToLatLng(a)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(F(a)))},mouseEventToContainerPoint:function(a){return vc(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},
_initContainer:function(a){a=this._container=xc(a);if(!a)throw Error("Map container not found.");if(a._goomap_id)throw Error("Map container is already initialized.");x(a,"scroll",this._onScroll,this);this._containerId=d(a)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&U;B(a,"goomap-container"+(Y?" goomap-touch":"")+(oa?" goomap-retina":"")+(Fa?" goomap-oldie":"")+(Ic?" goomap-safari":"")+(this._fadeAnimated?" goomap-fade-anim":""));var b=Qa(a,"position");
"absolute"!==b&&"relative"!==b&&"fixed"!==b&&(a.style.position="relative");this._initPanes();this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={};this._mapPane=this.createPane("mapPane",this._container);N(this._mapPane,new v(0,0));this.createPane("tilePane");this.createPane("shadowPane");this.createPane("overlayPane");this.createPane("markerPane");this.createPane("tooltipPane");this.createPane("popupPane");this.options.markerZoomAnimation||
(B(a.markerPane,"goomap-zoom-hide"),B(a.shadowPane,"goomap-zoom-hide"))},_resetView:function(a,b){N(this._mapPane,new v(0,0));var f=!this._loaded;this._loaded=!0;b=this._limitZoom(b);this.fire("viewprereset");var c=this._zoom!==b;this._moveStart(c)._move(a,b)._moveEnd(c);this.fire("viewreset");f&&this.fire("load")},_moveStart:function(a){a&&this.fire("zoomstart");return this.fire("movestart")},_move:function(a,b,c){void 0===b&&(b=this._zoom);var f=this._zoom!==b;this._zoom=b;this._lastCenter=a;this._pixelOrigin=
this._getNewPixelOrigin(a);(f||c&&c.pinch)&&this.fire("zoom",c);return this.fire("move",c)},_moveEnd:function(a){a&&this.fire("zoomend");return this.fire("moveend")},_stop:function(){P(this._flyToFrame);this._panAnim&&this._panAnim.stop();return this},_rawPanBy:function(a){N(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw Error("Set map center and zoom first.");
},_initEvents:function(a){this._targets={};this._targets[d(this._container)]=this;var f=a?L:x;f(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this);this.options.trackResize&&f(window,"resize",this._onResize,this);U&&this.options.transform3DLimit&&(a?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){P(this._resizeRequest);this._resizeRequest=I(function(){this.invalidateSize({debounceMoveend:!0})},
this)},_onScroll:function(){this._container.scrollTop=0;this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,b){for(var f=[],c,n="mouseout"===b||"mouseover"===b,e=a.target||a.srcElement,g=!1;e;){if((c=this._targets[d(e)])&&("click"===b||"preclick"===b)&&!a._simulated&&this._draggableMoved(c)){g=!0;break}if(c&&c.listens(b,!0)){if(n&&
!ib(e,a))break;f.push(c);if(n)break}if(e===this._container)break;e=e.parentNode}f.length||g||n||!ib(e,a)||(f=[this]);return f},_handleDOMEvent:function(a){if(this._loaded&&!Eb(a)){var f=a.type;"mousedown"!==f&&"keypress"!==f||Pb(a.target||a.srcElement);this._fireDOMEvent(a,f)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(a,c,d){if("click"===a.type){var f=b({},a);f.type="preclick";this._fireDOMEvent(f,f.type,d)}if(!a._stopped&&(d=(d||[]).concat(this._findEventTargets(a,
c)),d.length)){var n=d[0];"contextmenu"===c&&n.listens(c,!0)&&S(a);f={originalEvent:a};if("keypress"!==a.type){var e=n.options&&"icon"in n.options;f.containerPoint=e?this.latLngToContainerPoint(n.getLatLng()):this.mouseEventToContainerPoint(a);f.layerPoint=this.containerPointToLayerPoint(f.containerPoint);f.latlng=e?n.getLatLng():this.layerPointToLatLng(f.layerPoint)}for(a=0;a<d.length&&!(d[a].fire(c,f,!0),f.originalEvent._stopped||!1===d[a].options.bubblingMouseEvents&&-1!==u(this._mouseEvents,c));a++);
}},_draggableMoved:function(a){a=a.dragging&&a.dragging.enabled()?a:this;return a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,b=this._handlers.length;a<b;a++)this._handlers[a].disable()},whenReady:function(a,b){if(this._loaded)a.call(b||this,{target:this});else this.on("load",a,b);return this},_getMapPanePos:function(){return sa(this._mapPane)||new v(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,
b){return(a&&void 0!==b?this._getNewPixelOrigin(a,b):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,b){var f=this.getSize()._divideBy(2);return this.project(a,b)._subtract(f)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,b,c){c=this._getNewPixelOrigin(c,b);return this.project(a,b)._subtract(c)},_latLngBoundsToNewLayerBounds:function(a,b,c){c=this._getNewPixelOrigin(c,b);return O([this.project(a.getSouthWest(),b)._subtract(c),this.project(a.getNorthWest(),
b)._subtract(c),this.project(a.getSouthEast(),b)._subtract(c),this.project(a.getNorthEast(),b)._subtract(c)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,b,c){if(!c)return a;var f=this.project(a,b),d=this.getSize().divideBy(2),d=new C(f.subtract(d),f.add(d));c=this._getBoundsOffset(d,c,b);return c.round().equals([0,
0])?a:this.unproject(f.add(c),b)},_limitOffset:function(a,b){if(!b)return a;var f=this.getPixelBounds(),f=new C(f.min.add(a),f.max.add(a));return a.add(this._getBoundsOffset(f,b))},_getBoundsOffset:function(a,b,c){c=O(this.project(b.getNorthEast(),c),this.project(b.getSouthWest(),c));b=c.min.subtract(a.min);c=c.max.subtract(a.max);a=this._rebound(b.x,-c.x);b=this._rebound(b.y,-c.y);return new v(a,b)},_rebound:function(a,b){return 0<a+b?Math.round(a-b)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(b))},
_limitZoom:function(a){var f=this.getMinZoom(),b=this.getMaxZoom(),c=U?this.options.zoomSnap:1;c&&(a=Math.round(a/c)*c);return Math.max(f,Math.min(b,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){K(this._mapPane,"goomap-pan-anim");this.fire("moveend")},_tryAnimatedPan:function(a,b){var f=this._getCenterOffset(a)._floor();if(!0!==(b&&b.animate)&&!this.getSize().contains(f))return!1;this.panBy(f,b);return!0},_createAnimProxy:function(){var a=this._proxy=A("div",
"goomap-proxy goomap-zoom-animated");this._panes.mapPane.appendChild(a);this.on("zoomanim",function(a){var f=Lb,b=this._proxy.style[f];ra(this._proxy,this.project(a.center,a.zoom),this.getZoomScale(a.zoom,1));b===this._proxy.style[f]&&this._animatingZoom&&this._onZoomTransitionEnd()},this);this.on("load moveend",function(){var a=this.getCenter(),f=this.getZoom();ra(this._proxy,this.project(a,f),this.getZoomScale(f,1))},this);this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){J(this._proxy);
delete this._proxy},_catchTransitionEnd:function(a){this._animatingZoom&&0<=a.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("goomap-zoom-animated").length},_tryAnimatedZoom:function(a,b,c){if(this._animatingZoom)return!0;c=c||{};if(!this._zoomAnimated||!1===c.animate||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;var f=this.getZoomScale(b),f=this._getCenterOffset(a)._divideBy(1-
1/f);if(!0!==c.animate&&!this.getSize().contains(f))return!1;I(function(){this._moveStart(!0)._animateZoom(a,b,!0)},this);return!0},_animateZoom:function(a,b,d,e){d&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=b,B(this._mapPane,"goomap-zoom-anim"));this.fire("zoomanim",{center:a,zoom:b,noUpdate:e});setTimeout(c(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(K(this._mapPane,"goomap-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,
this._animateToZoom),I(function(){this._moveEnd(!0)},this))}}),Z=W.extend({options:{position:"topright"},initialize:function(a){p(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var f=this._map;f&&f.removeControl(this);this.options.position=a;f&&f.addControl(this);return this},getContainer:function(){return this._container},addTo:function(a){this.remove();this._map=a;var f=this._container=this.onAdd(a),b=this.getPosition();a=a._controlCorners[b];B(f,"goomap-control");
-1!==b.indexOf("bottom")?a.insertBefore(f,a.firstChild):a.appendChild(f);return this},remove:function(){if(!this._map)return this;J(this._container);if(this.onRemove)this.onRemove(this._map);this._map=null;return this},_refocusOnMap:function(a){this._map&&a&&0<a.screenX&&0<a.screenY&&this._map.getContainer().focus()}}),Za=function(a){return new Z(a)};z.include({addControl:function(a){a.addTo(this);return this},removeControl:function(a){a.remove();return this},_initControlPos:function(){function a(a,
f){b[a+f]=A("div","goomap-"+a+" goomap-"+f,c)}var b=this._controlCorners={},c=this._controlContainer=A("div","goomap-control-container",this._container);a("top","left");a("top","right");a("bottom","left");a("bottom","right")},_clearControlPos:function(){for(var a in this._controlCorners)J(this._controlCorners[a]);J(this._controlContainer);delete this._controlCorners;delete this._controlContainer}});var Qc=Z.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,
sortFunction:function(a,b,c,d){return c<d?-1:d<c?1:0}},initialize:function(a,b,c){p(this,c);this._layerControlInputs=[];this._layers=[];this._lastZIndex=0;this._handlingClick=!1;for(var f in a)this._addLayer(a[f],f);for(f in b)this._addLayer(b[f],f,!0)},onAdd:function(a){this._initLayout();this._update();this._map=a;a.on("zoomend",this._checkDisabledLayers,this);for(a=0;a<this._layers.length;a++)this._layers[a].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(a){Z.prototype.addTo.call(this,
a);return this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,b){this._addLayer(a,b);return this._map?this._update():this},addOverlay:function(a,b){this._addLayer(a,b,!0);return this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);(a=this._getLayer(d(a)))&&this._layers.splice(this._layers.indexOf(a),
1);return this._map?this._update():this},expand:function(){B(this._container,"goomap-control-layers-expanded");this._form.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);a<this._form.clientHeight?(B(this._form,"goomap-control-layers-scrollbar"),this._form.style.height=a+"px"):K(this._form,"goomap-control-layers-scrollbar");this._checkDisabledLayers();return this},collapse:function(){K(this._container,"goomap-control-layers-expanded");return this},_initLayout:function(){var a=
this._container=A("div","goomap-control-layers"),b=this.options.collapsed;a.setAttribute("aria-haspopup",!0);Pa(a);Fb(a);var c=this._form=A("form","goomap-control-layers-list");b&&(this._map.on("click",this.collapse,this),Oa||x(a,{mouseenter:this.expand,mouseleave:this.collapse},this));var d=this._layersLink=A("a","goomap-control-layers-toggle",a);d.href="#";d.title="Layers";Y?(x(d,"click",ca),x(d,"click",this.expand,this)):x(d,"focus",this.expand,this);b||this.expand();this._baseLayersList=A("div",
"goomap-control-layers-base",c);this._separator=A("div","goomap-control-layers-separator",c);this._overlaysList=A("div","goomap-control-layers-overlays",c);a.appendChild(c)},_getLayer:function(a){for(var b=0;b<this._layers.length;b++)if(this._layers[b]&&d(this._layers[b].layer)===a)return this._layers[b]},_addLayer:function(a,b,d){if(this._map)a.on("add remove",this._onLayerChange,this);this._layers.push({layer:a,name:b,overlay:d});this.options.sortLayers&&this._layers.sort(c(function(a,b){return this.options.sortFunction(a.layer,
b.layer,a.name,b.name)},this));this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex));this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Ib(this._baseLayersList);Ib(this._overlaysList);this._layerControlInputs=[];var a,b,c,d,e=0;for(c=0;c<this._layers.length;c++)d=this._layers[c],this._addItem(d),b=b||d.overlay,a=a||!d.overlay,e+=d.overlay?0:1;this.options.hideSingleBase&&(a=a&&1<e,this._baseLayersList.style.display=a?"":"none");this._separator.style.display=
b&&a?"":"none";return this},_onLayerChange:function(a){this._handlingClick||this._update();var b=this._getLayer(d(a.target));(a=b.overlay?"add"===a.type?"overlayadd":"overlayremove":"add"===a.type?"baselayerchange":null)&&this._map.fire(a,b)},_createRadioElement:function(a,b){var f='<input type="radio" class="goomap-control-layers-selector" name="'+a+'"'+(b?' checked="checked"':"")+"/>",c=document.createElement("div");c.innerHTML=f;return c.firstChild},_addItem:function(a){var b=document.createElement("label"),
f=this._map.hasLayer(a.layer),c;a.overlay?(c=document.createElement("input"),c.type="checkbox",c.className="goomap-control-layers-selector",c.defaultChecked=f):c=this._createRadioElement("goomap-base-layers",f);this._layerControlInputs.push(c);c.layerId=d(a.layer);x(c,"click",this._onInputClick,this);f=document.createElement("span");f.innerHTML=" "+a.name;var e=document.createElement("div");b.appendChild(e);e.appendChild(c);e.appendChild(f);(a.overlay?this._overlaysList:this._baseLayersList).appendChild(b);
this._checkDisabledLayers();return b},_onInputClick:function(){var a=this._layerControlInputs,b,c,d=[],e=[];this._handlingClick=!0;for(var g=a.length-1;0<=g;g--)b=a[g],c=this._getLayer(b.layerId).layer,b.checked?d.push(c):b.checked||e.push(c);for(g=0;g<e.length;g++)this._map.hasLayer(e[g])&&this._map.removeLayer(e[g]);for(g=0;g<d.length;g++)this._map.hasLayer(d[g])||this._map.addLayer(d[g]);this._handlingClick=!1;this._refocusOnMap()},_checkDisabledLayers:function(){for(var a=this._layerControlInputs,
b,c,d=this._map.getZoom(),e=a.length-1;0<=e;e--)b=a[e],c=this._getLayer(b.layerId).layer,b.disabled=void 0!==c.options.minZoom&&d<c.options.minZoom||void 0!==c.options.maxZoom&&d>c.options.maxZoom},_expandIfNotCollapsed:function(){this._map&&!this.options.collapsed&&this.expand();return this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),fc=Z.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},
onAdd:function(a){var b=A("div","goomap-control-zoom goomap-bar"),f=this.options;this._zoomInButton=this._createButton(f.zoomInText,f.zoomInTitle,"goomap-control-zoom-in",b,this._zoomIn);this._zoomOutButton=this._createButton(f.zoomOutText,f.zoomOutTitle,"goomap-control-zoom-out",b,this._zoomOut);this._updateDisabled();a.on("zoomend zoomlevelschange",this._updateDisabled,this);return b},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){this._disabled=
!0;this._updateDisabled();return this},enable:function(){this._disabled=!1;this._updateDisabled();return this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,b,c,d,e){c=A("a",c,d);c.innerHTML=a;c.href="#";c.title=b;c.setAttribute("role","button");
c.setAttribute("aria-label",b);Pa(c);x(c,"click",ca);x(c,"click",e,this);x(c,"click",this._refocusOnMap,this);return c},_updateDisabled:function(){var a=this._map;K(this._zoomInButton,"goomap-disabled");K(this._zoomOutButton,"goomap-disabled");(this._disabled||a._zoom===a.getMinZoom())&&B(this._zoomOutButton,"goomap-disabled");(this._disabled||a._zoom===a.getMaxZoom())&&B(this._zoomInButton,"goomap-disabled")}});z.mergeOptions({zoomControl:!0});z.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=
new fc,this.addControl(this.zoomControl))});var Rc=Z.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var b=A("div","goomap-control-scale"),f=this.options;this._addScales(f,"goomap-control-scale-line",b);a.on(f.updateWhenIdle?"moveend":"move",this._update,this);a.whenReady(this._update,this);return b},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,b,c){a.metric&&(this._mScale=A("div",b,c));
a.imperial&&(this._iScale=A("div",b,c))},_update:function(){var a=this._map,b=a.getSize().y/2,a=a.distance(a.containerPointToLatLng([0,b]),a.containerPointToLatLng([this.options.maxWidth,b]));this._updateScales(a)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a);this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var b=this._getRoundNum(a);this._updateScale(this._mScale,1E3>b?b+" m":b/1E3+" km",b/a)},_updateImperial:function(a){a*=3.2808399;var b;5280<
a?(a/=5280,b=this._getRoundNum(a),this._updateScale(this._iScale,b+" mi",b/a)):(b=this._getRoundNum(a),this._updateScale(this._iScale,b+" ft",b/a))},_updateScale:function(a,b,c){a.style.width=Math.round(this.options.maxWidth*c)+"px";a.innerHTML=b},_getRoundNum:function(a){var b=Math.pow(10,(Math.floor(a)+"").length-1);a/=b;return b*(10<=a?10:5<=a?5:3<=a?3:2<=a?2:1)}}),gc=Z.extend({options:{position:"bottomright",prefix:'<a href="http://jungoo.cn" title="A JS library for interactive maps">GooMap</a>'},
initialize:function(a){p(this,a);this._attributions={}},onAdd:function(a){a.attributionControl=this;this._container=A("div","goomap-control-attribution");Pa(this._container);for(var b in a._layers)a._layers[b].getAttribution&&this.addAttribution(a._layers[b].getAttribution());this._update();return this._container},setPrefix:function(a){this.options.prefix=a;this._update();return this},addAttribution:function(a){if(!a)return this;this._attributions[a]||(this._attributions[a]=0);this._attributions[a]++;
this._update();return this},removeAttribution:function(a){if(!a)return this;this._attributions[a]&&(this._attributions[a]--,this._update());return this},_update:function(){if(this._map){var a=[],b;for(b in this._attributions)this._attributions[b]&&a.push(b);b=[];this.options.prefix&&b.push(this.options.prefix);a.length&&b.push(a.join(", "));this._container.innerHTML=b.join(" | ")}}});z.mergeOptions({attributionControl:!0});z.addInitHook(function(){this.options.attributionControl&&(new gc).addTo(this)});
Z.Layers=Qc;Z.Zoom=fc;Z.Scale=Rc;Z.Attribution=gc;Za.layers=function(a,b,c){return new Qc(a,b,c)};Za.zoom=function(a){return new fc(a)};Za.scale=function(a){return new Rc(a)};Za.attribution=function(a){return new gc(a)};var ja=W.extend({initialize:function(a){this._map=a},enable:function(){if(this._enabled)return this;this._enabled=!0;this.addHooks();return this},disable:function(){if(!this._enabled)return this;this._enabled=!1;this.removeHooks();return this},enabled:function(){return!!this._enabled}}),
wd={Events:R},Sc=Y?"touchstart mousedown":"mousedown",Tc={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},hc={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},va=Ta.extend({options:{clickTolerance:3},initialize:function(a,b,c,d){p(this,d);this._element=a;this._dragStartTarget=b||a;this._preventOutline=c},enable:function(){this._enabled||(x(this._dragStartTarget,Sc,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&
(va._dragging===this&&this.finishDrag(),L(this._dragStartTarget,Sc,this._onDown,this),this._moved=this._enabled=!1)},_onDown:function(a){if(!a._simulated&&this._enabled&&(this._moved=!1,!(Jb(this._element,"goomap-zoom-anim")||va._dragging||a.shiftKey||1!==a.which&&1!==a.button&&!a.touches||(va._dragging=this,this._preventOutline&&Pb(this._element),Nb(),Wa(),this._moving)))){this.fire("down");var b=a.touches?a.touches[0]:a;this._startPoint=new v(b.clientX,b.clientY);x(document,hc[a.type],this._onMove,
this);x(document,Tc[a.type],this._onUp,this)}},_onMove:function(a){if(!a._simulated&&this._enabled)if(a.touches&&1<a.touches.length)this._moved=!0;else{var b=a.touches&&1===a.touches.length?a.touches[0]:a,b=(new v(b.clientX,b.clientY)).subtract(this._startPoint);!b.x&&!b.y||Math.abs(b.x)+Math.abs(b.y)<this.options.clickTolerance||(S(a),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=sa(this._element).subtract(b),B(document.body,"goomap-dragging"),this._lastTarget=a.target||a.srcElement,
window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),B(this._lastTarget,"goomap-drag-target")),this._newPos=this._startPos.add(b),this._moving=!0,P(this._animRequest),this._lastEvent=a,this._animRequest=I(this._updatePosition,this,!0))}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a);N(this._element,this._newPos);this.fire("drag",a)},_onUp:function(a){!a._simulated&&this._enabled&&
this.finishDrag()},finishDrag:function(){K(document.body,"goomap-dragging");this._lastTarget&&(K(this._lastTarget,"goomap-drag-target"),this._lastTarget=null);for(var a in hc)L(document,hc[a],this._onMove,this),L(document,Tc[a],this._onUp,this);Ob();Xa();this._moved&&this._moving&&(P(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)}));this._moving=!1;va._dragging=!1}}),Bc,xd=(Object.freeze||Object)({simplify:yc,pointToSegmentDistance:zc,closestPointOnSegment:function(a,
b,c){return Ra(a,b,c)},clipSegment:Ac,_getEdgeIntersection:nb,_getBitCode:ta,_sqClosestPointOnSegment:Ra,isFlat:fa,_flat:Cc}),yd=(Object.freeze||Object)({clipPolygon:Dc}),ic={project:function(a){return new v(a.lng,a.lat)},unproject:function(a){return new y(a.y,a.x)},bounds:new C([-180,-90],[180,90])},jc={R:6378137,R_MINOR:6356752.314245179,bounds:new C([-2.003750834279E7,-1.549657073972E7],[2.003750834279E7,1.876465623138E7]),project:function(a){var b=Math.PI/180,f=this.R,c=a.lat*b,d=this.R_MINOR/
f,d=Math.sqrt(1-d*d),e=d*Math.sin(c),c=-f*Math.log(Math.max(Math.tan(Math.PI/4-c/2)/Math.pow((1-e)/(1+e),d/2),1E-10));return new v(a.lng*b*f,c)},unproject:function(a){for(var b=180/Math.PI,f=this.R,c=this.R_MINOR/f,c=Math.sqrt(1-c*c),d=Math.exp(-a.y/f),e=Math.PI/2-2*Math.atan(d),g=0,h=.1;15>g&&1E-7<Math.abs(h);g++)h=c*Math.sin(e),h=Math.pow((1-h)/(1+h),c/2),h=Math.PI/2-2*Math.atan(d*h)-e,e+=h;return new y(e*b,a.x*b/f)}},zd=(Object.freeze||Object)({LonLat:ic,Mercator:jc,SphericalMercator:Yb}),Ad=b({},
ma,{code:"EPSG:3395",projection:jc,transformation:function(){var a=.5/(Math.PI*jc.R);return la(a,.5,-a,.5)}()}),Uc=b({},ma,{code:"EPSG:4326",projection:ic,transformation:la(1/180,1,-1/180,.5)}),Bd=b({},ia,{projection:ic,transformation:la(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,b){var f=b.lng-a.lng,c=b.lat-a.lat;return Math.sqrt(f*f+c*c)},infinite:!0});ia.Earth=ma;ia.EPSG3395=Ad;ia.EPSG3857=Zb;ia.EPSG900913=pd;ia.EPSG4326=
Uc;ia.Simple=Bd;var V=Ta.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(a){a.addLayer(this);return this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){a&&a.removeLayer(this);return this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){this._map._targets[d(a)]=this;return this},removeInteractiveTarget:function(a){delete this._map._targets[d(a)];
return this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var b=a.target;if(b.hasLayer(this)){this._map=b;this._zoomAnimated=b._zoomAnimated;if(this.getEvents){var f=this.getEvents();b.on(f,this);this.once("remove",function(){b.off(f,this)},this)}this.onAdd(b);this.getAttribution&&b.attributionControl&&b.attributionControl.addAttribution(this.getAttribution());this.fire("add");b.fire("layeradd",{layer:this})}}});z.include({addLayer:function(a){if(!a._layerAdd)throw Error("The provided object is not a Layer.");
var b=d(a);if(this._layers[b])return this;this._layers[b]=a;a._mapToAdd=this;a.beforeAdd&&a.beforeAdd(this);this.whenReady(a._layerAdd,a);return this},removeLayer:function(a){var b=d(a);if(!this._layers[b])return this;if(this._loaded)a.onRemove(this);a.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(a.getAttribution());delete this._layers[b];this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove"));a._map=a._mapToAdd=null;return this},hasLayer:function(a){return!!a&&
d(a)in this._layers},eachLayer:function(a,b){for(var f in this._layers)a.call(b,this._layers[f]);return this},_addLayers:function(a){a=a?aa(a)?a:[a]:[];for(var b=0,f=a.length;b<f;b++)this.addLayer(a[b])},_addZoomLimit:function(a){if(isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))this._zoomBoundLayers[d(a)]=a,this._updateZoomLevels()},_removeZoomLimit:function(a){a=d(a);this._zoomBoundLayers[a]&&(delete this._zoomBoundLayers[a],this._updateZoomLevels())},_updateZoomLevels:function(){var a=Infinity,
b=-Infinity,c=this._getZoomSpan(),d;for(d in this._zoomBoundLayers)var e=this._zoomBoundLayers[d].options,a=void 0===e.minZoom?a:Math.min(a,e.minZoom),b=void 0===e.maxZoom?b:Math.max(b,e.maxZoom);this._layersMaxZoom=-Infinity===b?void 0:b;this._layersMinZoom=Infinity===a?void 0:a;c!==this._getZoomSpan()&&this.fire("zoomlevelschange");void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom);void 0===this.options.minZoom&&this._layersMinZoom&&
this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ha=V.extend({initialize:function(a){this._layers={};var b,f;if(a)for(b=0,f=a.length;b<f;b++)this.addLayer(a[b])},addLayer:function(a){var b=this.getLayerId(a);this._layers[b]=a;this._map&&this._map.addLayer(a);return this},removeLayer:function(a){a=a in this._layers?a:this.getLayerId(a);this._map&&this._layers[a]&&this._map.removeLayer(this._layers[a]);delete this._layers[a];return this},hasLayer:function(a){return!!a&&(a in
this._layers||this.getLayerId(a)in this._layers)},clearLayers:function(){for(var a in this._layers)this.removeLayer(this._layers[a]);return this},invoke:function(a){var b=Array.prototype.slice.call(arguments,1),f,c;for(f in this._layers)c=this._layers[f],c[a]&&c[a].apply(c,b);return this},onAdd:function(a){for(var b in this._layers)a.addLayer(this._layers[b])},onRemove:function(a){for(var b in this._layers)a.removeLayer(this._layers[b])},eachLayer:function(a,b){for(var f in this._layers)a.call(b,
this._layers[f]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[],b;for(b in this._layers)a.push(this._layers[b]);return a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return d(a)}}),ua=Ha.extend({addLayer:function(a){if(this.hasLayer(a))return this;a.addEventParent(this);Ha.prototype.addLayer.call(this,a);return this.fire("layeradd",{layer:a})},removeLayer:function(a){if(!this.hasLayer(a))return this;a in this._layers&&(a=
this._layers[a]);a.removeEventParent(this);Ha.prototype.removeLayer.call(this,a);return this.fire("layerremove",{layer:a})},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new H,b;for(b in this._layers){var c=this._layers[b];a.extend(c.getBounds?c.getBounds():c.getLatLng())}return a}}),Ia=W.extend({initialize:function(a){p(this,a)},createIcon:function(a){return this._createIcon("icon",
a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,b){var f=this._getIconUrl(a);if(!f){if("icon"===a)throw Error("iconUrl not set in Icon options (see the docs).");return null}f=this._createImg(f,b&&"IMG"===b.tagName?b:null);this._setIconStyles(f,a);return f},_setIconStyles:function(a,b){var f=this.options,c=f[b+"Size"];"number"===typeof c&&(c=[c,c]);var c=w(c),d=w("shadow"===b&&f.shadowAnchor||f.iconAnchor||c&&c.divideBy(2,!0));a.className="goomap-marker-"+b+
" "+(f.className||"");d&&(a.style.marginLeft=-d.x+"px",a.style.marginTop=-d.y+"px");c&&(a.style.width=c.x+"px",a.style.height=c.y+"px")},_createImg:function(a,b){b=b||document.createElement("img");b.src=a;return b},_getIconUrl:function(a){return oa&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}}),$a=Ia.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,
41]},_getIconUrl:function(a){$a.imagePath||($a.imagePath=this._detectIconPath());return(this.options.imagePath||$a.imagePath)+Ia.prototype._getIconUrl.call(this,a)},_detectIconPath:function(){var a=A("div","goomap-default-icon-path",document.body),b=Qa(a,"background-image")||Qa(a,"backgroundImage");document.body.removeChild(a);return b=null===b||0!==b.indexOf("url")?"":b.replace(/^url\([\"\']?/,"").replace(/marker-icon\.png[\"\']?\)$/,"")}}),Vc=ja.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=
this._marker._icon;this._draggable||(this._draggable=new va(a,a,!0));this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable();B(a,"goomap-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable();this._marker._icon&&K(this._marker._icon,"goomap-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=
this._marker.getLatLng();this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(a){var b=this._marker,f=b._shadow,c=sa(b._icon),d=b._map.layerPointToLatLng(c);f&&N(f,c);b._latlng=d;a.latlng=d;a.oldLatLng=this._oldLatLng;b.fire("move",a).fire("drag",a)},_onDragEnd:function(a){delete this._oldLatLng;this._marker.fire("moveend").fire("dragend",a)}}),Sa=V.extend({options:{icon:new $a,interactive:!0,draggable:!1,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,
riseOffset:250,pane:"markerPane",bubblingMouseEvents:!1},initialize:function(a,b){p(this,b);this._latlng=F(a)},onAdd:function(a){if(this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation)a.on("zoomanim",this._animateZoom,this);this._initIcon();this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks());delete this.dragging;this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this);this._removeIcon();this._removeShadow()},
getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var b=this._latlng;this._latlng=F(a);this.update();return this.fire("move",{oldLatLng:b,latlng:this._latlng})},setZIndexOffset:function(a){this.options.zIndexOffset=a;return this.update()},setIcon:function(a){this.options.icon=a;this._map&&(this._initIcon(),this.update());this._popup&&this.bindPopup(this._popup,this._popup.options);return this},getElement:function(){return this._icon},
update:function(){if(this._icon){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,b="goomap-zoom-"+(this._zoomAnimated?"animated":"hide"),c=a.icon.createIcon(this._icon),d=!1;c!==this._icon&&(this._icon&&this._removeIcon(),d=!0,a.title&&(c.title=a.title),a.alt&&(c.alt=a.alt));B(c,b);a.keyboard&&(c.tabIndex="0");this._icon=c;if(a.riseOnHover)this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var c=a.icon.createShadow(this._shadow),
e=!1;c!==this._shadow&&(this._removeShadow(),e=!0);c&&(B(c,b),c.alt="");this._shadow=c;1>a.opacity&&this._updateOpacity();d&&this.getPane().appendChild(this._icon);this._initInteraction();c&&e&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex});J(this._icon);this.removeInteractiveTarget(this._icon);this._icon=null},_removeShadow:function(){this._shadow&&J(this._shadow);this._shadow=
null},_setPos:function(a){N(this._icon,a);this._shadow&&N(this._shadow,a);this._zIndex=a.y+this.options.zIndexOffset;this._resetZIndex()},_updateZIndex:function(a){this._icon.style.zIndex=this._zIndex+a},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(a)},_initInteraction:function(){if(this.options.interactive&&(B(this._icon,"goomap-interactive"),this.addInteractiveTarget(this._icon),Vc)){var a=this.options.draggable;this.dragging&&(a=
this.dragging.enabled(),this.dragging.disable());this.dragging=new Vc(this);a&&this.dragging.enable()}},setOpacity:function(a){this.options.opacity=a;this._map&&this._updateOpacity();return this},_updateOpacity:function(){var a=this.options.opacity;T(this._icon,a);this._shadow&&T(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||
[0,0]}}),pa=V.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this);this._reset();this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){this._map&&this._renderer._updatePath(this);
return this},setStyle:function(a){p(this,a);this._renderer&&this._renderer._updateStyle(this);return this},bringToFront:function(){this._renderer&&this._renderer._bringToFront(this);return this},bringToBack:function(){this._renderer&&this._renderer._bringToBack(this);return this},getElement:function(){return this._path},_reset:function(){this._project();this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(Y?10:0)}}),tb=pa.extend({options:{fill:!0,radius:10},
initialize:function(a,b){p(this,b);this._latlng=F(a);this._radius=this.options.radius},setLatLng:function(a){this._latlng=F(a);this.redraw();return this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){this.options.radius=this._radius=a;return this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var b=a&&a.radius||this._radius;pa.prototype.setStyle.call(this,a);this.setRadius(b);return this},_project:function(){this._point=
this._map.latLngToLayerPoint(this._latlng);this._updateBounds()},_updateBounds:function(){var a=this._radius,b=this._radiusY||a,c=this._clickTolerance(),a=[a+c,b+c];this._pxBounds=new C(this._point.subtract(a),this._point.add(a))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(a){return a.distanceTo(this._point)<=this._radius+
this._clickTolerance()}}),kc=tb.extend({initialize:function(a,c,d){"number"===typeof c&&(c=b({},d,{radius:c}));p(this,c);this._latlng=F(a);if(isNaN(this.options.radius))throw Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){this._mRadius=a;return this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new H(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},
setStyle:pa.prototype.setStyle,_project:function(){var a=this._latlng.lng,b=this._latlng.lat,c=this._map,d=c.options.crs;if(d.distance===ma.distance){var e=Math.PI/180,d=this._mRadius/ma.R/e,g=c.project([b+d,a]),h=c.project([b-d,a]),h=g.add(h).divideBy(2),k=c.unproject(h).lat,e=Math.acos((Math.cos(d*e)-Math.sin(b*e)*Math.sin(k*e))/(Math.cos(b*e)*Math.cos(k*e)))/e;if(isNaN(e)||0===e)e=d/Math.cos(Math.PI/180*b);this._point=h.subtract(c.getPixelOrigin());this._radius=isNaN(e)?0:Math.max(Math.round(h.x-
c.project([k,a-e]).x),1);this._radiusY=Math.max(Math.round(h.y-g.y),1)}else a=d.unproject(d.project(this._latlng).subtract([this._mRadius,0])),this._point=c.latLngToLayerPoint(this._latlng),this._radius=this._point.x-c.latLngToLayerPoint(a).x;this._updateBounds()}}),ga=pa.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,b){p(this,b);this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){this._setLatLngs(a);return this.redraw()},isEmpty:function(){return!this._latlngs.length},
closestLayerPoint:function(a){for(var b=Infinity,c=null,f=Ra,d,e,g=0,h=this._parts.length;g<h;g++)for(var k=this._parts[g],l=1,m=k.length;l<m;l++){d=k[l-1];e=k[l];var u=f(a,d,e,!0);u<b&&(b=u,c=f(a,d,e))}c&&(c.distance=Math.sqrt(b));return c},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");var a,b,c,d,e,g,h=this._rings[0],k=h.length;if(!k)return null;for(b=a=0;a<k-1;a++)b+=h[a].distanceTo(h[a+1])/2;if(0===b)return this._map.layerPointToLatLng(h[0]);
for(d=a=0;a<k-1;a++)if(e=h[a],g=h[a+1],c=e.distanceTo(g),d+=c,d>b)return a=(d-b)/c,this._map.layerPointToLatLng([g.x-a*(g.x-e.x),g.y-a*(g.y-e.y)])},getBounds:function(){return this._bounds},addLatLng:function(a,b){b=b||this._defaultShape();a=F(a);b.push(a);this._bounds.extend(a);return this.redraw()},_setLatLngs:function(a){this._bounds=new H;this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return fa(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var b=
[],c=fa(a),f=0,d=a.length;f<d;f++)c?(b[f]=F(a[f]),this._bounds.extend(b[f])):b[f]=this._convertLatLngs(a[f]);return b},_project:function(){var a=new C;this._rings=[];this._projectLatlngs(this._latlngs,this._rings,a);var b=this._clickTolerance(),b=new v(b,b);this._bounds.isValid()&&a.isValid()&&(a.min._subtract(b),a.max._add(b),this._pxBounds=a)},_projectLatlngs:function(a,b,c){var f=a.length,d,e;if(a[0]instanceof y){e=[];for(d=0;d<f;d++)e[d]=this._map.latLngToLayerPoint(a[d]),c.extend(e[d]);b.push(e)}else for(d=
0;d<f;d++)this._projectLatlngs(a[d],b,c)},_clipPoints:function(){var a=this._renderer._bounds;this._parts=[];if(this._pxBounds&&this._pxBounds.intersects(a))if(this.options.noClip)this._parts=this._rings;else{var b=this._parts,c,d,e,g,h,k,l;e=c=0;for(g=this._rings.length;c<g;c++)for(l=this._rings[c],d=0,h=l.length;d<h-1;d++)if(k=Ac(l[d],l[d+1],a,d,!0))if(b[e]=b[e]||[],b[e].push(k[0]),k[1]!==l[d+1]||d===h-2)b[e].push(k[1]),e++}},_simplifyPoints:function(){for(var a=this._parts,b=this.options.smoothFactor,
c=0,d=a.length;c<d;c++)a[c]=yc(a[c],b)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(a,b){var c,f,d,e,n,g,h=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(a))return!1;c=0;for(e=this._parts.length;c<e;c++)for(g=this._parts[c],f=0,n=g.length,d=n-1;f<n;d=f++)if((b||0!==f)&&zc(a,g[d],g[f])<=h)return!0;return!1}});ga._flat=Cc;var Ba=ga.extend({options:{fill:!0},
isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");var a,b,c,d,e,g,h,k=this._rings[0],l=k.length;if(!l)return null;a=e=g=h=0;for(b=l-1;a<l;b=a++)c=k[a],b=k[b],d=c.y*b.x-b.y*c.x,g+=(c.x+b.x)*d,h+=(c.y+b.y)*d,e+=3*d;return this._map.layerPointToLatLng(0===e?k[0]:[g/e,h/e])},_convertLatLngs:function(a){a=ga.prototype._convertLatLngs.call(this,a);var b=a.length;2<=b&&a[0]instanceof y&&
a[0].equals(a[b-1])&&a.pop();return a},_setLatLngs:function(a){ga.prototype._setLatLngs.call(this,a);fa(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return fa(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,b=this.options.weight,b=new v(b,b),a=new C(a.min.subtract(b),a.max.add(b));this._parts=[];if(this._pxBounds&&this._pxBounds.intersects(a))if(this.options.noClip)this._parts=this._rings;else for(var b=0,c=this._rings.length,
d;b<c;b++)d=Dc(this._rings[b],a,!0),d.length&&this._parts.push(d)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(a){var b=!1,c,f,d,e,g,h,k;if(!this._pxBounds.contains(a))return!1;e=0;for(h=this._parts.length;e<h;e++)for(c=this._parts[e],g=0,k=c.length,d=k-1;g<k;d=g++)f=c[g],d=c[d],f.y>a.y!==d.y>a.y&&a.x<(d.x-f.x)*(a.y-f.y)/(d.y-f.y)+f.x&&(b=!b);return b||ga.prototype._containsPoint.call(this,a,!0)}}),ha=ua.extend({initialize:function(a,b){p(this,b);this._layers=
{};a&&this.addData(a)},addData:function(a){var b=aa(a)?a:a.features,c,f;if(b){a=0;for(c=b.length;a<c;a++)f=b[a],(f.geometries||f.geometry||f.features||f.coordinates)&&this.addData(f);return this}b=this.options;if(b.filter&&!b.filter(a))return this;c=Sb(a,b);if(!c)return this;c.feature=qb(a);c.defaultOptions=c.options;this.resetStyle(c);if(b.onEachFeature)b.onEachFeature(a,c);return this.addLayer(c)},resetStyle:function(a){a.options=b({},a.defaultOptions);this._setLayerStyle(a,this.options.style);
return this},setStyle:function(a){return this.eachLayer(function(b){this._setLayerStyle(b,a)},this)},_setLayerStyle:function(a,b){"function"===typeof b&&(b=b(a.feature));a.setStyle&&a.setStyle(b)}}),lc={toGeoJSON:function(a){return Ca(this,{type:"Point",coordinates:Ub(this.getLatLng(),a)})}};Sa.include(lc);kc.include(lc);tb.include(lc);ga.include({toGeoJSON:function(a){var b=!fa(this._latlngs);a=pb(this._latlngs,b?1:0,!1,a);return Ca(this,{type:(b?"Multi":"")+"LineString",coordinates:a})}});Ba.include({toGeoJSON:function(a){var b=
!fa(this._latlngs),c=b&&!fa(this._latlngs[0]);a=pb(this._latlngs,c?2:b?1:0,!0,a);b||(a=[a]);return Ca(this,{type:(c?"Multi":"")+"Polygon",coordinates:a})}});Ha.include({toMultiPoint:function(a){var b=[];this.eachLayer(function(c){b.push(c.toGeoJSON(a).geometry.coordinates)});return Ca(this,{type:"MultiPoint",coordinates:b})},toGeoJSON:function(a){var b=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===b)return this.toMultiPoint(a);var c="GeometryCollection"===b,f=[];
this.eachLayer(function(b){b.toGeoJSON&&(b=b.toGeoJSON(a),c?f.push(b.geometry):(b=qb(b),"FeatureCollection"===b.type?f.push.apply(f,b.features):f.push(b)))});return c?Ca(this,{geometries:f,type:"GeometryCollection"}):{type:"FeatureCollection",features:f}}});var mc=V.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(a,b,c){this._url=a;this._bounds=E(b);p(this,c)},onAdd:function(){this._image||(this._initImage(),1>this.options.opacity&&
this._updateOpacity());this.options.interactive&&(B(this._image,"goomap-interactive"),this.addInteractiveTarget(this._image));this.getPane().appendChild(this._image);this._reset()},onRemove:function(){J(this._image);this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){this.options.opacity=a;this._image&&this._updateOpacity();return this},setStyle:function(a){a.opacity&&this.setOpacity(a.opacity);return this},bringToFront:function(){this._map&&za(this._image);
return this},bringToBack:function(){this._map&&Aa(this._image);return this},setUrl:function(a){this._url=a;this._image&&(this._image.src=a);return this},setBounds:function(a){this._bounds=E(a);this._map&&this._reset();return this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};this._zoomAnimated&&(a.zoomanim=this._animateZoom);return a},setZIndex:function(a){this.options.zIndex=a;this._updateZIndex();return this},getBounds:function(){return this._bounds},getElement:function(){return this._image},
_initImage:function(){var a=this._image=A("img","goomap-image-layer "+(this._zoomAnimated?"goomap-zoom-animated":"")+(this.options.className||""));a.onselectstart=h;a.onmousemove=h;a.onload=c(this.fire,this,"load");a.onerror=c(this._overlayOnError,this,"error");this.options.crossOrigin&&(a.crossOrigin="");this.options.zIndex&&this._updateZIndex();a.src=this._url;a.alt=this.options.alt},_animateZoom:function(a){var b=this._map.getZoomScale(a.zoom);a=this._map._latLngBoundsToNewLayerBounds(this._bounds,
a.zoom,a.center).min;ra(this._image,a,b)},_reset:function(){var a=this._image,b=new C(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),c=b.getSize();N(a,b.min);a.style.width=c.x+"px";a.style.height=c.y+"px"},_updateOpacity:function(){T(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");
var a=this.options.errorOverlayUrl;a&&this._url!==a&&(this._url=a,this._image.src=a)}}),Wc=mc.extend({options:{autoplay:!0,loop:!0},_initImage:function(){var a="VIDEO"===this._url.tagName,b=this._image=a?this._url:A("video");b["class"]=b["class"]||"";b["class"]+="goomap-image-layer "+(this._zoomAnimated?"goomap-zoom-animated":"");b.onselectstart=h;b.onmousemove=h;b.onloadeddata=c(this.fire,this,"load");if(!a)for(aa(this._url)||(this._url=[this._url]),b.autoplay=!!this.options.autoplay,b.loop=!!this.options.loop,
a=0;a<this._url.length;a++){var d=A("source");d.src=this._url[a];b.appendChild(d)}}}),ka=V.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(a,b){p(this,a);this._source=b},onAdd:function(a){this._zoomAnimated=a._zoomAnimated;this._container||this._initLayout();a._fadeAnimated&&T(this._container,0);clearTimeout(this._removeTimeout);this.getPane().appendChild(this._container);this.update();a._fadeAnimated&&T(this._container,1);this.bringToFront()},onRemove:function(a){a._fadeAnimated?
(T(this._container,0),this._removeTimeout=setTimeout(c(J,void 0,this._container),200)):J(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(a){this._latlng=F(a);this._map&&(this._updatePosition(),this._adjustPan());return this},getContent:function(){return this._content},setContent:function(a){this._content=a;this.update();return this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),
this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};this._zoomAnimated&&(a.zoomanim=this._animateZoom);return a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){this._map&&za(this._container);return this},bringToBack:function(){this._map&&Aa(this._container);return this},_updateContent:function(){if(this._content){var a=this._contentNode,
b="function"===typeof this._content?this._content(this._source||this):this._content;if("string"===typeof b)a.innerHTML=b;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(b)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),b=w(this.options.offset),c=this._getAnchor();this._zoomAnimated?N(this._container,a.add(c)):b=b.add(a).add(c);a=this._containerBottom=-b.y;b=this._containerLeft=-Math.round(this._containerWidth/
2)+b.x;this._container.style.bottom=a+"px";this._container.style.left=b+"px"}},_getAnchor:function(){return[0,0]}}),Ja=ka.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:""},openOn:function(a){a.openPopup(this);return this},onAdd:function(a){ka.prototype.onAdd.call(this,a);a.fire("popupopen",{popup:this});if(this._source&&(this._source.fire("popupopen",
{popup:this},!0),!(this._source instanceof pa)))this._source.on("preclick",qa)},onRemove:function(a){ka.prototype.onRemove.call(this,a);a.fire("popupclose",{popup:this});this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof pa||this._source.off("preclick",qa))},getEvents:function(){var a=ka.prototype.getEvents.call(this);if(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)a.preclick=this._close;this.options.keepInView&&
(a.moveend=this._adjustPan);return a},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var a=this._container=A("div","goomap-popup "+(this.options.className||"")+" goomap-zoom-animated"),b=this._wrapper=A("div","goomap-popup-content-wrapper",a);this._contentNode=A("div","goomap-popup-content",b);Pa(b);Fb(this._contentNode);x(b,"contextmenu",qa);this._tipContainer=A("div","goomap-popup-tip-container",a);this._tip=A("div","goomap-popup-tip",this._tipContainer);this.options.closeButton&&
(a=this._closeButton=A("a","goomap-popup-close-button",a),a.href="#close",a.innerHTML="&#215;",x(a,"click",this._onCloseButtonClick,this))},_updateLayout:function(){var a=this._contentNode,b=a.style;b.width="";b.whiteSpace="nowrap";var c=a.offsetWidth,c=Math.min(c,this.options.maxWidth),c=Math.max(c,this.options.minWidth);b.width=c+1+"px";b.whiteSpace="";b.height="";var c=a.offsetHeight,d=this.options.maxHeight;d&&c>d?(b.height=d+"px",B(a,"goomap-popup-scrolled")):K(a,"goomap-popup-scrolled");this._containerWidth=
this._container.offsetWidth},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);var b=this._getAnchor();N(this._container,a.add(b))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var a=this._map,b=parseInt(Qa(this._container,"marginBottom"),10)||0,b=this._container.offsetHeight+b,c=this._containerWidth,d=new v(this._containerLeft,-b-this._containerBottom);d._add(sa(this._container));var d=a.layerPointToContainerPoint(d),
e=w(this.options.autoPanPadding),g=w(this.options.autoPanPaddingTopLeft||e),e=w(this.options.autoPanPaddingBottomRight||e),h=a.getSize(),k=0,l=0;d.x+c+e.x>h.x&&(k=d.x+c-h.x+e.x);0>d.x-k-g.x&&(k=d.x-g.x);d.y+b+e.y>h.y&&(l=d.y+b-h.y+e.y);0>d.y-l-g.y&&(l=d.y-g.y);(k||l)&&a.fire("autopanstart").panBy([k,l])}},_onCloseButtonClick:function(a){this._close();ca(a)},_getAnchor:function(){return w(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});z.mergeOptions({closePopupOnClick:!0});
z.include({openPopup:function(a,b,c){a instanceof Ja||(a=(new Ja(c)).setContent(a));b&&a.setLatLng(b);if(this.hasLayer(a))return this;this._popup&&this._popup.options.autoClose&&this.closePopup();this._popup=a;return this.addLayer(a)},closePopup:function(a){a&&a!==this._popup||(a=this._popup,this._popup=null);a&&this.removeLayer(a);return this}});V.include({bindPopup:function(a,b){if(a instanceof Ja)p(a,b),this._popup=a,a._source=this;else{if(!this._popup||b)this._popup=new Ja(b,this);this._popup.setContent(a)}this._popupHandlersAdded||
(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0);return this},unbindPopup:function(){this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null);return this},openPopup:function(a,b){a instanceof V||(b=a,a=this);if(a instanceof ua)for(var c in this._layers){a=this._layers[c];break}b||(b=a.getCenter?a.getCenter():
a.getLatLng());this._popup&&this._map&&(this._popup._source=a,this._popup.update(),this._map.openPopup(this._popup,b));return this},closePopup:function(){this._popup&&this._popup._close();return this},togglePopup:function(a){this._popup&&(this._popup._map?this.closePopup():this.openPopup(a));return this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){this._popup&&this._popup.setContent(a);return this},getPopup:function(){return this._popup},_openPopup:function(a){var b=
a.layer||a.target;this._popup&&this._map&&(ca(a),b instanceof pa?this.openPopup(a.layer||a.target,a.latlng):this._map.hasLayer(this._popup)&&this._popup._source===b?this.closePopup():this.openPopup(b,a.latlng))},_movePopup:function(a){this._popup.setLatLng(a.latlng)},_onKeyPress:function(a){13===a.originalEvent.keyCode&&this._openPopup(a)}});var Ka=ka.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(a){ka.prototype.onAdd.call(this,
a);this.setOpacity(this.options.opacity);a.fire("tooltipopen",{tooltip:this});this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(a){ka.prototype.onRemove.call(this,a);a.fire("tooltipclose",{tooltip:this});this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var a=ka.prototype.getEvents.call(this);Y&&!this.options.permanent&&(a.preclick=this._close);return a},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){this._contentNode=
this._container=A("div","goomap-tooltip "+(this.options.className||"")+" goomap-zoom-"+(this._zoomAnimated?"animated":"hide"))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var b=this._map,c=this._container,f=b.latLngToContainerPoint(b.getCenter()),b=b.layerPointToContainerPoint(a),d=this.options.direction,e=c.offsetWidth,g=c.offsetHeight,h=w(this.options.offset),k=this._getAnchor();"top"===d?a=a.add(w(-e/2+h.x,-g+h.y+k.y,!0)):"bottom"===d?a=a.subtract(w(e/2-h.x,-h.y,
!0)):"center"===d?a=a.subtract(w(e/2+h.x,g/2-k.y+h.y,!0)):"right"===d||"auto"===d&&b.x<f.x?(d="right",a=a.add(w(h.x+k.x,k.y-g/2+h.y,!0))):(d="left",a=a.subtract(w(e+k.x-h.x,g/2-k.y-h.y,!0)));K(c,"goomap-tooltip-right");K(c,"goomap-tooltip-left");K(c,"goomap-tooltip-top");K(c,"goomap-tooltip-bottom");B(c,"goomap-tooltip-"+d);N(c,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a;this._container&&T(this._container,
a)},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(a)},_getAnchor:function(){return w(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});z.include({openTooltip:function(a,b,c){a instanceof Ka||(a=(new Ka(c)).setContent(a));b&&a.setLatLng(b);return this.hasLayer(a)?this:this.addLayer(a)},closeTooltip:function(a){a&&this.removeLayer(a);return this}});V.include({bindTooltip:function(a,
b){if(a instanceof Ka)p(a,b),this._tooltip=a,a._source=this;else{if(!this._tooltip||b)this._tooltip=new Ka(b,this);this._tooltip.setContent(a)}this._initTooltipInteractions();this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip();return this},unbindTooltip:function(){this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null);return this},_initTooltipInteractions:function(a){if(a||!this._tooltipHandlersAdded){var b={remove:this.closeTooltip,
move:this._moveTooltip};this._tooltip.options.permanent?b.add=this._openTooltip:(b.mouseover=this._openTooltip,b.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(b.mousemove=this._moveTooltip),Y&&(b.click=this._openTooltip));this[a?"off":"on"](b);this._tooltipHandlersAdded=!a}},openTooltip:function(a,b){a instanceof V||(b=a,a=this);if(a instanceof ua)for(var c in this._layers){a=this._layers[c];break}b||(b=a.getCenter?a.getCenter():a.getLatLng());this._tooltip&&this._map&&(this._tooltip._source=
a,this._tooltip.update(),this._map.openTooltip(this._tooltip,b),this._tooltip.options.interactive&&this._tooltip._container&&(B(this._tooltip._container,"goomap-clickable"),this.addInteractiveTarget(this._tooltip._container)));return this},closeTooltip:function(){this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(K(this._tooltip._container,"goomap-clickable"),this.removeInteractiveTarget(this._tooltip._container)));return this},toggleTooltip:function(a){this._tooltip&&
(this._tooltip._map?this.closeTooltip():this.openTooltip(a));return this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){this._tooltip&&this._tooltip.setContent(a);return this},getTooltip:function(){return this._tooltip},_openTooltip:function(a){this._tooltip&&this._map&&this.openTooltip(a.layer||a.target,this._tooltip.options.sticky?a.latlng:void 0)},_moveTooltip:function(a){var b=a.latlng;this._tooltip.options.sticky&&a.originalEvent&&(a=this._map.mouseEventToContainerPoint(a.originalEvent),
a=this._map.containerPointToLayerPoint(a),b=this._map.layerPointToLatLng(a));this._tooltip.setLatLng(b)}});var Xc=Ia.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"goomap-div-icon"},createIcon:function(a){a=a&&"DIV"===a.tagName?a:document.createElement("div");var b=this.options;a.innerHTML=!1!==b.html?b.html:"";b.bgPos&&(b=w(b.bgPos),a.style.backgroundPosition=-b.x+"px "+-b.y+"px");this._setIconStyles(a,"icon");return a},createShadow:function(){return null}});Ia.Default=$a;var nc=
V.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ga,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){p(this,a)},onAdd:function(){this._initContainer();this._levels={};this._tiles={};this._resetView();this._update()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles();J(this._container);a._removeZoomLimit(this);
this._tileZoom=this._container=null},bringToFront:function(){this._map&&(za(this._container),this._setAutoZIndex(Math.max));return this},bringToBack:function(){this._map&&(Aa(this._container),this._setAutoZIndex(Math.min));return this},getContainer:function(){return this._container},setOpacity:function(a){this.options.opacity=a;this._updateOpacity();return this},setZIndex:function(a){this.options.zIndex=a;this._updateZIndex();return this},isLoading:function(){return this._loading},redraw:function(){this._map&&
(this._removeAllTiles(),this._update());return this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};this.options.updateWhenIdle||(this._onMove||(this._onMove=e(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove);this._zoomAnimated&&(a.zoomanim=this._animateZoom);return a},createTile:function(){return document.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof
v?a:new v(a,a)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var b=this.getPane().children,c=-a(-Infinity,Infinity),d=0,f=b.length,e;d<f;d++)e=b[d].style.zIndex,b[d]!==this._container&&e&&(c=a(c,+e));isFinite(c)&&(this.options.zIndex=c+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Fa){T(this._container,this.options.opacity);var a=+new Date,
b=!1,c=!1,d;for(d in this._tiles){var e=this._tiles[d];if(e.current&&e.loaded){var g=Math.min(1,(a-e.loaded)/200);T(e.el,g);1>g?b=!0:(e.active?c=!0:this._onOpaqueTile(e),e.active=!0)}}c&&!this._noPrune&&this._pruneTiles();b&&(P(this._fadeFrame),this._fadeFrame=I(this._updateOpacity,this))}},_onOpaqueTile:h,_initContainer:function(){this._container||(this._container=A("div","goomap-layer "+(this.options.className||"")),this._updateZIndex(),1>this.options.opacity&&this._updateOpacity(),this.getPane().appendChild(this._container))},
_updateLevels:function(){var a=this._tileZoom,b=this.options.maxZoom;if(void 0!==a){for(var c in this._levels)this._levels[c].el.children.length||c===a?(this._levels[c].el.style.zIndex=b-Math.abs(a-c),this._onUpdateLevel(c)):(J(this._levels[c].el),this._removeTilesAtZoom(c),this._onRemoveLevel(c),delete this._levels[c]);c=this._levels[a];var d=this._map;c||(c=this._levels[a]={},c.el=A("div","goomap-tile-container goomap-zoom-animated",this._container),c.el.style.zIndex=b,c.origin=d.project(d.unproject(d.getPixelOrigin()),
a).round(),c.zoom=a,this._setZoomTransform(c,d.getCenter(),d.getZoom()),this._onCreateLevel(c));return this._level=c}},_onUpdateLevel:h,_onRemoveLevel:h,_onCreateLevel:h,_pruneTiles:function(){if(this._map){var a,b;b=this._map.getZoom();if(b>this.options.maxZoom||b<this.options.minZoom)this._removeAllTiles();else{for(a in this._tiles)b=this._tiles[a],b.retain=b.current;for(a in this._tiles)b=this._tiles[a],b.current&&!b.active&&(b=b.coords,this._retainParent(b.x,b.y,b.z,b.z-5)||this._retainChildren(b.x,
b.y,b.z,b.z+2));for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}}},_removeTilesAtZoom:function(a){for(var b in this._tiles)this._tiles[b].coords.z===a&&this._removeTile(b)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)J(this._levels[a].el),this._onRemoveLevel(a),delete this._levels[a];this._removeAllTiles();this._tileZoom=null},_retainParent:function(a,b,c,d){a=Math.floor(a/2);b=Math.floor(b/2);--c;var f=
new v(+a,+b);f.z=+c;f=this._tileCoordsToKey(f);if((f=this._tiles[f])&&f.active)return f.retain=!0;f&&f.loaded&&(f.retain=!0);return c>d?this._retainParent(a,b,c,d):!1},_retainChildren:function(a,b,c,d){for(var f=2*a;f<2*a+2;f++)for(var e=2*b;e<2*b+2;e++){var g=new v(f,e);g.z=c+1;g=this._tileCoordsToKey(g);(g=this._tiles[g])&&g.active?g.retain=!0:(g&&g.loaded&&(g.retain=!0),c+1<d&&this._retainChildren(f,e,c+1,d))}},_resetView:function(a){a=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),
this._map.getZoom(),a,a)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_clampZoom:function(a){var b=this.options;return void 0!==b.minNativeZoom&&a<b.minNativeZoom?b.minNativeZoom:void 0!==b.maxNativeZoom&&b.maxNativeZoom<a?b.maxNativeZoom:a},_setView:function(a,b,c,d){var f=this._clampZoom(Math.round(b));if(void 0!==this.options.maxZoom&&f>this.options.maxZoom||void 0!==this.options.minZoom&&f<this.options.minZoom)f=void 0;var e=this.options.updateWhenZooming&&f!==this._tileZoom;
if(!d||e)this._tileZoom=f,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==f&&this._update(a),c||this._pruneTiles(),this._noPrune=!!c;this._setZoomTransforms(a,b)},_setZoomTransforms:function(a,b){for(var c in this._levels)this._setZoomTransform(this._levels[c],a,b)},_setZoomTransform:function(a,b,c){var d=this._map.getZoomScale(c,a.zoom);b=a.origin.multiplyBy(d).subtract(this._map._getNewPixelOrigin(b,c)).round();U?ra(a.el,b,d):N(a.el,b)},_resetGrid:function(){var a=
this._map,b=a.options.crs,c=this._tileSize=this.getTileSize(),d=this._tileZoom,e=this._map.getPixelWorldBounds(this._tileZoom);e&&(this._globalTileRange=this._pxBoundsToTileRange(e));this._wrapX=b.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,b.wrapLng[0]],d).x/c.x),Math.ceil(a.project([0,b.wrapLng[1]],d).x/c.y)];this._wrapY=b.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([b.wrapLat[0],0],d).y/c.x),Math.ceil(a.project([b.wrapLat[1],0],d).y/c.y)]},_onMoveEnd:function(){this._map&&
!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(a){var b=this._map,c=b._animatingZoom?Math.max(b._animateToZoom,b.getZoom()):b.getZoom(),c=b.getZoomScale(c,this._tileZoom);a=b.project(a,this._tileZoom).floor();b=b.getSize().divideBy(2*c);return new C(a.subtract(b),a.add(b))},_update:function(a){var b=this._map;if(b){var c=this._clampZoom(b.getZoom());void 0===a&&(a=b.getCenter());if(void 0!==this._tileZoom){var b=this._getTiledPixelBounds(a),d=this._pxBoundsToTileRange(b),
f=d.getCenter(),b=[],e=this.options.keepBuffer,e=new C(d.getBottomLeft().subtract([e,-e]),d.getTopRight().add([e,-e]));if(!(isFinite(d.min.x)&&isFinite(d.min.y)&&isFinite(d.max.x)&&isFinite(d.max.y)))throw Error("Attempted to load an infinite number of tiles");for(var g in this._tiles){var h=this._tiles[g].coords;h.z===this._tileZoom&&e.contains(new v(h.x,h.y))||(this._tiles[g].current=!1)}if(1<Math.abs(c-this._tileZoom))this._setView(a,c);else{for(c=d.min.y;c<=d.max.y;c++)for(a=d.min.x;a<=d.max.x;a++)g=
new v(a,c),g.z=this._tileZoom,this._isValidTile(g)&&(this._tiles[this._tileCoordsToKey(g)]||b.push(g));b.sort(function(a,b){return a.distanceTo(f)-b.distanceTo(f)});if(0!==b.length){this._loading||(this._loading=!0,this.fire("loading"));d=document.createDocumentFragment();for(a=0;a<b.length;a++)this._addTile(b[a],d);this._level.el.appendChild(d)}}}}},_isValidTile:function(a){var b=this._map.options.crs;if(!b.infinite){var c=this._globalTileRange;if(!b.wrapLng&&(a.x<c.min.x||a.x>c.max.x)||!b.wrapLat&&
(a.y<c.min.y||a.y>c.max.y))return!1}if(!this.options.bounds)return!0;a=this._tileCoordsToBounds(a);return E(this.options.bounds).overlaps(a)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToBounds:function(a){var b=this._map,c=this.getTileSize(),d=a.scaleBy(c),c=d.add(c),d=b.unproject(d,a.z);a=b.unproject(c,a.z);a=new H(d,a);this.options.noWrap||b.wrapLatLngBounds(a);return a},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){a=
a.split(":");var b=new v(+a[0],+a[1]);b.z=+a[2];return b},_removeTile:function(a){var b=this._tiles[a];b&&(J(b.el),delete this._tiles[a],this.fire("tileunload",{tile:b.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){B(a,"goomap-tile");var b=this.getTileSize();a.style.width=b.x+"px";a.style.height=b.y+"px";a.onselectstart=h;a.onmousemove=h;Fa&&1>this.options.opacity&&T(a,this.options.opacity);Oa&&!Ua&&(a.style.WebkitBackfaceVisibility="hidden")},_addTile:function(a,b){var d=this._getTilePos(a),
f=this._tileCoordsToKey(a),e=this.createTile(this._wrapCoords(a),c(this._tileReady,this,a));this._initTile(e);2>this.createTile.length&&I(c(this._tileReady,this,a,null,e));N(e,d);this._tiles[f]={el:e,coords:a,current:!0};b.appendChild(e);this.fire("tileloadstart",{tile:e,coords:a})},_tileReady:function(a,b,d){this._map&&(b&&this.fire("tileerror",{error:b,tile:d,coords:a}),d=this._tileCoordsToKey(a),d=this._tiles[d])&&(d.loaded=+new Date,this._map._fadeAnimated?(T(d.el,0),P(this._fadeFrame),this._fadeFrame=
I(this._updateOpacity,this)):(d.active=!0,this._pruneTiles()),b||(B(d.el,"goomap-tile-loaded"),this.fire("tileload",{tile:d.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Fa||!this._map._fadeAnimated?I(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var b=new v(this._wrapX?g(a.x,this._wrapX):a.x,this._wrapY?g(a.y,this._wrapY):a.y);b.z=a.z;
return b},_pxBoundsToTileRange:function(a){var b=this.getTileSize();return new C(a.min.unscaleBy(b).floor(),a.max.unscaleBy(b).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}}),Da=nc.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(a,b){this._url=a;b=p(this,b);b.detectRetina&&oa&&0<b.maxZoom&&(b.tileSize=Math.floor(b.tileSize/
2),b.zoomReverse?(b.zoomOffset--,b.minZoom++):(b.zoomOffset++,b.maxZoom--),b.minZoom=Math.max(0,b.minZoom));"string"===typeof b.subdomains&&(b.subdomains=b.subdomains.split(""));if(!Oa)this.on("tileunload",this._onTileRemove)},setUrl:function(a,b){this._url=a;b||this.redraw();return this},createTile:function(a,b){var d=document.createElement("img");x(d,"load",c(this._tileOnLoad,this,b,d));x(d,"error",c(this._tileOnError,this,b,d));this.options.crossOrigin&&(d.crossOrigin="");d.alt="";d.setAttribute("role",
"presentation");d.src=this.getTileUrl(a);return d},getTileUrl:function(a){var c={r:oa?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};this._map&&!this._map.options.crs.infinite&&(a=this._globalTileRange.max.y-a.y,this.options.tms&&(c.y=a),c["-y"]=a);return r(this._url,b(c,this.options))},_tileOnLoad:function(a,b){Fa?setTimeout(c(a,this,null,b),0):a(null,b)},_tileOnError:function(a,b,c){var d=this.options.errorTileUrl;d&&b.src!==d&&(b.src=d);a(c,b)},_onTileRemove:function(a){a.tile.onload=
null},_getZoomForUrl:function(){var a=this._tileZoom,b=this.options.maxZoom,c=this.options.zoomOffset;this.options.zoomReverse&&(a=b-a);return a+c},_getSubdomain:function(a){return this.options.subdomains[Math.abs(a.x+a.y)%this.options.subdomains.length]},_abortLoading:function(){var a,b;for(a in this._tiles)this._tiles[a].coords.z!==this._tileZoom&&(b=this._tiles[a].el,b.onload=h,b.onerror=h,b.complete||(b.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",J(b)))}}),Yc=Da.extend({defaultWmsParams:{service:"WMS",
request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,c){this._url=a;var d=b({},this.defaultWmsParams),f;for(f in c)f in this.options||(d[f]=c[f]);c=p(this,c);d.width=d.height=c.tileSize*(c.detectRetina&&oa?2:1);this.wmsParams=d},onAdd:function(a){this._crs=this.options.crs||a.options.crs;this._wmsVersion=parseFloat(this.wmsParams.version);this.wmsParams[1.3<=this._wmsVersion?"crs":"srs"]=this._crs.code;Da.prototype.onAdd.call(this,
a)},getTileUrl:function(a){var b=this._tileCoordsToBounds(a),c=this._crs.project(b.getNorthWest()),b=this._crs.project(b.getSouthEast()),c=(1.3<=this._wmsVersion&&this._crs===Uc?[b.y,c.x,c.y,b.x]:[c.x,b.y,b.x,c.y]).join(",");a=Da.prototype.getTileUrl.call(this,a);return a+q(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+c},setParams:function(a,c){b(this.wmsParams,a);c||this.redraw();return this}});Da.WMS=Yc;Fc.wms=function(a,b){return new Yc(a,b)};var da=V.extend({options:{padding:.1},
initialize:function(a){p(this,a);d(this);this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&B(this._container,"goomap-zoom-animated"));this.getPane().appendChild(this._container);this._update();this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this);this._destroyContainer()},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};this._zoomAnimated&&
(a.zoomanim=this._onAnimZoom);return a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,b){var c=this._map.getZoomScale(b,this._zoom),d=sa(this._container),f=this._map.getSize().multiplyBy(.5+this.options.padding),e=this._map.project(this._center,b),e=this._map.project(a,b).subtract(e),d=f.multiplyBy(-c).add(d).add(f).subtract(e);U?ra(this._container,d,c):N(this._container,
d)},_reset:function(){this._update();this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,b=this._map.getSize(),c=this._map.containerPointToLayerPoint(b.multiplyBy(-a)).round();this._bounds=new C(c,c.add(b.multiplyBy(1+2*a)).round());this._center=this._map.getCenter();
this._zoom=this._map.getZoom()}}),Wb=da.extend({getEvents:function(){var a=da.prototype.getEvents.call(this);a.viewprereset=this._onViewPreReset;return a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){da.prototype.onAdd.call(this);this._draw()},_initContainer:function(){var a=this._container=document.createElement("canvas");x(a,"mousemove",e(this._onMouseMove,32,this),this);x(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this);x(a,"mouseout",this._handleMouseOut,
this);this._ctx=a.getContext("2d")},_destroyContainer:function(){delete this._ctx;J(this._container);L(this._container);delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var b in this._layers)a=this._layers[b],a._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={};da.prototype._update.call(this);var a=this._bounds,b=this._container,c=a.getSize(),d=oa?2:1;N(b,a.min);b.width=d*c.x;
b.height=d*c.y;b.style.width=c.x+"px";b.style.height=c.y+"px";oa&&this._ctx.scale(2,2);this._ctx.translate(-a.min.x,-a.min.y);this.fire("update")}},_reset:function(){da.prototype._reset.call(this);this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a);this._layers[d(a)]=a;a=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=a);this._drawLast=a;this._drawFirst=this._drawFirst||this._drawLast},
_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var b=a._order,c=b.next,b=b.prev;c?c.prev=b:this._drawLast=b;b?b.next=c:this._drawFirst=c;delete a._order;delete this._layers[G.stamp(a)];this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a);a._project();a._update();this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a);this._requestRedraw(a)},_updateDashArray:function(a){if(a.options.dashArray){var b=a.options.dashArray.split(","),c=[],
d;for(d=0;d<b.length;d++)c.push(Number(b[d]));a.options._dashArray=c}},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||I(this._redraw,this))},_extendRedrawBounds:function(a){if(a._pxBounds){var b=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new C;this._redrawBounds.extend(a._pxBounds.min.subtract([b,b]));this._redrawBounds.extend(a._pxBounds.max.add([b,b]))}},_redraw:function(){this._redrawRequest=null;this._redrawBounds&&
(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil());this._clear();this._draw();this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var b=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,b.x,b.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var a,b=this._redrawBounds;this._ctx.save();b&&(a=b.getSize(),this._ctx.beginPath(),this._ctx.rect(b.min.x,b.min.y,a.x,a.y),this._ctx.clip());this._drawing=!0;for(var c=this._drawFirst;c;c=
c.next)a=c.layer,(!b||a._pxBounds&&a._pxBounds.intersects(b))&&a._updatePath();this._drawing=!1;this._ctx.restore()},_updatePoly:function(a,b){if(this._drawing){var c,d,f,e,g=a._parts,h=g.length,k=this._ctx;if(h){this._drawnLayers[a._goomap_id]=a;k.beginPath();for(c=0;c<h;c++){d=0;for(f=g[c].length;d<f;d++)e=g[c][d],k[d?"lineTo":"moveTo"](e.x,e.y);b&&k.closePath()}this._fillStroke(k,a)}}},_updateCircle:function(a){if(this._drawing&&!a._empty()){var b=a._point,c=this._ctx,d=a._radius,f=(a._radiusY||
d)/d;this._drawnLayers[a._goomap_id]=a;1!==f&&(c.save(),c.scale(1,f));c.beginPath();c.arc(b.x,b.y/f,d,0,2*Math.PI,!1);1!==f&&c.restore();this._fillStroke(c,a)}},_fillStroke:function(a,b){var c=b.options;c.fill&&(a.globalAlpha=c.fillOpacity,a.fillStyle=c.fillColor||c.color,a.fill(c.fillRule||"evenodd"));c.stroke&&0!==c.weight&&(a.setLineDash&&a.setLineDash(b.options&&b.options._dashArray||[]),a.globalAlpha=c.opacity,a.lineWidth=c.weight,a.strokeStyle=c.color,a.lineCap=c.lineCap,a.lineJoin=c.lineJoin,
a.stroke())},_onClick:function(a){for(var b=this._map.mouseEventToLayerPoint(a),c,d,f=this._drawFirst;f;f=f.next)c=f.layer,c.options.interactive&&c._containsPoint(b)&&!this._map._draggableMoved(c)&&(d=c);d&&(Gb(a),this._fireEvent([d],a))},_onMouseMove:function(a){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var b=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,b)}},_handleMouseOut:function(a){var b=this._hoveredLayer;b&&(K(this._container,"goomap-interactive"),
this._fireEvent([b],a,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(a,b){for(var c,d,f=this._drawFirst;f;f=f.next)c=f.layer,c.options.interactive&&c._containsPoint(b)&&(d=c);d!==this._hoveredLayer&&(this._handleMouseOut(a),d&&(B(this._container,"goomap-interactive"),this._fireEvent([d],a,"mouseover"),this._hoveredLayer=d));this._hoveredLayer&&this._fireEvent([this._hoveredLayer],a)},_fireEvent:function(a,b,c){this._map._fireDOMEvent(b,c||b.type,a)},_bringToFront:function(a){var b=
a._order,c=b.next,d=b.prev;c&&((c.prev=d)?d.next=c:c&&(this._drawFirst=c),b.prev=this._drawLast,this._drawLast.next=b,b.next=null,this._drawLast=b,this._requestRedraw(a))},_bringToBack:function(a){var b=a._order,c=b.next,d=b.prev;d&&((d.next=c)?c.prev=d:d&&(this._drawLast=d),b.prev=null,b.next=this._drawFirst,this._drawFirst=this._drawFirst.prev=b,this._requestRedraw(a))}}),ab=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+
a+' class="lvml">')}}catch(f){return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),Cd={_initContainer:function(){this._container=A("div","goomap-vml-container")},_update:function(){this._map._animatingZoom||(da.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var b=a._container=ab("shape");B(b,"goomap-vml-shape "+(this.options.className||""));b.coordsize="1 1";a._path=ab("path");b.appendChild(a._path);this._updateStyle(a);
this._layers[d(a)]=a},_addPath:function(a){var b=a._container;this._container.appendChild(b);a.options.interactive&&a.addInteractiveTarget(b)},_removePath:function(a){var b=a._container;J(b);a.removeInteractiveTarget(b);delete this._layers[d(a)]},_updateStyle:function(a){var b=a._stroke,c=a._fill,d=a.options,f=a._container;f.stroked=!!d.stroke;f.filled=!!d.fill;d.stroke?(b||(b=a._stroke=ab("stroke")),f.appendChild(b),b.weight=d.weight+"px",b.color=d.color,b.opacity=d.opacity,b.dashStyle=d.dashArray?
aa(d.dashArray)?d.dashArray.join(" "):d.dashArray.replace(/( *, *)/g," "):"",b.endcap=d.lineCap.replace("butt","flat"),b.joinstyle=d.lineJoin):b&&(f.removeChild(b),a._stroke=null);d.fill?(c||(c=a._fill=ab("fill")),f.appendChild(c),c.color=d.fillColor||d.color,c.opacity=d.fillOpacity):c&&(f.removeChild(c),a._fill=null)},_updateCircle:function(a){var b=a._point.round(),c=Math.round(a._radius),d=Math.round(a._radiusY||c);this._setPath(a,a._empty()?"M0 0":"AL "+b.x+","+b.y+" "+c+","+d+" 0,23592600")},
_setPath:function(a,b){a._path.v=b},_bringToFront:function(a){za(a._container)},_bringToBack:function(a){Aa(a._container)}},ub=rb?ab:La,Ea=da.extend({getEvents:function(){var a=da.prototype.getEvents.call(this);a.zoomstart=this._onZoomStart;return a},_initContainer:function(){this._container=ub("svg");this._container.setAttribute("pointer-events","none");this._rootGroup=ub("g");this._container.appendChild(this._rootGroup)},_destroyContainer:function(){J(this._container);L(this._container);delete this._container;
delete this._rootGroup},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){da.prototype._update.call(this);var a=this._bounds,b=a.getSize(),c=this._container;this._svgSize&&this._svgSize.equals(b)||(this._svgSize=b,c.setAttribute("width",b.x),c.setAttribute("height",b.y));N(c,a.min);c.setAttribute("viewBox",[a.min.x,a.min.y,b.x,b.y].join(" "));this.fire("update")}},_initPath:function(a){var b=a._path=ub("path");a.options.className&&B(b,a.options.className);
a.options.interactive&&B(b,"goomap-interactive");this._updateStyle(a);this._layers[d(a)]=a},_addPath:function(a){this._rootGroup||this._initContainer();this._rootGroup.appendChild(a._path);a.addInteractiveTarget(a._path)},_removePath:function(a){J(a._path);a.removeInteractiveTarget(a._path);delete this._layers[d(a)]},_updatePath:function(a){a._project();a._update()},_updateStyle:function(a){var b=a._path;a=a.options;b&&(a.stroke?(b.setAttribute("stroke",a.color),b.setAttribute("stroke-opacity",a.opacity),
b.setAttribute("stroke-width",a.weight),b.setAttribute("stroke-linecap",a.lineCap),b.setAttribute("stroke-linejoin",a.lineJoin),a.dashArray?b.setAttribute("stroke-dasharray",a.dashArray):b.removeAttribute("stroke-dasharray"),a.dashOffset?b.setAttribute("stroke-dashoffset",a.dashOffset):b.removeAttribute("stroke-dashoffset")):b.setAttribute("stroke","none"),a.fill?(b.setAttribute("fill",a.fillColor||a.color),b.setAttribute("fill-opacity",a.fillOpacity),b.setAttribute("fill-rule",a.fillRule||"evenodd")):
b.setAttribute("fill","none"))},_updatePoly:function(a,b){this._setPath(a,xa(a._parts,b))},_updateCircle:function(a){var b=a._point,c=a._radius,d="a"+c+","+(a._radiusY||c)+" 0 1,0 ",b=a._empty()?"M0 0":"M"+(b.x-c)+","+b.y+d+2*c+",0 "+d+2*-c+",0 ";this._setPath(a,b)},_setPath:function(a,b){a._path.setAttribute("d",b)},_bringToFront:function(a){za(a._path)},_bringToBack:function(a){Aa(a._path)}});rb&&Ea.include(Cd);z.include({getRenderer:function(a){a=a.options.renderer||this._getPaneRenderer(a.options.pane)||
this.options.renderer||this._renderer;a||(a=this._renderer=this.options.preferCanvas&&Vb()||Xb());this.hasLayer(a)||this.addLayer(a);return a},_getPaneRenderer:function(a){if("overlayPane"===a||void 0===a)return!1;var b=this._paneRenderers[a];void 0===b&&(b=Ea&&Xb({pane:a})||Wb&&Vb({pane:a}),this._paneRenderers[a]=b);return b}});var Zc=Ba.extend({initialize:function(a,b){Ba.prototype.initialize.call(this,this._boundsToLatLngs(a),b)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},
_boundsToLatLngs:function(a){a=E(a);return[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});Ea.create=ub;Ea.pointsToPath=xa;ha.geometryToLayer=Sb;ha.coordsToLatLng=Tb;ha.coordsToLatLngs=ob;ha.latLngToCoords=Ub;ha.latLngsToCoords=pb;ha.getFeature=Ca;ha.asFeature=qb;z.mergeOptions({boxZoom:!0});var $c=ja.extend({initialize:function(a){this._map=a;this._container=a._container;this._pane=a._panes.overlayPane;this._resetStateTimeout=0;a.on("unload",this._destroy,this)},addHooks:function(){x(this._container,
"mousedown",this._onMouseDown,this)},removeHooks:function(){L(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){J(this._pane);delete this._pane},_resetState:function(){this._resetStateTimeout=0;this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(a){if(!a.shiftKey||1!==a.which&&1!==a.button)return!1;this._clearDeferredResetState();
this._resetState();Wa();Nb();this._startPoint=this._map.mouseEventToContainerPoint(a);x(document,{contextmenu:ca,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=A("div","goomap-zoom-box",this._container),B(this._container,"goomap-crosshair"),this._map.fire("boxzoomstart"));this._point=this._map.mouseEventToContainerPoint(a);a=new C(this._point,this._startPoint);var b=a.getSize();N(this._box,a.min);
this._box.style.width=b.x+"px";this._box.style.height=b.y+"px"},_finish:function(){this._moved&&(J(this._box),K(this._container,"goomap-crosshair"));Xa();Ob();L(document,{contextmenu:ca,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if(1===a.which||1===a.button)this._finish(),this._moved&&(this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0),a=new H(this._map.containerPointToLatLng(this._startPoint),
this._map.containerPointToLatLng(this._point)),this._map.fitBounds(a).fire("boxzoomend",{boxZoomBounds:a}))},_onKeyDown:function(a){27===a.keyCode&&this._finish()}});z.addInitHook("addHandler","boxZoom",$c);z.mergeOptions({doubleClickZoom:!0});var ad=ja.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var b=this._map,c=b.getZoom(),d=b.options.zoomDelta,c=a.originalEvent.shiftKey?
c-d:c+d;"center"===b.options.doubleClickZoom?b.setZoom(c):b.setZoomAround(a.containerPoint,c)}});z.addInitHook("addHandler","doubleClickZoom",ad);z.mergeOptions({dragging:!0,inertia:!Ua,inertiaDeceleration:3400,inertiaMaxSpeed:Infinity,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var bd=ja.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new va(a._mapPane,a._container);this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},
this);this._draggable.on("predrag",this._onPreDragLimit,this);a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}B(this._map._container,"goomap-grab goomap-touch-drag");this._draggable.enable();this._positions=[];this._times=[]},removeHooks:function(){K(this._map._container,"goomap-grab");K(this._map._container,"goomap-touch-drag");this._draggable.disable()},moved:function(){return this._draggable&&
this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var a=this._map;a._stop();if(this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var b=E(this._map.options.maxBounds);this._offsetLimit=O(this._map.latLngToContainerPoint(b.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(b.getSouthEast()).multiplyBy(-1).add(this._map.getSize()));this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=
null;a.fire("movestart").fire("dragstart");a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var b=this._lastTime=+new Date,c=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(c);this._times.push(b);50<b-this._times[0]&&(this._positions.shift(),this._times.shift())}this._map.fire("move",a).fire("drag",a)},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2);this._initialWorldOffset=this._map.latLngToLayerPoint([0,
0]).subtract(a).x;this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,b){return a-(a-b)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var a=this._draggable._newPos.subtract(this._draggable._startPos),b=this._offsetLimit;a.x<b.min.x&&(a.x=this._viscousLimit(a.x,b.min.x));a.y<b.min.y&&(a.y=this._viscousLimit(a.y,b.min.y));a.x>b.max.x&&(a.x=this._viscousLimit(a.x,b.max.x));a.y>b.max.y&&(a.y=this._viscousLimit(a.y,b.max.y));this._draggable._newPos=
this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,b=Math.round(a/2),c=this._initialWorldOffset,d=this._draggable._newPos.x,e=(d-b+c)%a+b-c,a=(d+b+c)%a-b-c,c=Math.abs(e+c)<Math.abs(a+c)?e:a;this._draggable._absPos=this._draggable._newPos.clone();this._draggable._newPos.x=c},_onDragEnd:function(a){var b=this._map,c=b.options,d=!c.inertia||2>this._times.length;b.fire("dragend",a);if(d)b.fire("moveend");else{a=this._lastPos.subtract(this._positions[0]);var e=c.easeLinearity,
d=a.multiplyBy(e/((this._lastTime-this._times[0])/1E3)),f=d.distanceTo([0,0]);a=Math.min(c.inertiaMaxSpeed,f);var d=d.multiplyBy(a/f),g=a/(c.inertiaDeceleration*e),h=d.multiplyBy(-g/2).round();h.x||h.y?(h=b._limitOffset(h,b.options.maxBounds),I(function(){b.panBy(h,{duration:g,easeLinearity:e,noMoveStart:!0,animate:!0})})):b.fire("moveend")}}});z.addInitHook("addHandler","dragging",bd);z.mergeOptions({keyboard:!0,keyboardPanDelta:80});var cd=ja.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],
zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a;this._setPanDelta(a.options.keyboardPanDelta);this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;0>=a.tabIndex&&(a.tabIndex="0");x(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks();L(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},
this);this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=document.body,b=document.documentElement,c=a.scrollTop||b.scrollTop,a=a.scrollLeft||b.scrollLeft;this._map._container.focus();window.scrollTo(a,c)}},_onFocus:function(){this._focused=!0;this._map.fire("focus")},_onBlur:function(){this._focused=!1;this._map.fire("blur")},_setPanDelta:function(a){var b=this._panKeys={},c=this.keyCodes,d,e;d=0;for(e=c.left.length;d<e;d++)b[c.left[d]]=
[-1*a,0];d=0;for(e=c.right.length;d<e;d++)b[c.right[d]]=[a,0];d=0;for(e=c.down.length;d<e;d++)b[c.down[d]]=[0,a];d=0;for(e=c.up.length;d<e;d++)b[c.up[d]]=[0,-1*a]},_setZoomDelta:function(a){var b=this._zoomKeys={},c=this.keyCodes,d,e;d=0;for(e=c.zoomIn.length;d<e;d++)b[c.zoomIn[d]]=a;d=0;for(e=c.zoomOut.length;d<e;d++)b[c.zoomOut[d]]=-a},_addHooks:function(){x(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){L(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||
a.ctrlKey||a.metaKey)){var b=a.keyCode,c=this._map;if(b in this._panKeys){if(c._panAnim&&c._panAnim._inProgress)return;b=this._panKeys[b];a.shiftKey&&(b=w(b).multiplyBy(3));c.panBy(b);c.options.maxBounds&&c.panInsideBounds(c.options.maxBounds)}else if(b in this._zoomKeys)c.setZoom(c.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[b]);else if(27===b&&c._popup)c.closePopup();else return;ca(a)}}});z.addInitHook("addHandler","keyboard",cd);z.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});
var dd=ja.extend({addHooks:function(){x(this._map._container,"mousewheel",this._onWheelScroll,this);this._delta=0},removeHooks:function(){L(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var b=wc(a),d=this._map.options.wheelDebounceTime;this._delta+=b;this._lastMousePos=this._map.mouseEventToContainerPoint(a);this._startTime||(this._startTime=+new Date);b=Math.max(d-(+new Date-this._startTime),0);clearTimeout(this._timer);this._timer=setTimeout(c(this._performZoom,
this),b);ca(a)},_performZoom:function(){var a=this._map,b=a.getZoom(),c=this._map.options.zoomSnap||0;a._stop();var d=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,c=c?Math.ceil(d/c)*c:d,c=a._limitZoom(b+(0<this._delta?c:-c))-b;this._delta=0;this._startTime=null;c&&("center"===a.options.scrollWheelZoom?a.setZoom(b+c):a.setZoomAround(this._lastMousePos,b+c))}});z.addInitHook("addHandler","scrollWheelZoom",dd);z.mergeOptions({tap:!0,tapTolerance:15});
var ed=ja.extend({addHooks:function(){x(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){L(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(a.touches)if(S(a),this._fireClick=!0,1<a.touches.length)this._fireClick=!1,clearTimeout(this._holdTimeout);else{var b=a.touches[0];a=b.target;this._startPos=this._newPos=new v(b.clientX,b.clientY);a.tagName&&"a"===a.tagName.toLowerCase()&&B(a,"goomap-active");this._holdTimeout=setTimeout(c(function(){this._isTapValid()&&
(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",b))},this),1E3);this._simulateEvent("mousedown",b);x(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(a){clearTimeout(this._holdTimeout);L(document,{touchmove:this._onMove,touchend:this._onUp},this);if(this._fireClick&&a&&a.changedTouches){a=a.changedTouches[0];var b=a.target;b&&b.tagName&&"a"===b.tagName.toLowerCase()&&K(b,"goomap-active");this._simulateEvent("mouseup",a);this._isTapValid()&&this._simulateEvent("click",
a)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(a){a=a.touches[0];this._newPos=new v(a.clientX,a.clientY);this._simulateEvent("mousemove",a)},_simulateEvent:function(a,b){var c=document.createEvent("MouseEvents");c._simulated=!0;b.target._simulatedClick=!0;c.initMouseEvent(a,!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null);b.target.dispatchEvent(c)}});Y&&!ba&&z.addInitHook("addHandler","tap",ed);
z.mergeOptions({touchZoom:Y&&!Ua,bounceAtZoomLimits:!0});var fd=ja.extend({addHooks:function(){B(this._map._container,"goomap-touch-zoom");x(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){K(this._map._container,"goomap-touch-zoom");L(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var b=this._map;if(a.touches&&2===a.touches.length&&!b._animatingZoom&&!this._zooming){var c=b.mouseEventToContainerPoint(a.touches[0]),d=b.mouseEventToContainerPoint(a.touches[1]);
this._centerPoint=b.getSize()._divideBy(2);this._startLatLng=b.containerPointToLatLng(this._centerPoint);"center"!==b.options.touchZoom&&(this._pinchStartLatLng=b.containerPointToLatLng(c.add(d)._divideBy(2)));this._startDist=c.distanceTo(d);this._startZoom=b.getZoom();this._moved=!1;this._zooming=!0;b._stop();x(document,"touchmove",this._onTouchMove,this);x(document,"touchend",this._onTouchEnd,this);S(a)}},_onTouchMove:function(a){if(a.touches&&2===a.touches.length&&this._zooming){var b=this._map,
d=b.mouseEventToContainerPoint(a.touches[0]),e=b.mouseEventToContainerPoint(a.touches[1]),f=d.distanceTo(e)/this._startDist;this._zoom=b.getScaleZoom(f,this._startZoom);!b.options.bounceAtZoomLimits&&(this._zoom<b.getMinZoom()&&1>f||this._zoom>b.getMaxZoom()&&1<f)&&(this._zoom=b._limitZoom(this._zoom));if("center"===b.options.touchZoom){if(this._center=this._startLatLng,1===f)return}else{d=d._add(e)._divideBy(2)._subtract(this._centerPoint);if(1===f&&0===d.x&&0===d.y)return;this._center=b.unproject(b.project(this._pinchStartLatLng,
this._zoom).subtract(d),this._zoom)}this._moved||(b._moveStart(!0),this._moved=!0);P(this._animRequest);b=c(b._move,b,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=I(b,this,!0);S(a)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,P(this._animRequest),L(document,"touchmove",this._onTouchMove),L(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):
this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});z.addInitHook("addHandler","touchZoom",fd);z.BoxZoom=$c;z.DoubleClickZoom=ad;z.Drag=bd;z.Keyboard=cd;z.ScrollWheelZoom=dd;z.Tap=ed;z.TouchZoom=fd;var Dd=window.G;window.G=a;Object.freeze=Hc;a.version="1.2.0+HEAD.1ac320b";a.noConflict=function(){window.G=Dd;return this};a.Control=Z;a.control=Za;a.Browser=td;a.Evented=Ta;a.Mixin=wd;a.Util=od;a.Class=W;a.Handler=ja;a.extend=b;a.bind=c;a.stamp=d;a.setOptions=p;a.DomEvent=
ud;a.DomUtil=vd;a.PosAnimation=Pc;a.Draggable=va;a.LineUtil=xd;a.PolyUtil=yd;a.Point=v;a.point=w;a.Bounds=C;a.bounds=O;a.Transformation=wa;a.transformation=la;a.Projection=zd;a.LatLng=y;a.latLng=F;a.LatLngBounds=H;a.latLngBounds=E;a.CRS=ia;a.GeoJSON=ha;a.geoJSON=Ec;a.geoJson=Ec;a.Layer=V;a.LayerGroup=Ha;a.layerGroup=function(a){return new Ha(a)};a.FeatureGroup=ua;a.featureGroup=function(a){return new ua(a)};a.ImageOverlay=mc;a.imageOverlay=function(a,b,c){return new mc(a,b,c)};a.VideoOverlay=Wc;a.videoOverlay=
function(a,b,c){return new Wc(a,b,c)};a.DivOverlay=ka;a.Popup=Ja;a.popup=function(a,b){return new Ja(a,b)};a.Tooltip=Ka;a.tooltip=function(a,b){return new Ka(a,b)};a.Icon=Ia;a.icon=function(a){return new Ia(a)};a.DivIcon=Xc;a.divIcon=function(a){return new Xc(a)};a.Marker=Sa;a.marker=function(a,b){return new Sa(a,b)};a.TileLayer=Da;a.tileLayer=Fc;a.GridLayer=nc;a.gridLayer=function(a){return new nc(a)};a.SVG=Ea;a.svg=Xb;a.Renderer=da;a.Canvas=Wb;a.canvas=Vb;a.Path=pa;a.CircleMarker=tb;a.circleMarker=
function(a,b){return new tb(a,b)};a.Circle=kc;a.circle=function(a,b,c){return new kc(a,b,c)};a.Polyline=ga;a.polyline=function(a,b){return new ga(a,b)};a.Polygon=Ba;a.polygon=function(a,b){return new Ba(a,b)};a.Rectangle=Zc;a.rectangle=function(a,b){return new Zc(a,b)};a.Map=z;a.map=function(a,b){return new z(a,b)}});G.drawVersion="0.4.2";G.Draw={};
G.drawLocal={draw:{toolbar:{actions:{title:"\u53d6\u6d88\u7ed8\u5236",text:"\u53d6\u6d88"},finish:{title:"\u5b8c\u6210\u7ed8\u5236",text:"\u5b8c\u6210"},undo:{title:"\u5220\u9664\u6700\u540e\u7ed8\u5236\u7684\u70b9",text:"\u5220\u9664\u6700\u540e\u4e00\u4e2a\u70b9"},buttons:{polyline:"\u7ed8\u5236\u6298\u7ebf",polygon:"\u7ed8\u5236\u591a\u8fb9\u5f62",rectangle:"\u7ed8\u5236\u77e9\u5f62",circle:"\u753b\u4e00\u4e2a\u5706",marker:"\u7ed8\u5236\u6807\u8bb0"}},handlers:{circle:{tooltip:{start:"\u5355\u51fb\u5e76\u62d6\u52a8\u4ee5\u7ed8\u5236\u5706\u3002"},radius:"\u534a\u5f84"},
marker:{tooltip:{start:"\u70b9\u51fb\u5730\u56fe\u4ee5\u653e\u7f6e\u6807\u8bb0\u3002"}},polygon:{tooltip:{start:"\u5355\u51fb\u5f00\u59cb\u7ed8\u5236\u5f62\u72b6\u3002",cont:"\u5355\u51fb\u4ee5\u7ee7\u7eed\u7ed8\u5236\u5f62\u72b6\u3002",end:"\u5355\u51fb\u7b2c\u4e00\u4e2a\u70b9\u4ee5\u5173\u95ed\u6b64\u5f62\u72b6\u3002"}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"\u5355\u51fb\u5f00\u59cb\u7ed8\u5236\u7ebf\u3002",cont:"\u5355\u51fb\u7ee7\u7eed\u7ed8\u5236\u7ebf\u3002",
end:"\u5355\u51fb\u6700\u540e\u4e00\u4e2a\u70b9\u5b8c\u6210\u7ed8\u5236\u7ebf\u3002"}},rectangle:{tooltip:{start:"\u5355\u51fb\u5e76\u62d6\u52a8\u4ee5\u7ed8\u5236\u77e9\u5f62\u3002"}},simpleshape:{tooltip:{end:"\u91ca\u653e\u9f20\u6807\u5b8c\u6210\u7ed8\u56fe\u3002"}}}},edit:{toolbar:{actions:{save:{title:"\u4fdd\u5b58\u66f4\u6539\u3002",text:"\u4fdd\u5b58"},cancel:{title:"\u53d6\u6d88\u7f16\u8f91\uff0c\u653e\u5f03\u6240\u6709\u66f4\u6539\u3002",text:"\u53d6\u6d88"}},buttons:{edit:"\u7f16\u8f91\u56fe\u5c42\u3002",
editDisabled:"\u6ca1\u6709\u9700\u8981\u7f16\u8f91\u56fe\u5c42\u3002",remove:"\u5220\u9664\u56fe\u5c42\u3002",removeDisabled:"\u6ca1\u6709\u8981\u5220\u9664\u7684\u56fe\u5c42\u3002"}},handlers:{edit:{tooltip:{text:"\u62d6\u52a8\u624b\u67c4\u6216\u6807\u8bb0\u4ee5\u7f16\u8f91\u8981\u7d20\u3002",subtext:"\u70b9\u51fb\u53d6\u6d88\u53ef\u64a4\u6d88\u66f4\u6539\u3002"}},remove:{tooltip:{text:"\u5355\u51fb\u8981\u5220\u9664\u7684\u8981\u7d20\u3002"}}}}};G.Draw.Event={};G.Draw.Event.CREATED="draw:created";G.Draw.Event.EDITED="draw:edited";G.Draw.Event.DELETED="draw:deleted";G.Draw.Event.DRAWSTART="draw:drawstart";G.Draw.Event.DRAWSTOP="draw:drawstop";G.Draw.Event.DRAWVERTEX="draw:drawvertex";G.Draw.Event.EDITSTART="draw:editstart";G.Draw.Event.EDITMOVE="draw:editmove";G.Draw.Event.EDITRESIZE="draw:editresize";G.Draw.Event.EDITVERTEX="draw:editvertex";G.Draw.Event.EDITSTOP="draw:editstop";G.Draw.Event.DELETESTART="draw:deletestart";
G.Draw.Event.DELETESTOP="draw:deletestop";G.Draw=G.Draw||{};
G.Draw.Feature=G.Handler.extend({includes:G.Mixin.Events,initialize:function(a,b){this._map=a;this._container=a._container;this._overlayPane=a._panes.overlayPane;this._popupPane=a._panes.popupPane;b&&b.shapeOptions&&(b.shapeOptions=G.Util.extend({},this.options.shapeOptions,b.shapeOptions));G.setOptions(this,b)},enable:function(){this._enabled||(G.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(G.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&
(G.Handler.prototype.disable.call(this),this._map.fire(G.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var a=this._map;a&&(G.DomUtil.disableTextSelection(),a.getContainer().focus(),this._tooltip=new G.Draw.Tooltip(this._map),G.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(G.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,G.DomEvent.off(this._container,"keyup",
this._cancelDrawing,this))},setOptions:function(a){G.setOptions(this,a)},_fireCreatedEvent:function(a){this._map.fire(G.Draw.Event.CREATED,{layer:a,layerType:this.type})},_cancelDrawing:function(a){this._map.fire("draw:canceled",{layerType:this.type});27===a.keyCode&&this.disable()}});G.Draw.Polyline=G.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:G.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new G.DivIcon({iconSize:new G.Point(8,8),className:"goomap-div-icon goomap-editing-icon"}),touchIcon:new G.DivIcon({iconSize:new G.Point(20,20),className:"goomap-div-icon goomap-editing-icon goomap-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4E3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},
metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2E3},initialize:function(a,b){G.Browser.touch&&!G.Browser.chrome&&(this.options.icon=this.options.touchIcon);this.options.drawError.message=G.drawLocal.draw.handlers.polyline.error;b&&b.drawError&&(b.drawError=G.Util.extend({},this.options.drawError,b.drawError));this.type=G.Draw.Polyline.TYPE;G.Draw.Feature.prototype.initialize.call(this,a,b)},addHooks:function(){G.Draw.Feature.prototype.addHooks.call(this);this._map&&(this._markers=[],this._markerGroup=
new G.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new G.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=G.marker(this._map.getCenter(),{icon:G.divIcon({className:"goomap-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",
this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){G.Draw.Feature.prototype.removeHooks.call(this);this._clearHideErrorTimeout();this._cleanUpShape();this._map.removeLayer(this._markerGroup);delete this._markerGroup;delete this._markers;this._map.removeLayer(this._poly);delete this._poly;
this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this);this._map.removeLayer(this._mouseMarker);delete this._mouseMarker;this._clearGuides();this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(1>=
this._markers.length)){var a=this._markers.pop(),b=this._poly,c=b.getLatLngs(),d=c.splice(-1,1)[0];this._poly.setLatLngs(c);this._markerGroup.removeLayer(a);2>b.getLatLngs().length&&this._map.removeLayer(b);this._vertexChanged(d,!1)}},addVertex:function(a){2<=this._markers.length&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(a)?this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(a)),this._poly.addLatLng(a),2===this._poly.getLatLngs().length&&
this._map.addLayer(this._poly),this._vertexChanged(a,!0))},completeShape:function(){1>=this._markers.length||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var a=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),a=this._poly.newLatLngIntersects(a[a.length-1]);!this.options.allowIntersection&&a||!this._shapeIsValid()?this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},
_shapeIsValid:function(){return!0},_onZoomEnd:function(){null!==this._markers&&this._updateGuide()},_onMouseMove:function(a){var b=this._map.mouseEventToLayerPoint(a.originalEvent),c=this._map.layerPointToLatLng(b);this._currentLatLng=c;this._updateTooltip(c);this._updateGuide(b);this._mouseMarker.setLatLng(c);G.DomEvent.preventDefault(a.originalEvent)},_vertexChanged:function(a,b){this._map.fire(G.Draw.Event.DRAWVERTEX,{layers:this._markerGroup});this._updateFinishHandler();this._updateRunningMeasure(a,
b);this._clearGuides();this._updateTooltip()},_onMouseDown:function(a){this._clickHandled||this._touchHandled||this._disableMarkers||(this._onMouseMove(a),this._clickHandled=!0,this._disableNewMarkers(),a=a.originalEvent,this._startPoint.call(this,a.clientX,a.clientY))},_startPoint:function(a,b){this._mouseDownOrigin=G.point(a,b)},_onMouseUp:function(a){var b=a.originalEvent;this._endPoint.call(this,b.clientX,b.clientY,a);this._clickHandled=null},_endPoint:function(a,b,c){this._mouseDownOrigin&&(a=
G.point(a,b).distanceTo(this._mouseDownOrigin),10>this._calculateFinishDistance(c.latlng)&&G.Browser.touch?this._finishShape():Math.abs(a)<9*(window.devicePixelRatio||1)&&this.addVertex(c.latlng),this._enableNewMarkers());this._mouseDownOrigin=null},_onTouch:function(a){var b=a.originalEvent,c;!b.touches||!b.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(c=b.touches[0].clientX,b=b.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,
c,b),this._endPoint.call(this,c,b,a),this._touchHandled=null);this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(a){var b;if(0<this._markers.length){if(this.type===G.Draw.Polyline.TYPE)b=this._markers[this._markers.length-1];else if(this.type===G.Draw.Polygon.TYPE)b=this._markers[0];else return Infinity;b=this._map.latLngToContainerPoint(b.getLatLng());a=new G.Marker(a,{icon:this.options.icon,zIndexOffset:2*
this.options.zIndexOffset});a=this._map.latLngToContainerPoint(a.getLatLng());b=b.distanceTo(a)}else b=Infinity;return b},_updateFinishHandler:function(){var a=this._markers.length;if(1<a)this._markers[a-1].on("click",this._finishShape,this);2<a&&this._markers[a-2].off("click",this._finishShape,this)},_createMarker:function(a){a=new G.Marker(a,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});this._markerGroup.addLayer(a);return a},_updateGuide:function(a){var b=this._markers?this._markers.length:
0;0<b&&(a=a||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[b-1].getLatLng()),a))},_updateTooltip:function(a){var b=this._getTooltipText();a&&this._tooltip.updatePosition(a);this._errorShown||this._tooltip.updateContent(b)},_drawGuide:function(a,b){var c=Math.floor(Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2))),d=this.options.guidelineDistance,e=this.options.maxGuideLineLength,d=c>e?c-e:d,g;this._guidesContainer||
(this._guidesContainer=G.DomUtil.create("div","goomap-draw-guides",this._overlayPane));for(;d<c;d+=this.options.guidelineDistance)e=d/c,e={x:Math.floor(a.x*(1-e)+e*b.x),y:Math.floor(a.y*(1-e)+e*b.y)},g=G.DomUtil.create("div","goomap-draw-guide-dash",this._guidesContainer),g.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,G.DomUtil.setPosition(g,e)},_updateGuideColor:function(a){if(this._guidesContainer)for(var b=0,c=this._guidesContainer.childNodes.length;b<
c;b++)this._guidesContainer.childNodes[b].style.backgroundColor=a},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var a=this.options.showLength;G.Browser.touch&&!G.Browser.chrome&&(a=!1);0===this._markers.length?a={text:G.drawLocal.draw.handlers.polyline.tooltip.start}:(a=a?this._getMeasurementString():"",a=1===this._markers.length?{text:G.drawLocal.draw.handlers.polyline.tooltip.cont,
subtext:a}:{text:G.drawLocal.draw.handlers.polyline.tooltip.end,subtext:a});return a},_updateRunningMeasure:function(a,b){var c=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(c=a.distanceTo(this._markers[c-(b?2:1)].getLatLng()),this._measurementRunningTotal+=c*(b?1:-1))},_getMeasurementString:function(){var a=this._currentLatLng,b=this._markers[this._markers.length-1].getLatLng(),a=this._measurementRunningTotal+a.distanceTo(b);return G.GeometryUtil.readableDistance(a,
this.options.metric,this.options.feet,this.options.nautic)},_showErrorTooltip:function(){this._errorShown=!0;this._tooltip.showAsError().updateContent({text:this.options.drawError.message});this._updateGuideColor(this.options.drawError.color);this._poly.setStyle({color:this.options.drawError.color});this._clearHideErrorTimeout();this._hideErrorTimeout=setTimeout(G.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1;this._clearHideErrorTimeout();
this._tooltip.removeError().updateContent(this._getTooltipText());this._updateGuideColor(this.options.shapeOptions.color);this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)},_cleanUpShape:function(){1<this._markers.length&&
this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var a=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);G.Draw.Feature.prototype._fireCreatedEvent.call(this,a)}});G.Draw.Polygon=G.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:G.Polygon,options:{showArea:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0},initialize:function(a,b){G.Draw.Polyline.prototype.initialize.call(this,a,b);this.type=G.Draw.Polygon.TYPE},_updateFinishHandler:function(){var a=this._markers.length;if(1===a)this._markers[0].on("click",this._finishShape,this);2<a&&(this._markers[a-1].on("dblclick",this._finishShape,
this),3<a&&this._markers[a-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var a,b;0===this._markers.length?a=G.drawLocal.draw.handlers.polygon.tooltip.start:3>this._markers.length?a=G.drawLocal.draw.handlers.polygon.tooltip.cont:(a=G.drawLocal.draw.handlers.polygon.tooltip.end,b=this._getMeasurementString());return{text:a,subtext:b}},_getMeasurementString:function(){var a=this._area;return a?G.GeometryUtil.readableArea(a,this.options.metric):null},_shapeIsValid:function(){return 3<=
this._markers.length},_vertexChanged:function(a,b){var c;!this.options.allowIntersection&&this.options.showArea&&(c=this._poly.getLatLngs(),this._area=G.GeometryUtil.geodesicArea(c));G.Draw.Polyline.prototype._vertexChanged.call(this,a,b)},_cleanUpShape:function(){var a=this._markers.length;0<a&&(this._markers[0].off("click",this._finishShape,this),2<a&&this._markers[a-1].off("dblclick",this._finishShape,this))}});G.SimpleShape={};
G.Draw.SimpleShape=G.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(a,b){this._endLabelText=G.drawLocal.draw.handlers.simpleshape.tooltip.end;G.Draw.Feature.prototype.initialize.call(this,a,b)},addHooks:function(){G.Draw.Feature.prototype.addHooks.call(this);this._map&&((this._mapDraggable=this._map.dragging.enabled())&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,
this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this))},removeHooks:function(){G.Draw.Feature.prototype.removeHooks.call(this);this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),G.DomEvent.off(document,"mouseup",this._onMouseUp,
this),G.DomEvent.off(document,"touchend",this._onMouseUp,this),this._shape&&(this._map.removeLayer(this._shape),delete this._shape));this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(a){this._isDrawing=!0;this._startLatLng=a.latlng;G.DomEvent.on(document,"mouseup",this._onMouseUp,this).on(document,"touchend",this._onMouseUp,this).preventDefault(a.originalEvent)},_onMouseMove:function(a){a=a.latlng;this._tooltip.updatePosition(a);this._isDrawing&&
(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(a))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent();this.disable();this.options.repeatMode&&this.enable()}});G.Draw.Rectangle=G.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,showArea:!0,clickable:!0},metric:!0},initialize:function(a,b){this.type=G.Draw.Rectangle.TYPE;this._initialLabelText=G.drawLocal.draw.handlers.rectangle.tooltip.start;G.Draw.SimpleShape.prototype.initialize.call(this,a,b)},_drawShape:function(a){this._shape?this._shape.setBounds(new G.LatLngBounds(this._startLatLng,a)):(this._shape=
new G.Rectangle(new G.LatLngBounds(this._startLatLng,a),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var a=new G.Rectangle(this._shape.getBounds(),this.options.shapeOptions);G.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,a)},_getTooltipText:function(){var a=G.Draw.SimpleShape.prototype._getTooltipText.call(this),b=this.options.showArea,c;this._shape&&(c=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),c=G.GeometryUtil.geodesicArea(c),
c=b?G.GeometryUtil.readableArea(c,this.options.metric):"");return{text:a.text,subtext:c}}});G.Draw.Circle=G.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(a,b){this.type=G.Draw.Circle.TYPE;this._initialLabelText=G.drawLocal.draw.handlers.circle.tooltip.start;G.Draw.SimpleShape.prototype.initialize.call(this,a,b)},_drawShape:function(a){this._shape?this._shape.setRadius(this._startLatLng.distanceTo(a)):(this._shape=
new G.Circle(this._startLatLng,this._startLatLng.distanceTo(a),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var a=new G.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);G.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,a)},_onMouseMove:function(a){var b=a.latlng;a=this.options.showRadius;var c=this.options.metric;this._tooltip.updatePosition(b);if(this._isDrawing){this._drawShape(b);var b=this._shape.getRadius().toFixed(1),
d="";a&&(d=G.drawLocal.draw.handlers.circle.radius+": "+G.GeometryUtil.readableDistance(b,c,this.options.feet,this.options.nautic));this._tooltip.updateContent({text:this._endLabelText,subtext:d})}}});G.Draw.Marker=G.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new G.Icon.Default,repeatMode:!1,zIndexOffset:2E3},initialize:function(a,b){this.type=G.Draw.Marker.TYPE;G.Draw.Feature.prototype.initialize.call(this,a,b)},addHooks:function(){G.Draw.Feature.prototype.addHooks.call(this);this._map&&(this._tooltip.updateContent({text:G.drawLocal.draw.handlers.marker.tooltip.start}),this._mouseMarker||(this._mouseMarker=G.marker(this._map.getCenter(),{icon:G.divIcon({className:"goomap-mouse-marker",
iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){G.Draw.Feature.prototype.removeHooks.call(this);this._map&&(this._marker&&(this._marker.off("click",this._onClick,this),this._map.off("click",this._onClick,this).off("click",this._onTouch,this).removeLayer(this._marker),delete this._marker),
this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(a){a=a.latlng;this._tooltip.updatePosition(a);this._mouseMarker.setLatLng(a);this._marker?(a=this._mouseMarker.getLatLng(),this._marker.setLatLng(a)):(this._marker=new G.Marker(a,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset}),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,
this).addLayer(this._marker))},_onClick:function(){this._fireCreatedEvent();this.disable();this.options.repeatMode&&this.enable()},_onTouch:function(a){this._onMouseMove(a);this._onClick()},_fireCreatedEvent:function(){var a=new G.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});G.Draw.Feature.prototype._fireCreatedEvent.call(this,a)}});G.Edit=G.Edit||{};
G.Edit.Marker=G.Handler.extend({initialize:function(a,b){this._marker=a;G.setOptions(this,b)},addHooks:function(){var a=this._marker;a.dragging.enable();a.on("dragend",this._onDragEnd,a);this._toggleMarkerHighlight()},removeHooks:function(){var a=this._marker;a.dragging.disable();a.off("dragend",this._onDragEnd,a);this._toggleMarkerHighlight()},_onDragEnd:function(a){a=a.target;a.edited=!0;this._map.fire(G.Draw.Event.EDITMOVE,{layer:a})},_toggleMarkerHighlight:function(){var a=this._marker._icon;a&&
(a.style.display="none",G.DomUtil.hasClass(a,"goomap-edit-marker-selected")?(G.DomUtil.removeClass(a,"goomap-edit-marker-selected"),this._offsetMarker(a,-4)):(G.DomUtil.addClass(a,"goomap-edit-marker-selected"),this._offsetMarker(a,4)),a.style.display="")},_offsetMarker:function(a,b){var c=parseInt(a.style.marginTop,10)-b,d=parseInt(a.style.marginLeft,10)-b;a.style.marginTop=c+"px";a.style.marginLeft=d+"px"}});
G.Marker.addInitHook(function(){G.Edit.Marker&&(this.editing=new G.Edit.Marker(this),this.options.editable&&this.editing.enable())});G.Edit=G.Edit||{};
G.Edit.Poly=G.Handler.extend({options:{},initialize:function(a,b){this.latlngs=[a._latlngs];a._holes&&(this.latlngs=this.latlngs.concat(a._holes));this._poly=a;G.setOptions(this,b);this._poly.on("goomap-edited",this._updateLatLngs,this)},_defaultShape:function(){return G.Polyline._flat?G.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(a){for(var b=0;b<this._verticesHandlers.length;b++)a(this._verticesHandlers[b])},addHooks:function(){this._initHandlers();
this._eachVertexHandler(function(a){a.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(a){a.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(a){a.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var a=0;a<this.latlngs.length;a++)this._verticesHandlers.push(new G.Edit.PolyVerticesEdit(this._poly,this.latlngs[a],this.options))},_updateLatLngs:function(a){this.latlngs=[a.layer._latlngs];a.layer._holes&&(this.latlngs=this.latlngs.concat(a.layer._holes))}});
G.Edit.PolyVerticesEdit=G.Handler.extend({options:{icon:new G.DivIcon({iconSize:new G.Point(8,8),className:"goomap-div-icon goomap-editing-icon"}),touchIcon:new G.DivIcon({iconSize:new G.Point(20,20),className:"goomap-div-icon goomap-editing-icon goomap-touch-icon"}),drawError:{color:"#b00b00",timeout:1E3}},initialize:function(a,b,c){G.Browser.touch&&!G.Browser.chrome&&(this.options.icon=this.options.touchIcon);this._poly=a;c&&c.drawError&&(c.drawError=G.Util.extend({},this.options.drawError,c.drawError));
this._latlngs=b;G.setOptions(this,c)},_defaultShape:function(){return G.Polyline._flat?G.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var a=this._poly;a instanceof G.Polygon||(a.options.fill=!1,a.options.editing&&(a.options.editing.fill=!1));a.setStyle(a.options.editing);this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var a=this._poly;a.setStyle(a.options.original);
a._map&&(a._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers();this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new G.LayerGroup);this._markers=[];var a=this._defaultShape(),b,c,d;b=0;for(c=a.length;b<c;b++)d=this._createMarker(a[b],b),d.on("click",this._onMarkerClick,this),this._markers.push(d);b=0;for(a=c-1;b<c;a=b++)if(0!==b||G.Polygon&&this._poly instanceof G.Polygon)a=this._markers[a],
d=this._markers[b],this._createMiddleMarker(a,d),this._updatePrevNext(a,d)},_createMarker:function(a,b){var c=new G.Marker.Touch(a,{draggable:!0,icon:this.options.icon});c._origLatLng=a;c._index=b;c.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this);this._markerGroup.addLayer(c);return c},
_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var a=this._defaultShape(),b=[].splice.apply(a,arguments);this._poly._convertLatLngs(a,!0);this._poly.redraw();return b},_removeMarker:function(a){var b=a._index;this._markerGroup.removeLayer(a);this._markers.splice(b,1);this._spliceLatLngs(b,1);this._updateIndexes(b,-1);a.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,
this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0;this._poly.fire("edit");this._poly._map.fire(G.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(a){var b=a.target,c=this._poly;G.extend(b._origLatLng,b._latlng);b._middleLeft&&b._middleLeft.setLatLng(this._getMiddleLatLng(b._prev,b));b._middleRight&&b._middleRight.setLatLng(this._getMiddleLatLng(b,
b._next));if(c.options.poly){var d=c._map._editTooltip;if(!c.options.poly.allowIntersection&&c.intersects()){var e=c.options.color;c.setStyle({color:this.options.drawError.color});0!==G.version.indexOf("0.7")&&b.dragging._draggable._onUp(a);this._onMarkerClick(a);d&&d.updateContent({text:G.drawLocal.draw.handlers.polyline.error});setTimeout(function(){c.setStyle({color:e});d&&d.updateContent({text:G.drawLocal.edit.handlers.edit.tooltip.text,subtext:G.drawLocal.edit.handlers.edit.tooltip.subtext})},
1E3)}}this._poly.redraw();this._poly.fire("editdrag")},_onMarkerClick:function(a){var b=G.Polygon&&this._poly instanceof G.Polygon?4:3;a=a.target;this._defaultShape().length<b||(this._removeMarker(a),this._updatePrevNext(a._prev,a._next),a._middleLeft&&this._markerGroup.removeLayer(a._middleLeft),a._middleRight&&this._markerGroup.removeLayer(a._middleRight),a._prev&&a._next?this._createMiddleMarker(a._prev,a._next):a._prev?a._next||(a._prev._middleRight=null):a._next._middleLeft=null,this._fireEdit())},
_onTouchMove:function(a){var b=this._map.mouseEventToLayerPoint(a.originalEvent.touches[0]),b=this._map.layerPointToLatLng(b);a=a.target;G.extend(a._origLatLng,b);a._middleLeft&&a._middleLeft.setLatLng(this._getMiddleLatLng(a._prev,a));a._middleRight&&a._middleRight.setLatLng(this._getMiddleLatLng(a,a._next));this._poly.redraw();this.updateMarkers()},_updateIndexes:function(a,b){this._markerGroup.eachLayer(function(c){c._index>a&&(c._index+=b)})},_createMiddleMarker:function(a,b){var c=this._getMiddleLatLng(a,
b),d=this._createMarker(c),e,g,h;d.setOpacity(.6);a._middleRight=b._middleLeft=d;g=function(){d.off("touchmove",g,this);var h=b._index;d._index=h;d.off("click",e,this).on("click",this._onMarkerClick,this);c.lat=d.getLatLng().lat;c.lng=d.getLatLng().lng;this._spliceLatLngs(h,0,c);this._markers.splice(h,0,d);d.setOpacity(1);this._updateIndexes(h,1);b._index++;this._updatePrevNext(a,d);this._updatePrevNext(d,b);this._poly.fire("editstart")};h=function(){d.off("dragstart",g,this);d.off("dragend",h,this);
d.off("touchmove",g,this);this._createMiddleMarker(a,d);this._createMiddleMarker(d,b)};e=function(){g.call(this);h.call(this);this._fireEdit()};d.on("click",e,this).on("dragstart",g,this).on("dragend",h,this).on("touchmove",g,this);this._markerGroup.addLayer(d)},_updatePrevNext:function(a,b){a&&(a._next=b);b&&(b._prev=a)},_getMiddleLatLng:function(a,b){var c=this._poly._map,d=c.project(a.getLatLng()),e=c.project(b.getLatLng());return c.unproject(d._add(e)._divideBy(2))}});
G.Polyline.addInitHook(function(){this.editing||(G.Edit.Poly&&(this.editing=new G.Edit.Poly(this,this.options.poly),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))});G.Edit=G.Edit||{};
G.Edit.SimpleShape=G.Handler.extend({options:{moveIcon:new G.DivIcon({iconSize:new G.Point(8,8),className:"goomap-div-icon goomap-editing-icon goomap-edit-move"}),resizeIcon:new G.DivIcon({iconSize:new G.Point(8,8),className:"goomap-div-icon goomap-editing-icon goomap-edit-resize"}),touchMoveIcon:new G.DivIcon({iconSize:new G.Point(20,20),className:"goomap-div-icon goomap-editing-icon goomap-edit-move goomap-touch-icon"}),touchResizeIcon:new G.DivIcon({iconSize:new G.Point(20,20),className:"goomap-div-icon goomap-editing-icon goomap-edit-resize goomap-touch-icon"})},
initialize:function(a,b){G.Browser.touch&&!G.Browser.chrome&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon);this._shape=a;G.Util.setOptions(this,b)},addHooks:function(){var a=this._shape;this._shape._map&&(this._map=this._shape._map,a.setStyle(a.options.editing),a._map&&(this._map=a._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var a=this._shape;a.setStyle(a.options.original);if(a._map){this._unbindMarker(this._moveMarker);
for(var a=0,b=this._resizeMarkers.length;a<b;a++)this._unbindMarker(this._resizeMarkers[a]);this._resizeMarkers=null;this._map.removeLayer(this._markerGroup);delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers();this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new G.LayerGroup);this._createMoveMarker();this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(a,b){var c=
new G.Marker.Touch(a,{draggable:!0,icon:b,zIndexOffset:10});this._bindMarker(c);this._markerGroup.addLayer(c);return c},_bindMarker:function(a){a.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(a){a.off("dragstart",
this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(a){a.target.setOpacity(0);this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0;this._shape.fire("edit")},_onMarkerDrag:function(a){a=a.target;
var b=a.getLatLng();a===this._moveMarker?this._move(b):this._resize(b);this._shape.redraw();this._shape.fire("editdrag")},_onMarkerDragEnd:function(a){a.target.setOpacity(1);this._fireEdit()},_onTouchStart:function(a){G.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,a);if("function"===typeof this._getCorners){var b=this._getCorners();a=a.target;var c=a._cornerIndex;a.setOpacity(0);this._oppositeCorner=b[(c+2)%4];this._toggleCornerMarkers(0,c)}this._shape.fire("editstart")},_onTouchMove:function(a){var b=
this._map.mouseEventToLayerPoint(a.originalEvent.touches[0]),b=this._map.layerPointToLatLng(b);a.target===this._moveMarker?this._move(b):this._resize(b);this._shape.redraw();return!1},_onTouchEnd:function(a){a.target.setOpacity(1);this.updateMarkers();this._fireEdit()},_move:function(){},_resize:function(){}});G.Edit=G.Edit||{};
G.Edit.Rectangle=G.Edit.SimpleShape.extend({_createMoveMarker:function(){var a=this._shape.getBounds().getCenter();this._moveMarker=this._createMarker(a,this.options.moveIcon)},_createResizeMarker:function(){var a=this._getCorners();this._resizeMarkers=[];for(var b=0,c=a.length;b<c;b++)this._resizeMarkers.push(this._createMarker(a[b],this.options.resizeIcon)),this._resizeMarkers[b]._cornerIndex=b},_onMarkerDragStart:function(a){G.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,a);var b=this._getCorners();
a=a.target._cornerIndex;this._oppositeCorner=b[(a+2)%4];this._toggleCornerMarkers(0,a)},_onMarkerDragEnd:function(a){var b=a.target,c;b===this._moveMarker&&(c=this._shape.getBounds(),c=c.getCenter(),b.setLatLng(c));this._toggleCornerMarkers(1);this._repositionCornerMarkers();G.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,a)},_move:function(a){for(var b=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),c=this._shape.getBounds().getCenter(),d,e=[],g=0,h=b.length;g<
h;g++)d=[b[g].lat-c.lat,b[g].lng-c.lng],e.push([a.lat+d[0],a.lng+d[1]]);this._shape.setLatLngs(e);this._repositionCornerMarkers();this._map.fire(G.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(a){this._shape.setBounds(G.latLngBounds(a,this._oppositeCorner));a=this._shape.getBounds();this._moveMarker.setLatLng(a.getCenter());this._map.fire(G.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var a=this._shape.getBounds(),b=a.getNorthWest(),c=a.getNorthEast(),d=a.getSouthEast(),
a=a.getSouthWest();return[b,c,d,a]},_toggleCornerMarkers:function(a){for(var b=0,c=this._resizeMarkers.length;b<c;b++)this._resizeMarkers[b].setOpacity(a)},_repositionCornerMarkers:function(){for(var a=this._getCorners(),b=0,c=this._resizeMarkers.length;b<c;b++)this._resizeMarkers[b].setLatLng(a[b])}});G.Rectangle.addInitHook(function(){G.Edit.Rectangle&&(this.editing=new G.Edit.Rectangle(this),this.options.editable&&this.editing.enable())});G.Edit=G.Edit||{};
G.Edit.Circle=G.Edit.SimpleShape.extend({_createMoveMarker:function(){var a=this._shape.getLatLng();this._moveMarker=this._createMarker(a,this.options.moveIcon)},_createResizeMarker:function(){var a=this._shape.getLatLng(),a=this._getResizeMarkerPoint(a);this._resizeMarkers=[];this._resizeMarkers.push(this._createMarker(a,this.options.resizeIcon))},_getResizeMarkerPoint:function(a){var b=this._shape._radius*Math.cos(Math.PI/4);a=this._map.project(a);return this._map.unproject([a.x+b,a.y-b])},_move:function(a){var b=
this._getResizeMarkerPoint(a);this._resizeMarkers[0].setLatLng(b);this._shape.setLatLng(a);this._map.fire(G.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(a){a=this._moveMarker.getLatLng().distanceTo(a);this._shape.setRadius(a);this._map.fire(G.Draw.Event.EDITRESIZE,{layer:this._shape})}});
G.Circle.addInitHook(function(){G.Edit.Circle&&(this.editing=new G.Edit.Circle(this),this.options.editable&&this.editing.enable());this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()});this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})});G.Map.mergeOptions({touchExtend:!0});
G.Map.TouchExtend=G.Handler.extend({initialize:function(a){this._map=a;this._container=a._container;this._pane=a._panes.overlayPane},addHooks:function(){G.DomEvent.on(this._container,"touchstart",this._onTouchStart,this);G.DomEvent.on(this._container,"touchend",this._onTouchEnd,this);G.DomEvent.on(this._container,"touchmove",this._onTouchMove,this);this._detectIE()?(G.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),G.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,
this),G.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),G.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(G.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),G.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){G.DomEvent.off(this._container,"touchstart",this._onTouchStart);G.DomEvent.off(this._container,"touchend",this._onTouchEnd);G.DomEvent.off(this._container,"touchmove",this._onTouchMove);
this._detectIE()?(G.DomEvent.off(this._container,"MSPointerDowm",this._onTouchStart),G.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd),G.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove),G.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel)):(G.DomEvent.off(this._container,"touchcancel",this._onTouchCancel),G.DomEvent.off(this._container,"touchleave",this._onTouchLeave))},_touchEvent:function(a,b){var c;if("undefined"!==typeof a.touches){if(!a.touches.length)return;
c=a.touches[0]}else if("touch"===a.pointerType){if(c=a,!this._filterClick(a))return}else return;var d=this._map.mouseEventToContainerPoint(c),e=this._map.mouseEventToLayerPoint(c),g=this._map.layerPointToLatLng(e);this._map.fire(b,{latlng:g,layerPoint:e,containerPoint:d,pageX:c.pageX,pageY:c.pageY,originalEvent:a})},_filterClick:function(a){var b=a.timeStamp||a.originalEvent.timeStamp,c=G.DomEvent._lastClick&&b-G.DomEvent._lastClick;if(c&&100<c&&500>c||a.target._simulatedClick&&!a._simulated)return G.DomEvent.stop(a),
!1;G.DomEvent._lastClick=b;return!0},_onTouchStart:function(a){this._map._loaded&&this._touchEvent(a,"touchstart")},_onTouchEnd:function(a){this._map._loaded&&this._touchEvent(a,"touchend")},_onTouchCancel:function(a){if(this._map._loaded){var b="touchcancel";this._detectIE()&&(b="pointercancel");this._touchEvent(a,b)}},_onTouchLeave:function(a){this._map._loaded&&this._touchEvent(a,"touchleave")},_onTouchMove:function(a){this._map._loaded&&this._touchEvent(a,"touchmove")},_detectIE:function(){var a=
window.navigator.userAgent,b=a.indexOf("MSIE ");if(0<b)return parseInt(a.substring(b+5,a.indexOf(".",b)),10);if(0<a.indexOf("Trident/"))return b=a.indexOf("rv:"),parseInt(a.substring(b+3,a.indexOf(".",b)),10);b=a.indexOf("Edge/");return 0<b?parseInt(a.substring(b+5,a.indexOf(".",b)),10):!1}});G.Map.addInitHook("addHandler","touchExtend",G.Map.TouchExtend);
G.Marker.Touch=G.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?G.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var a=this._icon,b="dblclick mousedown mouseover mouseout contextmenu touchstart touchend touchmove".split(" ");this._detectIE?b.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):b.concat(["touchcancel"]);G.DomUtil.addClass(a,"goomap-clickable");
G.DomEvent.on(a,"click",this._onMouseClick,this);G.DomEvent.on(a,"keypress",this._onKeyPress,this);for(var c=0;c<b.length;c++)G.DomEvent.on(a,b[c],this._fireMouseEvent,this);G.Handler.MarkerDrag&&(this.dragging=new G.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var a=window.navigator.userAgent,b=a.indexOf("MSIE ");if(0<b)return parseInt(a.substring(b+5,a.indexOf(".",b)),10);if(0<a.indexOf("Trident/"))return b=a.indexOf("rv:"),parseInt(a.substring(b+
3,a.indexOf(".",b)),10);b=a.indexOf("Edge/");return 0<b?parseInt(a.substring(b+5,a.indexOf(".",b)),10):!1}});G.LatLngUtil={cloneLatLngs:function(a){for(var b=[],c=0,d=a.length;c<d;c++)Array.isArray(a[c])?b.push(G.LatLngUtil.cloneLatLngs(a[c])):b.push(this.cloneLatLng(a[c]));return b},cloneLatLng:function(a){return G.latLng(a.lat,a.lng)}};G.GeometryUtil=G.extend(G.GeometryUtil||{},{geodesicArea:function(a){var b=a.length,c=0,d=Math.PI/180,e,g;if(2<b){for(var h=0;h<b;h++)e=a[h],g=a[(h+1)%b],c+=(g.lng-e.lng)*d*(2+Math.sin(e.lat*d)+Math.sin(g.lat*d));c=40680631590769*c/2}return Math.abs(c)},readableArea:function(a,b){var c;b?c=1E6<=a?(1E-6*a).toFixed(2)+" \u5e73\u65b9\u5343\u7c73":a.toFixed(2)+" \u5e73\u65b9\u7c73":(a/=.836127,c=3097600<=a?(a/3097600).toFixed(2)+" \u5e73\u65b9\u82f1\u91cc":4840<=a?(a/4840).toFixed(2)+" \u82f1\u4ea9":
Math.ceil(a)+" \u5e73\u65b9\u7801");return c},readableDistance:function(a,b,c,d){switch("string"==typeof b?b:c?"feet":d?"nauticalMile":b?"metric":"yards"){case "metric":a=1E3<a?(a/1E3).toFixed(2)+" \u5343\u7c73":Math.ceil(a)+" \u7c73";break;case "feet":a=Math.ceil(3.28083*a)+" \u82f1\u5c3a";break;case "nauticalMile":a=(.53996*a/1E3).toFixed(2)+" \u6d77\u91cc";break;default:a*=1.09361,a=1760<a?(a/1760).toFixed(2)+" \u82f1\u91cc":Math.ceil(a)+" \u7801"}return a}});G.Util.extend(G.LineUtil,{segmentsIntersect:function(a,b,c,d){return this._checkCounterclockwise(a,c,d)!==this._checkCounterclockwise(b,c,d)&&this._checkCounterclockwise(a,b,c)!==this._checkCounterclockwise(a,b,d)},_checkCounterclockwise:function(a,b,c){return(c.y-a.y)*(b.x-a.x)>(b.y-a.y)*(c.x-a.x)}});G.Polyline.include({intersects:function(){var a=this._getProjectedPoints(),b=a?a.length:0,c,d;if(this._tooFewPointsForIntersection())return!1;for(--b;3<=b;b--)if(c=a[b-1],d=a[b],this._lineSegmentsIntersectsRange(c,d,b-2))return!0;return!1},newLatLngIntersects:function(a,b){return this._map?this.newPointIntersects(this._map.latLngToLayerPoint(a),b):!1},newPointIntersects:function(a,b){var c=this._getProjectedPoints(),d=c?c.length:0,c=c?c[d-1]:null,d=d-2;return this._tooFewPointsForIntersection(1)?
!1:this._lineSegmentsIntersectsRange(c,a,d,b?1:0)},_tooFewPointsForIntersection:function(a){var b=this._getProjectedPoints(),c=b?b.length:0;return!b||3>=c+(a||0)},_lineSegmentsIntersectsRange:function(a,b,c,d){var e=this._getProjectedPoints(),g;d=d||0;for(var h=c;h>d;h--)if(c=e[h-1],g=e[h],G.LineUtil.segmentsIntersect(a,b,c,g))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var a=[],b=this._defaultShape(),c=0;c<b.length;c++)a.push(this._map.latLngToLayerPoint(b[c]));
return a}});G.Polygon.include({intersects:function(){var a=this._getProjectedPoints(),b;if(this._tooFewPointsForIntersection())return!1;if(G.Polyline.prototype.intersects.call(this))return!0;b=a.length;return this._lineSegmentsIntersectsRange(a[b-1],a[0],b-2,1)}});G.Control.Draw=G.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(a){if("0.7">G.version)throw Error("Goomap.draw 0.2.3+ requires Goomap 0.7.0+. Download latest from https://github.com/Goomap/Goomap/");G.Control.prototype.initialize.call(this,a);this._toolbars={};G.DrawToolbar&&this.options.draw&&(a=new G.DrawToolbar(this.options.draw),this._toolbars[G.DrawToolbar.TYPE]=a,this._toolbars[G.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this));G.EditToolbar&&this.options.edit&&
(a=new G.EditToolbar(this.options.edit),this._toolbars[G.EditToolbar.TYPE]=a,this._toolbars[G.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this));G.toolbar=this},onAdd:function(a){var b=G.DomUtil.create("div","goomap-draw"),c=!1,d,e;for(e in this._toolbars)this._toolbars.hasOwnProperty(e)&&(d=this._toolbars[e].addToolbar(a))&&(c||(G.DomUtil.hasClass(d,"goomap-draw-toolbar-top")||G.DomUtil.addClass(d.childNodes[0],"goomap-draw-toolbar-top"),c=!0),b.appendChild(d));return b},onRemove:function(){for(var a in this._toolbars)this._toolbars.hasOwnProperty(a)&&
this._toolbars[a].removeToolbar()},setDrawingOptions:function(a){for(var b in this._toolbars)this._toolbars[b]instanceof G.DrawToolbar&&this._toolbars[b].setOptions(a)},_toolbarEnabled:function(a){a=a.target;for(var b in this._toolbars)this._toolbars[b]!==a&&this._toolbars[b].disable()}});G.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1});G.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new G.Control.Draw,this.addControl(this.drawControl))});G.Toolbar=G.Class.extend({includes:[G.Mixin.Events],initialize:function(a){G.setOptions(this,a);this._modes={};this._actionButtons=[];this._activeMode=null},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(a){var b=G.DomUtil.create("div","goomap-draw-section"),c=0,d=this._toolbarClass||"",e=this.getModeHandlers(a);this._toolbarContainer=G.DomUtil.create("div","goomap-draw-toolbar goomap-bar");this._map=a;
for(a=0;a<e.length;a++)e[a].enabled&&this._initModeHandler(e[a].handler,this._toolbarContainer,c++,d,e[a].title);if(c)return this._lastButtonIndex=--c,this._actionsContainer=G.DomUtil.create("ul","goomap-draw-actions"),b.appendChild(this._toolbarContainer),b.appendChild(this._actionsContainer),b},removeToolbar:function(){for(var a in this._modes)this._modes.hasOwnProperty(a)&&(this._disposeButton(this._modes[a].button,this._modes[a].handler.enable,this._modes[a].handler),this._modes[a].handler.disable(),
this._modes[a].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};a=0;for(var b=this._actionButtons.length;a<b;a++)this._disposeButton(this._actionButtons[a].button,this._actionButtons[a].callback,this);this._actionButtons=[];this._actionsContainer=null},_initModeHandler:function(a,b,c,d,e){var g=a.type;this._modes[g]={};this._modes[g].handler=a;this._modes[g].button=this._createButton({type:g,title:e,className:d+"-"+g,container:b,callback:this._modes[g].handler.enable,
context:this._modes[g].handler});this._modes[g].buttonIndex=c;this._modes[g].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_createButton:function(a){var b=G.DomUtil.create("a",a.className||"",a.container),c=G.DomUtil.create("span","sr-only",a.container);b.href="#";b.appendChild(c);a.title&&(b.title=a.title,c.innerHTML=a.title);a.text&&(b.innerHTML=a.text,c.innerHTML=a.text);G.DomEvent.on(b,"click",G.DomEvent.stopPropagation).on(b,"mousedown",G.DomEvent.stopPropagation).on(b,
"dblclick",G.DomEvent.stopPropagation).on(b,"touchstart",G.DomEvent.stopPropagation).on(b,"click",G.DomEvent.preventDefault).on(b,"click",a.callback,a.context);return b},_disposeButton:function(a,b){G.DomEvent.off(a,"click",G.DomEvent.stopPropagation).off(a,"mousedown",G.DomEvent.stopPropagation).off(a,"dblclick",G.DomEvent.stopPropagation).off(a,"touchstart",G.DomEvent.stopPropagation).off(a,"click",G.DomEvent.preventDefault).off(a,"click",b)},_handlerActivated:function(a){this.disable();this._activeMode=
this._modes[a.handler];G.DomUtil.addClass(this._activeMode.button,"goomap-draw-toolbar-button-enabled");this._showActionsToolbar();this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar();G.DomUtil.removeClass(this._activeMode.button,"goomap-draw-toolbar-button-enabled");this._activeMode=null;this.fire("disable")},_createActions:function(a){var b=this._actionsContainer;a=this.getActions(a);var c=a.length,d,e;e=0;for(d=this._actionButtons.length;e<d;e++)this._disposeButton(this._actionButtons[e].button,
this._actionButtons[e].callback);for(this._actionButtons=[];b.firstChild;)b.removeChild(b.firstChild);for(e=0;e<c;e++)"enabled"in a[e]&&!a[e].enabled||(d=G.DomUtil.create("li","",b),d=this._createButton({title:a[e].title,text:a[e].text,container:d,callback:a[e].callback,context:a[e].context}),this._actionButtons.push({button:d,callback:a[e].callback}))},_showActionsToolbar:function(){var a=this._activeMode.buttonIndex,b=this._lastButtonIndex,c=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler);
this._actionsContainer.style.top=c+"px";0===a&&(G.DomUtil.addClass(this._toolbarContainer,"goomap-draw-toolbar-notop"),G.DomUtil.addClass(this._actionsContainer,"goomap-draw-actions-top"));a===b&&(G.DomUtil.addClass(this._toolbarContainer,"goomap-draw-toolbar-nobottom"),G.DomUtil.addClass(this._actionsContainer,"goomap-draw-actions-bottom"));this._actionsContainer.style.display="block"},_hideActionsToolbar:function(){this._actionsContainer.style.display="none";G.DomUtil.removeClass(this._toolbarContainer,
"goomap-draw-toolbar-notop");G.DomUtil.removeClass(this._toolbarContainer,"goomap-draw-toolbar-nobottom");G.DomUtil.removeClass(this._actionsContainer,"goomap-draw-actions-top");G.DomUtil.removeClass(this._actionsContainer,"goomap-draw-actions-bottom")}});G.Draw=G.Draw||{};
G.Draw.Tooltip=G.Class.extend({initialize:function(a){this._map=a;this._popupPane=a._panes.popupPane;this._container=a.options.drawControlTooltips?G.DomUtil.create("div","goomap-draw-tooltip",this._popupPane):null;this._singleLineLabel=!1;this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this);this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(a){if(!this._container)return this;a.subtext=
a.subtext||"";0!==a.subtext.length||this._singleLineLabel?0<a.subtext.length&&this._singleLineLabel&&(G.DomUtil.removeClass(this._container,"goomap-draw-tooltip-single"),this._singleLineLabel=!1):(G.DomUtil.addClass(this._container,"goomap-draw-tooltip-single"),this._singleLineLabel=!0);this._container.innerHTML=(0<a.subtext.length?'<span class="goomap-draw-tooltip-subtext">'+a.subtext+"</span><br />":"")+"<span>"+a.text+"</span>";return this},updatePosition:function(a){a=this._map.latLngToLayerPoint(a);
var b=this._container;this._container&&(b.style.visibility="inherit",G.DomUtil.setPosition(b,a));return this},showAsError:function(){this._container&&G.DomUtil.addClass(this._container,"goomap-error-draw-tooltip");return this},removeError:function(){this._container&&G.DomUtil.removeClass(this._container,"goomap-error-draw-tooltip");return this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}});G.DrawToolbar=G.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{}},initialize:function(a){for(var b in this.options)this.options.hasOwnProperty(b)&&a[b]&&(a[b]=G.extend({},this.options[b],a[b]));this._toolbarClass="goomap-draw-draw";G.Toolbar.prototype.initialize.call(this,a)},getModeHandlers:function(a){return[{enabled:this.options.polyline,handler:new G.Draw.Polyline(a,this.options.polyline),title:G.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,
handler:new G.Draw.Polygon(a,this.options.polygon),title:G.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new G.Draw.Rectangle(a,this.options.rectangle),title:G.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new G.Draw.Circle(a,this.options.circle),title:G.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new G.Draw.Marker(a,this.options.marker),title:G.drawLocal.draw.toolbar.buttons.marker}]},getActions:function(a){return[{enabled:a.completeShape,
title:G.drawLocal.draw.toolbar.finish.title,text:G.drawLocal.draw.toolbar.finish.text,callback:a.completeShape,context:a},{enabled:a.deleteLastVertex,title:G.drawLocal.draw.toolbar.undo.title,text:G.drawLocal.draw.toolbar.undo.text,callback:a.deleteLastVertex,context:a},{title:G.drawLocal.draw.toolbar.actions.title,text:G.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(a){G.setOptions(this,a);for(var b in this._modes)this._modes.hasOwnProperty(b)&&a.hasOwnProperty(b)&&
this._modes[b].handler.setOptions(a[b])}});G.EditToolbar=G.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(a){a.edit&&("undefined"===typeof a.edit.selectedPathOptions&&(a.edit.selectedPathOptions=this.options.edit.selectedPathOptions),a.edit.selectedPathOptions=G.extend({},this.options.edit.selectedPathOptions,a.edit.selectedPathOptions));a.remove&&(a.remove=G.extend({},this.options.remove,
a.remove));a.poly&&(a.poly=G.extend({},this.options.poly,a.poly));this._toolbarClass="goomap-draw-edit";G.Toolbar.prototype.initialize.call(this,a);this._selectedFeatureCount=0},getModeHandlers:function(a){var b=this.options.featureGroup;return[{enabled:this.options.edit,handler:new G.EditToolbar.Edit(a,{featureGroup:b,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:G.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new G.EditToolbar.Delete(a,
{featureGroup:b}),title:G.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(){return[{title:G.drawLocal.edit.toolbar.actions.save.title,text:G.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:G.drawLocal.edit.toolbar.actions.cancel.title,text:G.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}]},addToolbar:function(a){a=G.Toolbar.prototype.addToolbar.call(this,a);this._checkDisabled();this.options.featureGroup.on("layeradd layerremove",
this._checkDisabled,this);return a},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this);G.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.goomapLayers(),G.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save();this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var a=0!==this.options.featureGroup.getLayers().length,b;this.options.edit&&
(b=this._modes[G.EditToolbar.Edit.TYPE].button,a?G.DomUtil.removeClass(b,"goomap-disabled"):G.DomUtil.addClass(b,"goomap-disabled"),b.setAttribute("title",a?G.drawLocal.edit.toolbar.buttons.edit:G.drawLocal.edit.toolbar.buttons.editDisabled));this.options.remove&&(b=this._modes[G.EditToolbar.Delete.TYPE].button,a?G.DomUtil.removeClass(b,"goomap-disabled"):G.DomUtil.addClass(b,"goomap-disabled"),b.setAttribute("title",a?G.drawLocal.edit.toolbar.buttons.remove:G.drawLocal.edit.toolbar.buttons.removeDisabled))}});G.EditToolbar.Edit=G.Handler.extend({statics:{TYPE:"edit"},includes:G.Mixin.Events,initialize:function(a,b){G.Handler.prototype.initialize.call(this,a);G.setOptions(this,b);this._featureGroup=b.featureGroup;if(!(this._featureGroup instanceof G.FeatureGroup))throw Error("options.featureGroup must be a G.FeatureGroup");this._uneditedLayerProps={};this.type=G.EditToolbar.Edit.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(G.Draw.Event.EDITSTART,
{handler:this.type}),G.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),G.Handler.prototype.disable.call(this),this._map.fire(G.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var a=this._map;a&&(a.getContainer().focus(),
this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new G.Draw.Tooltip(this._map),this._tooltip.updateContent({text:G.drawLocal.edit.handlers.edit.tooltip.text,subtext:G.drawLocal.edit.handlers.edit.tooltip.subtext}),a._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(G.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&
(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(G.Draw.Event.EDITVERTEX,this._updateTooltip,this))},goomapLayers:function(){this._featureGroup.eachLayer(function(a){this._goomapLayer(a)},this)},save:function(){var a=new G.LayerGroup;this._featureGroup.eachLayer(function(b){b.edited&&
(a.addLayer(b),b.edited=!1)});this._map.fire(G.Draw.Event.EDITED,{layers:a})},_backupLayer:function(a){var b=G.Util.stamp(a);this._uneditedLayerProps[b]||(a instanceof G.Polyline||a instanceof G.Polygon||a instanceof G.Rectangle?this._uneditedLayerProps[b]={latlngs:G.LatLngUtil.cloneLatLngs(a.getLatLngs())}:a instanceof G.Circle?this._uneditedLayerProps[b]={latlng:G.LatLngUtil.cloneLatLng(a.getLatLng()),radius:a.getRadius()}:a instanceof G.Marker&&(this._uneditedLayerProps[b]={latlng:G.LatLngUtil.cloneLatLng(a.getLatLng())}))},
_getTooltipText:function(){return{text:G.drawLocal.edit.handlers.edit.tooltip.text,subtext:G.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_goomapLayer:function(a){var b=G.Util.stamp(a);a.edited=!1;this._uneditedLayerProps.hasOwnProperty(b)&&(a instanceof G.Polyline||a instanceof G.Polygon||a instanceof G.Rectangle?a.setLatLngs(this._uneditedLayerProps[b].latlngs):a instanceof G.Circle?(a.setLatLng(this._uneditedLayerProps[b].latlng),
a.setRadius(this._uneditedLayerProps[b].radius)):a instanceof G.Marker&&a.setLatLng(this._uneditedLayerProps[b].latlng),a.fire("goomap-edited",{layer:a}))},_enableLayerEdit:function(a){a=a.layer||a.target||a;var b;this._backupLayer(a);this.options.poly&&(b=G.Util.extend({},this.options.poly),a.options.poly=b);this.options.selectedPathOptions&&(b=G.Util.extend({},this.options.selectedPathOptions),b.maintainColor&&(b.color=a.options.color,b.fillColor=a.options.fillColor),a.options.original=G.extend({},
a.options),a.options.editing=b);a instanceof G.Marker?(a.editing&&a.editing.enable(),a.dragging.enable(),a.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):a.editing.enable()},_disableLayerEdit:function(a){a=a.layer||a.target||a;a.edited=!1;a.editing&&a.editing.disable();delete a.options.editing;delete a.options.original;this._selectedPathOptions&&
(a instanceof G.Marker?this._toggleMarkerHighlight(a):(a.setStyle(a.options.previousOptions),delete a.options.previousOptions));a instanceof G.Marker?(a.dragging.disable(),a.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):a.editing.disable()},_onMouseMove:function(a){this._tooltip.updatePosition(a.latlng)},_onMarkerDragEnd:function(a){a=
a.target;a.edited=!0;this._map.fire(G.Draw.Event.EDITMOVE,{layer:a})},_onTouchMove:function(a){var b=this._map.mouseEventToLayerPoint(a.originalEvent.changedTouches[0]),b=this._map.layerPointToLatLng(b);a.target.setLatLng(b)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}});G.EditToolbar.Delete=G.Handler.extend({statics:{TYPE:"remove"},includes:G.Mixin.Events,initialize:function(a,b){G.Handler.prototype.initialize.call(this,a);G.Util.setOptions(this,b);this._deletableLayers=this.options.featureGroup;if(!(this._deletableLayers instanceof G.FeatureGroup))throw Error("options.featureGroup must be a G.FeatureGroup");this.type=G.EditToolbar.Delete.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(G.Draw.Event.DELETESTART,
{handler:this.type}),G.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),G.Handler.prototype.disable.call(this),this._map.fire(G.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var a=this._map;
a&&(a.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new G.LayerGroup,this._tooltip=new G.Draw.Tooltip(this._map),this._tooltip.updateContent({text:G.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,
this))},goomapLayers:function(){this._deletedLayers.eachLayer(function(a){this._deletableLayers.addLayer(a);a.fire("goomap-deleted",{layer:a})},this)},save:function(){this._map.fire(G.Draw.Event.DELETED,{layers:this._deletedLayers})},_enableLayerDelete:function(a){(a.layer||a.target||a).on("click",this._removeLayer,this)},_disableLayerDelete:function(a){a=a.layer||a.target||a;a.off("click",this._removeLayer,this);this._deletedLayers.removeLayer(a)},_removeLayer:function(a){a=a.layer||a.target||a;
this._deletableLayers.removeLayer(a);this._deletedLayers.addLayer(a);a.fire("deleted")},_onMouseMove:function(a){this._tooltip.updatePosition(a.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}});(function(){G.Handler.MarkerSnap=G.Handler.extend({options:{snapDistance:5,snapVertices:!0},initialize:function(a,b,c){function d(){this._buffer=a.layerPointToLatLng(new G.Point(0,0)).lat-a.layerPointToLatLng(new G.Point(this.options.snapDistance,0)).lat}G.Handler.prototype.initialize.call(this,a);this._markers=[];this._guides=[];2!=arguments.length||b instanceof G.Class||(c=b,b=null);G.Util.setOptions(this,c||{});b&&(b.dragging||(b.dragging=new G.Handler.MarkerDrag(b)),b.dragging.enable(),this.watchMarker(b));
a.on("zoomend",d,this);a.whenReady(d,this);d.call(this)},enable:function(){this.disable();for(var a=0;a<this._markers.length;a++)this.watchMarker(this._markers[a])},disable:function(){for(var a=0;a<this._markers.length;a++)this.unwatchMarker(this._markers[a])},watchMarker:function(a){-1==this._markers.indexOf(a)&&this._markers.push(a);a.on("move",this._snapMarker,this)},unwatchMarker:function(a){a.off("move",this._snapMarker,this);delete a.snap},addGuideLayer:function(a){for(var b=0,c=this._guides.length;b<
c;b++)if(G.stamp(a)===G.stamp(this._guides[b]))return;this._guides.push(a)},_snapMarker:function(a){function b(a){if(a.getLatLng)return G.stamp(d)!==G.stamp(a);if(a.editing&&a.editing._enabled){a=a.editing._verticesHandlers[0]._markerGroup.getLayers();for(var b=0,c=a.length;b<c;b++)if(G.stamp(a[b])===G.stamp(d))return!1}return!0}function c(a){if(void 0!==a._layers&&"function"!==typeof a.searchBuffer)for(var d in a._layers)c(a._layers[d]);else"function"===typeof a.searchBuffer?(a=a.searchBuffer(e,
this._buffer),g=g.concat(a.filter(function(a){return b(a)}))):b(a)&&g.push(a)}var d=a.target,e=d.getLatLng(),g=[];a=0;for(var h=this._guides.length;a<h;a++)c.call(this,this._guides[a]);a=(a=this._findClosestLayerSnap(this._map,g,e,this.options.snapDistance,this.options.snapVertices))||{layer:null,latlng:null};this._updateSnap(d,a.layer,a.latlng)},_findClosestLayerSnap:function(a,b,c,d,e){return G.GeometryUtil.closestLayerSnap(a,b,c,d,e)},_updateSnap:function(a,b,c){b&&c?(a._latlng=G.latLng(c),a.update(),
a.snap!=b&&(a.snap=b,a._icon&&G.DomUtil.addClass(a._icon,"marker-snapped"),a.fire("snap",{layer:b,latlng:c}))):(a.snap&&(a._icon&&G.DomUtil.removeClass(a._icon,"marker-snapped"),a.fire("unsnap",{layer:a.snap})),delete a.snap)}});G.Edit&&(G.Handler.PolylineSnap=G.Edit.Poly.extend({initialize:function(a,b,c){var d=this;G.Edit.Poly.prototype.initialize.call(this,b,c);this._snapper=new G.Handler.MarkerSnap(a,c);b.on("remove",function(){d.disable()})},addGuideLayer:function(a){this._snapper.addGuideLayer(a)},
_initHandlers:function(){this._verticesHandlers=[];for(var a=0;a<this.latlngs.length;a++)this._verticesHandlers.push(new G.Edit.PolyVerticesEditSnap(this._poly,this.latlngs[a],this.options))}}),G.Edit.PolyVerticesEditSnap=G.Edit.PolyVerticesEdit.extend({_createMarker:function(a,b){var c=G.Edit.PolyVerticesEdit.prototype._createMarker.call(this,a,b);if(void 0===b)c.on("dragstart",function(){this._poly.snapediting._snapper.watchMarker(c)},this);else this._poly.snapediting._snapper.watchMarker(c);return c}}),
G.EditToolbar.SnapEdit=G.EditToolbar.Edit.extend({snapOptions:{snapDistance:15,snapVertices:!0},initialize:function(a,b){G.EditToolbar.Edit.prototype.initialize.call(this,a,b);b.snapOptions&&G.Util.extend(this.snapOptions,b.snapOptions);Array.isArray(this.snapOptions.guideLayers)?this._guideLayers=this.snapOptions.guideLayers:this._guideLayers=b.guideLayers instanceof G.LayerGroup?this.snapOptions.guideLayers.getLayers():[]},addGuideLayer:function(a){-1===this._guideLayers.findIndex(function(b){return G.stamp(a)===
G.stamp(b)})&&(this._guideLayers.push(a),this._featureGroup.eachLayer(function(a){a.snapediting&&a.snapediting._guides.push(a)}))},removeGuideLayer:function(a){var b=this._guideLayers.findIndex(function(b){return G.stamp(a)===G.stamp(b)});-1!==b&&(this._guideLayers.splice(b,1),this._featureGroup.eachLayer(function(a){a.snapediting&&a.snapediting._guides.splice(b,1)}))},clearGuideLayers:function(){this._guideLayers=[];this._featureGroup.eachLayer(function(a){a.snapediting&&(a.snapediting._guides=[])})},
_enableLayerEdit:function(a){G.EditToolbar.Edit.prototype._enableLayerEdit.call(this,a);a=a.layer||a.target||a;if(!a.snapediting){a.getLatLng?a.snapediting=new G.Handler.MarkerSnap(a._map,a,this.snapOptions):(a.editing&&(a.editing._verticesHandlers[0]._markerGroup.clearLayers(),delete a.editing),a.editing=a.snapediting=new G.Handler.PolylineSnap(a._map,a,this.snapOptions));for(var b=0,c=this._guideLayers.length;b<c;b++)a.snapediting.addGuideLayer(this._guideLayers[b])}a.snapediting.enable()}}),G.Draw.Feature.SnapMixin=
{_snap_initialize:function(){this.on("enabled",this._snap_on_enabled,this);this.on("disabled",this._snap_on_disabled,this)},_snap_on_enabled:function(){if(this.options.guideLayers)if(this._mouseMarker){this._map.off("layeradd",this._snap_on_enabled,this);this._snapper||(this._snapper=new G.Handler.MarkerSnap(this._map),this.options.snapDistance&&(this._snapper.options.snapDistance=this.options.snapDistance),this.options.snapVertices&&(this._snapper.options.snapVertices=this.options.snapVertices));
for(var a=0,b=this.options.guideLayers.length;a<b;a++)this._snapper.addGuideLayer(this.options.guideLayers[a]);var c=this._mouseMarker;this._snapper.watchMarker(c);var d=c.options.icon;c.on("snap",function(a){c.setIcon(this.options.icon);c.setOpacity(1)},this).on("unsnap",function(a){c.setIcon(d);c.setOpacity(0)},this);c.on("click",this._snap_on_click,this)}else this._map.on("layeradd",this._snap_on_enabled,this)},_snap_on_click:function(a){if(this._markers){var b=this._markers[this._markers.length-
1];this._mouseMarker.snap&&(a&&(b.setLatLng(a.target._latlng),this._poly&&(this._poly._latlngs[this._poly._latlngs.length-1]=a.target._latlng,this._poly.redraw())),G.DomUtil.addClass(b._icon,"marker-snapped"))}},_snap_on_disabled:function(){delete this._snapper}},G.Draw.Feature.include(G.Draw.Feature.SnapMixin),G.Draw.Feature.addInitHook("_snap_initialize"))})();(function(a){var b;if("function"===typeof define&&define.amd)define(["goomap"],a);else if("undefined"!==typeof module)b=require("goomap"),module.exports=a(b);else{if("undefined"===typeof window.G)throw"Goomap must be loaded first";a(window.G)}})(function(a){a.Polyline._flat=a.Polyline._flat||function(b){return!a.Util.isArray(b[0])||"object"!==typeof b[0][0]&&"undefined"!==typeof b[0][0]};a.GeometryUtil=a.extend(a.GeometryUtil||{},{distance:function(a,c,d){return a.latLngToLayerPoint(c).distanceTo(a.latLngToLayerPoint(d))},
distanceSegment:function(b,c,d,e){c=b.latLngToLayerPoint(c);d=b.latLngToLayerPoint(d);b=b.latLngToLayerPoint(e);return a.LineUtil.pointToSegmentDistance(c,d,b)},readableDistance:function(a,c){var b;"imperial"!==c?b=1E3<a?(a/1E3).toFixed(2)+" km":Math.ceil(a)+" m":(a*=1.09361,b=1760<a?(a/1760).toFixed(2)+" miles":Math.ceil(a)+" yd");return b},belongsSegment:function(a,c,d,e){e=void 0===e?.2:e;var b=c.distanceTo(d);return(c.distanceTo(a)+a.distanceTo(d)-b)/b<e},length:function(b){b=a.GeometryUtil.accumulatedLengths(b);
return 0<b.length?b[b.length-1]:0},accumulatedLengths:function(a){"function"==typeof a.getLatLngs&&(a=a.getLatLngs());if(0===a.length)return[];for(var b=0,d=[0],e=0,g=a.length-1;e<g;e++)b+=a[e].distanceTo(a[e+1]),d.push(b);return d},closestOnSegment:function(b,c,d,e){var g=b.getMaxZoom();Infinity===g&&(g=b.getZoom());c=b.project(c,g);d=b.project(d,g);e=b.project(e,g);e=a.LineUtil.closestPointOnSegment(c,d,e);return b.unproject(e,g)},closest:function(b,c,d,e){var g,h=Infinity,k=null,m;if(c instanceof
Array){if(c[0]instanceof Array&&"number"!==typeof c[0][0]){for(m=0;m<c.length;m++){var l=a.GeometryUtil.closest(b,c[m],d,e);l.distance<h&&(h=l.distance,k=l)}return k}if(c[0]instanceof a.LatLng||"number"===typeof c[0][0]||"number"===typeof c[0].lat)c=a.polyline(c);else return k}if(!(c instanceof a.Polyline))return k;g=JSON.parse(JSON.stringify(c.getLatLngs().slice(0)));if(c instanceof a.Polygon){var p=function(b){if(a.Polyline._flat(b))b.push(b[0]);else for(var c=0;c<b.length;c++)p(b[c])};p(g)}if(a.Polyline._flat(g)){if(e){m=
0;for(c=g.length;m<c;m++)l=g[m],e=a.GeometryUtil.distance(b,d,l),e<h&&(h=e,k=l,k.distance=e);return k}m=0;for(c=g.length;m<c-1;m++){var l=g[m],q=g[m+1];e=a.GeometryUtil.distanceSegment(b,d,l,q);e<=h&&(h=e,k=a.GeometryUtil.closestOnSegment(b,d,l,q),k.distance=e)}}else for(m=0;m<g.length;m++)l=a.GeometryUtil.closest(b,g[m],d,e),l.distance<h&&(h=l.distance,k=l);return k},closestLayer:function(b,c,d){for(var e=Infinity,g=null,h,k=Infinity,m=0,l=c.length;m<l;m++){var p=c[m];if(p instanceof a.LayerGroup)h=
a.GeometryUtil.closestLayer(b,p.getLayers(),d),h.distance<e&&(e=h.distance,g=h);else{if("function"==typeof p.getLatLng)h=p.getLatLng(),k=a.GeometryUtil.distance(b,d,h);else if(h=a.GeometryUtil.closest(b,p,d))k=h.distance;k<e&&(e=k,g={layer:p,latlng:h,distance:k})}}return g},nClosestLayers:function(b,c,d,e){e="number"===typeof e?e:c.length;if(1>e||1>c.length)return null;for(var g=[],h,k,m=0,l=c.length;m<l;m++){var p=c[m];if(p instanceof a.LayerGroup)k=a.GeometryUtil.closestLayer(b,p.getLayers(),d),
g.push(k);else{if("function"==typeof p.getLatLng)k=p.getLatLng(),h=a.GeometryUtil.distance(b,d,k);else if(k=a.GeometryUtil.closest(b,p,d))h=k.distance;g.push({layer:p,latlng:k,distance:h})}}g.sort(function(a,b){return a.distance-b.distance});return g.length>e?g.slice(0,e):g},layersWithin:function(b,c,d,e){e="number"==typeof e?e:Infinity;for(var g=[],h=null,k=0,m=0,l=c.length;m<l;m++){var p=c[m];if("function"==typeof p.getLatLng)h=p.getLatLng(),k=a.GeometryUtil.distance(b,d,h);else if(h=a.GeometryUtil.closest(b,
p,d))k=h.distance;h&&k<e&&g.push({layer:p,latlng:h,distance:k})}return g.sort(function(a,b){return a.distance-b.distance})},closestLayerSnap:function(b,c,d,e,g){e="number"==typeof e?e:Infinity;g="boolean"==typeof g?g:!0;c=a.GeometryUtil.closestLayer(b,c,d);if(!c||c.distance>e)return null;g&&"function"==typeof c.layer.getLatLngs&&(g=a.GeometryUtil.closest(b,c.layer,c.latlng,!0),g.distance<e&&(c.latlng=g,c.distance=a.GeometryUtil.distance(b,g,d)));return c},interpolateOnPointSegment:function(b,c,d){return a.point(b.x*
(1-d)+d*c.x,b.y*(1-d)+d*c.y)},interpolateOnLine:function(b,c,d){c=c instanceof a.Polyline?c.getLatLngs():c;var e=c.length;if(2>e)return null;d=Math.max(Math.min(d,1),0);if(0===d)return{latLng:c[0]instanceof a.LatLng?c[0]:a.latLng(c[0]),predecessor:-1};if(1==d)return{latLng:c[c.length-1]instanceof a.LatLng?c[c.length-1]:a.latLng(c[c.length-1]),predecessor:c.length-2};var g=b.getMaxZoom();Infinity===g&&(g=b.getZoom());for(var h=[],k=0,m=0;m<e;m++)h[m]=b.project(c[m],g),0<m&&(k+=h[m-1].distanceTo(h[m]));
d*=k;var k=h[0],m=h[1],l=0,p=k.distanceTo(m);for(c=1;c<e&&p<d;c++)k=m,l=p,m=h[c],p+=k.distanceTo(m);e=a.GeometryUtil.interpolateOnPointSegment(k,m,0!==p-l?(d-l)/(p-l):0);return{latLng:b.unproject(e,g),predecessor:c-2}},locateOnLine:function(b,c,d){var e=c.getLatLngs();if(d.equals(e[0]))return 0;if(d.equals(e[e.length-1]))return 1;b=a.GeometryUtil.closest(b,c,d,!1);for(var g=a.GeometryUtil.accumulatedLengths(e),h=g[g.length-1],k=0,m=!1,l=0,p=e.length-1;l<p;l++){var q=e[l],r=e[l+1],k=g[l];if(a.GeometryUtil.belongsSegment(b,
q,r)){k+=q.distanceTo(b);m=!0;break}}if(!m)throw"Could not interpolate "+d.toString()+" within "+c.toString();return k/h},reverse:function(b){return a.polyline(b.getLatLngs().slice(0).reverse())},extract:function(b,c,d,e){if(d>e)return a.GeometryUtil.extract(b,a.GeometryUtil.reverse(c),1-d,1-e);d=Math.max(Math.min(d,1),0);e=Math.max(Math.min(e,1),0);var g=c.getLatLngs(),h=a.GeometryUtil.interpolateOnLine(b,c,d),k=a.GeometryUtil.interpolateOnLine(b,c,e);if(d==e)return[a.GeometryUtil.interpolateOnLine(b,
c,e).latLng];-1==h.predecessor&&(h.predecessor=0);-1==k.predecessor&&(k.predecessor=0);b=g.slice(h.predecessor+1,k.predecessor+1);b.unshift(h.latLng);b.push(k.latLng);return b},isBefore:function(a,c){if(!c)return!1;var b=a.getLatLngs(),e=c.getLatLngs();return b[b.length-1].equals(e[0])},isAfter:function(a,c){if(!c)return!1;var b=a.getLatLngs(),e=c.getLatLngs();return b[0].equals(e[e.length-1])},startsAtExtremity:function(a,c){if(!c)return!1;var b=a.getLatLngs(),e=c.getLatLngs(),b=b[0];return b.equals(e[0])||
b.equals(e[e.length-1])},computeAngle:function(a,c){return 180*Math.atan2(c.y-a.y,c.x-a.x)/Math.PI},computeSlope:function(a,c){var b=(c.y-a.y)/(c.x-a.x);return{a:b,b:a.y-b*a.x}},rotatePoint:function(b,c,d,e){var g=b.getMaxZoom();Infinity===g&&(g=b.getZoom());d=d*Math.PI/180;c=b.project(c,g);e=b.project(e,g);return b.unproject(new a.Point(Math.cos(d)*(c.x-e.x)-Math.sin(d)*(c.y-e.y)+e.x,Math.sin(d)*(c.x-e.x)+Math.cos(d)*(c.y-e.y)+e.y),g)},bearing:function(a,c){var b=Math.PI/180,e=a.lat*b,g=c.lat*b,
h=a.lng*b,b=c.lng*b,e=(180*Math.atan2(Math.sin(b-h)*Math.cos(g),Math.cos(e)*Math.sin(g)-Math.sin(e)*Math.cos(g)*Math.cos(b-h))/Math.PI+360)%360;return 180<=e?e-360:e},destination:function(b,c,d){var e=Math.PI/180,g=180/Math.PI,h=b.lat*e;c=(c+360)%360*e;var k=Math.sin(h),h=Math.cos(h),m=Math.cos(d/6378137),l=Math.sin(d/6378137);d=Math.asin(k*m+h*l*Math.cos(c));b=b.lng*e+Math.atan2(Math.sin(c)*l*h,m-k*Math.sin(d));b*=g;return a.latLng([d*g,180<b?b-360:-180>b?b+360:b])},isPointInPolygon:function(a,c){var b=
c.getLatLngs()[0],e=b.length,g=0,h,k;h=b[0];for(var m=1;m<=e;++m){if(a.equals(h))return!0;k=b[m%e];if(!(a.lat<Math.min(h.lat,k.lat)||a.lat>Math.max(h.lat,k.lat)))if(a.lat>Math.min(h.lat,k.lat)&&a.lat<Math.max(h.lat,k.lat)){if(a.lng<=Math.max(h.lng,k.lng)){if(h.lat==k.lat&&a.lng>=Math.min(h.lng,k.lng))return!0;if(h.lng==k.lng){if(h.lng==a.lng)return!0;++g}else{h=(a.lat-h.lat)*(k.lng-h.lng)/(k.lat-h.lat)+h.lng;if(2E-10>Math.abs(a.lng-h))return!0;a.lng<h&&++g}}}else if(a.lat==k.lat&&a.lng<=k.lng){var l=
b[(m+1)%e];a.lat>=Math.min(h.lat,l.lat)&&a.lat<=Math.max(h.lat,l.lat)?++g:g+=2}h=k}return 0==g%2?!1:!0}});return a.GeometryUtil});(function(a){function b(a){for(var b={},c=k.exec(a);c;)b[c[1]]=c[2],c=k.exec(a);return b}function c(a){var b="",c;for(c in a)b+=c+": "+a[c]+"; ";return b}function d(a,b,c,d){var e=Math.round(a+2*Math.cos(c)*d),g=Math.round(b+2*Math.sin(c)*d);c=Math.abs(e-a);for(var e=a<e?1:-1,h=Math.abs(g-b),g=b<g?1:-1,k=(c>h?c:-h)/2,l,m=[],u=0;;){m.push([a,b]);u++;if(u===d)break;l=k;l>-c&&(k-=h,a+=e);l<h&&(k+=c,b+=g)}return m}function e(a,b,c,d){var e=[];for(d+=1;d--;)e[d]=" matrix3d(1,0,0,0,0,"+(c-d)/c+",0,0,0,0,1,0,"+
a+","+(b+d)+",0,1) ";return e}function g(a,b){var c=b+a,d=[],e;if(l[c])return l[c];for(e=1;e<=a;)d.push(e++);for(e=a;e--;)d.push(e);return l[c]=d}function h(a,b,c){c=c+a+"_"+b;var d=[],e=[],g=0,h;if(l[c])return l[c];d[a]=b;d[0]=0;for(h=a;--h;)d[h]=Math.round(b/(a-h));for(h=a;h--;)d.push(d[h]);h=0;for(a=d.length;h<a;h++)g+=d[h],e.push(g);return l[c]=e}var k=/([\w-]+): ([^;]+);/g,m={transform:"transform",WebkitTransform:"-webkit-transform",OTransform:"-o-transform",MozTransform:"-moz-transform",msTransform:"-ms-transform"}[a.DomUtil.TRANSFORM],
l={};a.Marker._bouncingMarkers=[];a.Marker.setBouncingOptions=function(b){a.extend(a.Marker.prototype._bouncingOptions,b)};a.Marker.getBouncingMarkers=function(){return a.Marker._bouncingMarkers};a.Marker.stopAllBouncingMarkers=function(){for(var b;b=a.Marker._bouncingMarkers.shift();)b._bouncingMotion.isBouncing=!1};a.Marker._addBouncingMarker=function(b,c){c||b._bouncingOptions.exclusive?a.Marker.stopAllBouncingMarkers():a.Marker._stopEclusiveMarkerBouncing();a.Marker._bouncingMarkers.push(b)};
a.Marker._removeBouncingMarker=function(b){var c=a.Marker._bouncingMarkers.length;if(c)for(;c--;)if(a.Marker._bouncingMarkers[c]==b){a.Marker._bouncingMarkers.splice(c,1);break}};a.Marker._stopEclusiveMarkerBouncing=function(){var b=a.Marker._bouncingMarkers.length;if(b)for(;b--;)a.Marker._bouncingMarkers[b]._bouncingOptions.exclusive&&(a.Marker._bouncingMarkers[b]._bouncingMotion.isBouncing=!1,a.Marker._bouncingMarkers.splice(b,1))};a.Marker.include({_bouncingOptions:{bounceHeight:15,contractHeight:12,
bounceSpeed:52,contractSpeed:52,shadowAngle:-Math.PI/4,elastic:!0,exclusive:!1},setBouncingOptions:function(b){this.hasOwnProperty("_bouncingOptions")||(this._bouncingOptions=a.extend({},a.Marker.prototype._bouncingOptions));a.extend(this._bouncingOptions,b);this._calculateTimeline();this._calculateTransforms();return this},isBouncing:function(){return this._bouncingMotion.isBouncing},bounce:function(){function b(a){k.style.cssText=xa+"z-index: "+h._zIndex+";"+m+": "+q.iconMoveTransforms[a];l&&(l.style.cssText=
Q+m+": "+q.shadowMoveTransforms[a])}function c(a){k.style.cssText=xa+"z-index: "+h._zIndex+";";k.style.left=q.iconMovePoints[a][0]+"px";k.style.top=q.iconMovePoints[a][1]+"px";l&&(l.style.cssText=Q,l.style.left=q.shadowMovePoints[a][0]+"px",l.style.top=q.shadowMovePoints[a][1]+"px")}function d(a){k.style.cssText=xa+"z-index: "+h._zIndex+";"+m+": "+q.iconResizeTransforms[a];l&&null!=O&&(l.style.cssText=Q+m+": "+q.shadowResizeTransforms[a])}function e(){null===Ma||--Ma||(q.isBouncing=!1);var a=la;if(db)for(;a--;)setTimeout(b,
y[a],E[a]);else for(;a--;)setTimeout(c,y[a],E[a]);setTimeout(function(){H&&db?g():q.isBouncing&&setTimeout(e,C)},y[la-1])}function g(){for(var a=La;a--;)setTimeout(d,wa[a],F[a]);setTimeout(function(){q.isBouncing&&e()},wa[La-1])}var h=this,k=this._icon,l=this._shadow,p=h._bouncingOptions,q=h._bouncingMotion,C=p.bounceSpeed,O=p.shadowAngle,H=p.elastic,p=p.exclusive,E=q.moveSteps,y=q.moveDelays,F=q.resizeSteps,wa=q.resizeDelays,la=E.length,La=F.length,xa=q.baseIconCssText,Q=q.baseShadowCssText,db=a.Browser.any3d,
Ma=null;1==arguments.length&&(Ma=arguments[0]);a.Marker._addBouncingMarker(h,p);q.isBouncing=!0;e();return h},stopBouncing:function(){this._bouncingMotion.isBouncing=!1;a.Marker._removeBouncingMarker(this);return this},toggleBouncing:function(){this._bouncingMotion.isBouncing?this.stopBouncing():this.bounce();return this},_calculateTimeline:function(){this._bouncingMotion.moveSteps=g(this._bouncingOptions.bounceHeight,"moveSteps_");this._bouncingMotion.moveDelays=h(this._bouncingOptions.bounceHeight,
this._bouncingOptions.bounceSpeed,"moveDelays_");this._bouncingOptions.elastic&&(this._bouncingMotion.resizeSteps=g(this._bouncingOptions.contractHeight,"resizeSteps_"),this._bouncingMotion.resizeDelays=h(this._bouncingOptions.contractHeight,this._bouncingOptions.contractSpeed,"resizeDelays_"))},_calculateTransforms:function(){if(a.Browser.any3d){for(var b=this.options.icon.options.iconSize?this.options.icon.options.iconSize[1]:this._iconObj.options.iconSize[1],c=this._bouncingMotion,g=this._bouncingMotion.x,
h=this._bouncingMotion.y,k=[],l=this._bouncingOptions.bounceHeight+1;l--;)k[l]=" matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,"+g+","+(h-l)+",0,1) ";c.iconMoveTransforms=k;this._bouncingMotion.iconResizeTransforms=e(this._bouncingMotion.x,this._bouncingMotion.y,b,this._bouncingOptions.contractHeight);if(this._shadow){var b=this._bouncingMotion,c=this._bouncingMotion.x,g=this._bouncingMotion.y,h=this._bouncingOptions.bounceHeight,m=this._bouncingOptions.shadowAngle,k=[],l=h+1;if(null!=m)m=d(c,g,m,h+1);else for(var m=
[],p=0;p<=h;p++)m[p]=[c,g];for(;l--;)k[l]=" matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,"+m[l][0]+","+m[l][1]+",0,1) ";b.shadowMoveTransforms=k;this._bouncingMotion.shadowResizeTransforms=e(this._bouncingMotion.x,this._bouncingMotion.y,this.options.icon.options.shadowSize[1],this._bouncingOptions.contractHeight)}}else{b=this._bouncingMotion;c=this._bouncingMotion.x;g=this._bouncingMotion.y;h=[];for(k=this._bouncingOptions.bounceHeight+1;k--;)h[k]=[c,g-k];b.iconMovePoints=h;b=this._bouncingMotion;c=this._bouncingMotion.x;
g=this._bouncingMotion.y;h=this._bouncingOptions.bounceHeight;k=this._bouncingOptions.shadowAngle;if(null!=k)c=d(c,g,k,h+1);else{k=[];for(l=0;l<=h;l++)k[l]=[c,g];c=k}b.shadowMovePoints=c}}});a.Marker.addInitHook(function(){this._bouncingMotion={isBouncing:!1};this._calculateTimeline()});var p=a.Marker.prototype._setPos,q=a.Marker.prototype.onAdd;a.Marker.prototype._setPos=function(a){p.call(this,a);this._bouncingMotion.x=a.x;this._bouncingMotion.y=a.y;this._calculateTransforms()};a.Marker.prototype.onAdd=
function(a){q.call(this,a);a=b(this._icon.style.cssText);delete a[m];delete a["z-index"];a.opacity=this.options.opacityWhenUnclustered||this.options.opacity||1;this._bouncingMotion.baseIconCssText=c(a);this._shadow&&(a=b(this._shadow.style.cssText),delete a[m],delete a.opacity,this._bouncingMotion.baseShadowCssText=c(a));this._bouncingMotion.isBouncing&&this.bounce()}})(G);G.MarkerCluster=G.Marker.extend({initialize:function(a,b,c,d){G.Marker.prototype.initialize.call(this,c?c._cLatLng||c.getLatLng():new G.LatLng(0,0),{icon:this});this._group=a;this._zoom=b;this._markers=[];this._childClusters=[];this._childCount=0;this._boundsNeedUpdate=this._iconNeedsUpdate=!0;this._bounds=new G.LatLngBounds;c&&this._addChild(c);d&&this._addChild(d)},getAllChildMarkers:function(a){a=a||[];for(var b=this._childClusters.length-1;0<=b;b--)this._childClusters[b].getAllChildMarkers(a);
for(b=this._markers.length-1;0<=b;b--)a.push(this._markers[b]);return a},getChildCount:function(){return this._childCount},zoomToBounds:function(){for(var a=this._childClusters.slice(),b=this._group._map,c=b.getBoundsZoom(this._bounds),d=this._zoom+1,b=b.getZoom(),e;0<a.length&&c>d;){d++;var g=[];for(e=0;e<a.length;e++)g=g.concat(a[e]._childClusters);a=g}c>d?this._group._map.setView(this._latlng,d):c<=b?this._group._map.setView(this._latlng,b+1):this._group._map.fitBounds(this._bounds)},getBounds:function(){var a=
new G.LatLngBounds;a.extend(this._bounds);return a},_updateIcon:function(){this._iconNeedsUpdate=!0;this._icon&&this.setIcon(this)},createIcon:function(){this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1);return this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(a,b){this._boundsNeedUpdate=this._iconNeedsUpdate=!0;this._setClusterCenter(a);a instanceof G.MarkerCluster?(b||(this._childClusters.push(a),
a.__parent=this),this._childCount+=a._childCount):(b||this._markers.push(a),this._childCount++);this.__parent&&this.__parent._addChild(a,!0)},_setClusterCenter:function(a){this._cLatLng||(this._cLatLng=a._cLatLng||a._latlng)},_resetBounds:function(){var a=this._bounds;a._southWest&&(a._southWest.lat=Infinity,a._southWest.lng=Infinity);a._northEast&&(a._northEast.lat=-Infinity,a._northEast.lng=-Infinity)},_recalculateBounds:function(){var a=this._markers,b=this._childClusters,c=0,d=0,e=this._childCount,
g,h;if(0!==e){this._resetBounds();for(g=0;g<a.length;g++)h=a[g]._latlng,this._bounds.extend(h),c+=h.lat,d+=h.lng;for(g=0;g<b.length;g++)a=b[g],a._boundsNeedUpdate&&a._recalculateBounds(),this._bounds.extend(a._bounds),h=a._wLatLng,a=a._childCount,c+=h.lat*a,d+=h.lng*a;this._latlng=this._wLatLng=new G.LatLng(c/e,d/e);this._boundsNeedUpdate=!1}},_addToMap:function(a){a&&(this._backupLatlng=this._latlng,this.setLatLng(a));this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(a,
b,c){this._recursively(a,0,c-1,function(a){a=a._markers;var c,d;for(c=a.length-1;0<=c;c--)d=a[c],d._icon&&(d._setPos(b),d.clusterHide())},function(a){a=a._childClusters;var c,d;for(c=a.length-1;0<=c;c--)d=a[c],d._icon&&(d._setPos(b),d.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(a,b,c){this._recursively(a,c,0,function(d){d._recursivelyAnimateChildrenIn(a,d._group._map.latLngToLayerPoint(d.getLatLng()).round(),b);d._isSingleParent()&&b-1===c?(d.clusterShow(),d._recursivelyRemoveChildrenFromMap(a,
b)):d.clusterHide();d._addToMap()})},_recursivelyBecomeVisible:function(a,b){this._recursively(a,0,b,null,function(a){a.clusterShow()})},_recursivelyAddChildrenToMap:function(a,b,c){this._recursively(c,-1,b,function(d){if(b!==d._zoom)for(var e=d._markers.length-1;0<=e;e--){var g=d._markers[e];c.contains(g._latlng)&&(a&&(g._backupLatlng=g.getLatLng(),g.setLatLng(a),g.clusterHide&&g.clusterHide()),d._group._featureGroup.addLayer(g))}},function(b){b._addToMap(a)})},_recursivelyRestoreChildPositions:function(a){for(var b=
this._markers.length-1;0<=b;b--){var c=this._markers[b];c._backupLatlng&&(c.setLatLng(c._backupLatlng),delete c._backupLatlng)}if(a-1===this._zoom)for(a=this._childClusters.length-1;0<=a;a--)this._childClusters[a]._restorePosition();else for(b=this._childClusters.length-1;0<=b;b--)this._childClusters[b]._recursivelyRestoreChildPositions(a)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(a,b,
c){var d,e;this._recursively(a,-1,b-1,function(a){for(e=a._markers.length-1;0<=e;e--)d=a._markers[e],c&&c.contains(d._latlng)||(a._group._featureGroup.removeLayer(d),d.clusterShow&&d.clusterShow())},function(a){for(e=a._childClusters.length-1;0<=e;e--)d=a._childClusters[e],c&&c.contains(d._latlng)||(a._group._featureGroup.removeLayer(d),d.clusterShow&&d.clusterShow())})},_recursively:function(a,b,c,d,e){var g=this._childClusters,h=this._zoom,k;if(b>h)for(h=g.length-1;0<=h;h--)k=g[h],a.intersects(k._bounds)&&
k._recursively(a,b,c,d,e);else if(d&&d(this),e&&this._zoom===c&&e(this),c>h)for(h=g.length-1;0<=h;h--)k=g[h],a.intersects(k._bounds)&&k._recursively(a,b,c,d,e)},_isSingleParent:function(){return 0<this._childClusters.length&&this._childClusters[0]._childCount===this._childCount}});G.DistanceGrid=function(a){this._cellSize=a;this._sqCellSize=a*a;this._grid={};this._objectPoint={}};
G.DistanceGrid.prototype={addObject:function(a,b){var c=this._getCoord(b.x),d=this._getCoord(b.y),e=this._grid,d=e[d]=e[d]||{},c=d[c]=d[c]||[],d=G.Util.stamp(a);this._objectPoint[d]=b;c.push(a)},updateObject:function(a,b){this.removeObject(a);this.addObject(a,b)},removeObject:function(a,b){var c=this._getCoord(b.x),d=this._getCoord(b.y),e=this._grid,d=e[d]=e[d]||{},e=d[c]=d[c]||[],g,h;delete this._objectPoint[G.Util.stamp(a)];g=0;for(h=e.length;g<h;g++)if(e[g]===a)return e.splice(g,1),1===h&&delete d[c],
!0},eachObject:function(a,b){var c,d,e,g,h,k,m,l=this._grid;for(c in l)for(d in h=l[c],h)for(k=h[d],e=0,g=k.length;e<g;e++)if(m=a.call(b,k[e]))e--,g--},getNearObject:function(a){var b=this._getCoord(a.x),c=this._getCoord(a.y),d,e,g,h,k,m,l,p,q=this._objectPoint,r=this._sqCellSize,u=null;for(d=c-1;d<=c+1;d++)if(h=this._grid[d])for(e=b-1;e<=b+1;e++)if(k=h[e])for(g=0,m=k.length;g<m;g++)l=k[g],p=this._sqDist(q[G.Util.stamp(l)],a),p<r&&(r=p,u=l);return u},_getCoord:function(a){return Math.floor(a/this._cellSize)},
_sqDist:function(a,b){var c=b.x-a.x,d=b.y-a.y;return c*c+d*d}};
G.MarkerClusterGroup=G.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(a){G.Util.setOptions(this,
a);this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction);this._featureGroup=G.featureGroup();this._featureGroup.addEventParent(this);this._nonPointGroup=G.featureGroup();this._nonPointGroup.addEventParent(this);this._inZoomAnimation=0;this._needsClustering=[];this._needsRemoving=[];this._currentShownBounds=null;this._queue=[];a=G.DomUtil.TRANSITION&&this.options.animate;G.extend(this,a?this._withAnimation:this._noAnimation);this._markerCluster=a?G.MarkerCluster:
G.MarkerClusterNonAnimated},addLayer:function(a){if(a instanceof G.LayerGroup)return this.addLayers([a]);if(!a.getLatLng)return this._nonPointGroup.addLayer(a),this;if(!this._map)return this._needsClustering.push(a),this;if(this.hasLayer(a))return this;this._unspiderfy&&this._unspiderfy();this._addLayer(a,this._maxZoom);this._topClusterLevel._recalculateBounds();this._refreshClustersIcons();var b=a,c=this._map.getZoom();if(a.__parent)for(;b.__parent._zoom>=c;)b=b.__parent;this._currentShownBounds.contains(b.getLatLng())&&
(this.options.animateAddingMarkers?this._animationAddLayer(a,b):this._animationAddLayerNonAnimated(a,b));return this},removeLayer:function(a){if(a instanceof G.LayerGroup)return this.removeLayers([a]);if(!a.getLatLng)return this._nonPointGroup.removeLayer(a),this;if(!this._map)return!this._arraySplice(this._needsClustering,a)&&this.hasLayer(a)&&this._needsRemoving.push(a),this;if(!a.__parent)return this;this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(a));this._removeLayer(a,!0);this._topClusterLevel._recalculateBounds();
this._refreshClustersIcons();a.off("move",this._childMarkerMoved,this);this._featureGroup.hasLayer(a)&&(this._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow());return this},addLayers:function(a){if(!G.Util.isArray(a))return this.addLayer(a);var b=this._featureGroup,c=this._nonPointGroup,d=this.options.chunkedLoading,e=this.options.chunkInterval,g=this.options.chunkProgress,h=a.length,k=0,m=!0,l;if(this._map){var p=(new Date).getTime(),q=G.bind(function(){for(var u=(new Date).getTime();k<
h&&!(d&&0===k%200&&(new Date).getTime()-u>e);k++)if(l=a[k],l instanceof G.LayerGroup)m&&(a=a.slice(),m=!1),this._extractNonGroupLayers(l,a),h=a.length;else if(!l.getLatLng)c.addLayer(l);else if(!this.hasLayer(l)&&(this._addLayer(l,this._maxZoom),l.__parent&&2===l.__parent.getChildCount())){var D=l.__parent.getAllChildMarkers();b.removeLayer(D[0]===l?D[1]:D[0])}g&&g(k,h,(new Date).getTime()-p);k===h?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,
this._zoom,this._currentShownBounds)):setTimeout(q,this.options.chunkDelay)},this);q()}else for(var r=this._needsClustering;k<h;k++)l=a[k],l instanceof G.LayerGroup?(m&&(a=a.slice(),m=!1),this._extractNonGroupLayers(l,a),h=a.length):l.getLatLng?this.hasLayer(l)||r.push(l):c.addLayer(l);return this},removeLayers:function(a){var b,c,d=a.length,e=this._featureGroup,g=this._nonPointGroup,h=!0;if(!this._map){for(b=0;b<d;b++)c=a[b],c instanceof G.LayerGroup?(h&&(a=a.slice(),h=!1),this._extractNonGroupLayers(c,
a),d=a.length):(this._arraySplice(this._needsClustering,c),g.removeLayer(c),this.hasLayer(c)&&this._needsRemoving.push(c));return this}if(this._unspiderfy){this._unspiderfy();var k=a.slice(),m=d;for(b=0;b<m;b++)c=k[b],c instanceof G.LayerGroup?(this._extractNonGroupLayers(c,k),m=k.length):this._unspiderfyLayer(c)}for(b=0;b<d;b++)c=a[b],c instanceof G.LayerGroup?(h&&(a=a.slice(),h=!1),this._extractNonGroupLayers(c,a),d=a.length):c.__parent?(this._removeLayer(c,!0,!0),e.hasLayer(c)&&(e.removeLayer(c),
c.clusterShow&&c.clusterShow())):g.removeLayer(c);this._topClusterLevel._recalculateBounds();this._refreshClustersIcons();this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds);return this},clearLayers:function(){this._map||(this._needsClustering=[],delete this._gridClusters,delete this._gridUnclustered);this._noanimationUnspiderfy&&this._noanimationUnspiderfy();this._featureGroup.clearLayers();this._nonPointGroup.clearLayers();this.eachLayer(function(a){a.off("move",
this._childMarkerMoved,this);delete a.__parent});this._map&&this._generateInitialClusters();return this},getBounds:function(){var a=new G.LatLngBounds;this._topClusterLevel&&a.extend(this._topClusterLevel._bounds);for(var b=this._needsClustering.length-1;0<=b;b--)a.extend(this._needsClustering[b].getLatLng());a.extend(this._nonPointGroup.getBounds());return a},eachLayer:function(a,b){var c=this._needsClustering.slice(),d=this._needsRemoving,e;this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(c);
for(e=c.length-1;0<=e;e--)-1===d.indexOf(c[e])&&a.call(b,c[e]);this._nonPointGroup.eachLayer(a,b)},getLayers:function(){var a=[];this.eachLayer(function(b){a.push(b)});return a},getLayer:function(a){var b=null;a=parseInt(a,10);this.eachLayer(function(c){G.stamp(c)===a&&(b=c)});return b},hasLayer:function(a){if(!a)return!1;var b,c=this._needsClustering;for(b=c.length-1;0<=b;b--)if(c[b]===a)return!0;c=this._needsRemoving;for(b=c.length-1;0<=b;b--)if(c[b]===a)return!1;return!(!a.__parent||a.__parent._group!==
this)||this._nonPointGroup.hasLayer(a)},zoomToShowLayer:function(a,b){"function"!==typeof b&&(b=function(){});var c=function(){!a._icon&&!a.__parent._icon||this._inZoomAnimation||(this._map.off("moveend",c,this),this.off("animationend",c,this),a._icon?b():a.__parent._icon&&(this.once("spiderfied",b,this),a.__parent.spiderfy()))};if(a._icon&&this._map.getBounds().contains(a.getLatLng()))b();else if(a.__parent._zoom<this._map.getZoom())this._map.on("moveend",c,this),this._map.panTo(a.getLatLng());else{var d=
function(){this._map.off("movestart",d,this);d=null};this._map.on("movestart",d,this);this._map.on("moveend",c,this);this.on("animationend",c,this);a.__parent.zoomToBounds();d&&c.call(this)}},onAdd:function(a){this._map=a;var b,c;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";this._featureGroup.addTo(a);this._nonPointGroup.addTo(a);this._gridClusters||this._generateInitialClusters();this._maxLat=a.options.crs.projection.MAX_LATITUDE;a=0;for(b=this._needsRemoving.length;a<
b;a++)c=this._needsRemoving[a],this._removeLayer(c,!0);this._needsRemoving=[];this._zoom=this._map.getZoom();this._currentShownBounds=this._getExpandedVisibleBounds();this._map.on("zoomend",this._zoomEnd,this);this._map.on("moveend",this._moveEnd,this);this._spiderfierOnAdd&&this._spiderfierOnAdd();this._bindEvents();b=this._needsClustering;this._needsClustering=[];this.addLayers(b)},onRemove:function(a){a.off("zoomend",this._zoomEnd,this);a.off("moveend",this._moveEnd,this);this._unbindEvents();
this._map._mapPane.className=this._map._mapPane.className.replace(" bubble-cluster-anim","");this._spiderfierOnRemove&&this._spiderfierOnRemove();delete this._maxLat;this._hideCoverage();this._featureGroup.remove();this._nonPointGroup.remove();this._featureGroup.clearLayers();this._map=null},getVisibleParent:function(a){for(;a&&!a._icon;)a=a.__parent;return a||null},_arraySplice:function(a,b){for(var c=a.length-1;0<=c;c--)if(a[c]===b)return a.splice(c,1),!0},_removeFromGridUnclustered:function(a,
b){for(var c=this._map,d=this._gridUnclustered;0<=b&&d[b].removeObject(a,c.project(a.getLatLng(),b));b--);},_childMarkerMoved:function(a){this._ignoreMove||(a.target._latlng=a.oldLatLng,this.removeLayer(a.target),a.target._latlng=a.latlng,this.addLayer(a.target))},_removeLayer:function(a,b,c){var d=this._gridClusters,e=this._gridUnclustered,g=this._featureGroup,h=this._map;b&&this._removeFromGridUnclustered(a,this._maxZoom);var k=a.__parent,m;for(this._arraySplice(k._markers,a);k;){k._childCount--;
k._boundsNeedUpdate=!0;if(0>k._zoom)break;else b&&1>=k._childCount?(m=k._markers[0]===a?k._markers[1]:k._markers[0],d[k._zoom].removeObject(k,h.project(k._cLatLng,k._zoom)),e[k._zoom].addObject(m,h.project(m.getLatLng(),k._zoom)),this._arraySplice(k.__parent._childClusters,k),k.__parent._markers.push(m),m.__parent=k.__parent,k._icon&&(g.removeLayer(k),c||g.addLayer(m))):k._iconNeedsUpdate=!0;k=k.__parent}delete a.__parent},_isOrIsParent:function(a,b){for(;b;){if(a===b)return!0;b=b.parentNode}return!1},
fire:function(a,b,c){if(b&&b.layer instanceof G.MarkerCluster){if(b.originalEvent&&this._isOrIsParent(b.layer._icon,b.originalEvent.relatedTarget))return;a="cluster"+a}G.FeatureGroup.prototype.fire.call(this,a,b,c)},listens:function(a,b){return G.FeatureGroup.prototype.listens.call(this,a,b)||G.FeatureGroup.prototype.listens.call(this,"cluster"+a,b)},_defaultIconCreateFunction:function(a){a=a.getChildCount();var b=" marker-cluster-";return new G.DivIcon({html:"<div><span>"+a+"</span></div>",className:"marker-cluster"+
(10>a?b+"small":100>a?b+"medium":b+"large"),iconSize:new G.Point(40,40)})},_bindEvents:function(){var a=this._map,b=this.options.showCoverageOnHover,c=this.options.zoomToBoundsOnClick;if(this.options.spiderfyOnMaxZoom||c)this.on("clusterclick",this._zoomOrSpiderfy,this);b&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),a.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(a){for(var b=a.layer,c=b;1===c._childClusters.length;)c=
c._childClusters[0];c._zoom===this._maxZoom&&c._childCount===b._childCount&&this.options.spiderfyOnMaxZoom?b.spiderfy():this.options.zoomToBoundsOnClick&&b.zoomToBounds();a.originalEvent&&13===a.originalEvent.keyCode&&this._map._container.focus()},_showCoverage:function(a){var b=this._map;this._inZoomAnimation||(this._shownPolygon&&b.removeLayer(this._shownPolygon),2<a.layer.getChildCount()&&a.layer!==this._spiderfied&&(this._shownPolygon=new G.Polygon(a.layer.getConvexHull(),this.options.polygonOptions),
b.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var a=this.options.showCoverageOnHover,b=this.options.zoomToBoundsOnClick,c=this._map;(this.options.spiderfyOnMaxZoom||b)&&this.off("clusterclick",this._zoomOrSpiderfy,this);a&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),c.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&
(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var a=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,a);this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),a);this._currentShownBounds=a}},_generateInitialClusters:function(){var a=this._map.getMaxZoom(),b=this.options.maxClusterRadius,
c=b;"function"!==typeof b&&(c=function(){return b});this.options.disableClusteringAtZoom&&(a=this.options.disableClusteringAtZoom-1);this._maxZoom=a;this._gridClusters={};for(this._gridUnclustered={};0<=a;a--)this._gridClusters[a]=new G.DistanceGrid(c(a)),this._gridUnclustered[a]=new G.DistanceGrid(c(a));this._topClusterLevel=new this._markerCluster(this,-1)},_addLayer:function(a,b){var c=this._gridClusters,d=this._gridUnclustered,e;this.options.singleMarkerMode&&this._overrideMarkerIcon(a);for(a.on("move",
this._childMarkerMoved,this);0<=b;b--){e=this._map.project(a.getLatLng(),b);var g=c[b].getNearObject(e);if(g){g._addChild(a);a.__parent=g;return}if(g=d[b].getNearObject(e)){(d=g.__parent)&&this._removeLayer(g,!1);e=new this._markerCluster(this,b,g,a);c[b].addObject(e,this._map.project(e._cLatLng,b));g.__parent=e;var h=a.__parent=e;for(e=b-1;e>d._zoom;e--)h=new this._markerCluster(this,e,h),c[e].addObject(h,this._map.project(g.getLatLng(),e));d._addChild(h);this._removeFromGridUnclustered(g,b);return}d[b].addObject(a,
e)}this._topClusterLevel._addChild(a);a.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(a){a instanceof G.MarkerCluster&&a._iconNeedsUpdate&&a._updateIcon()})},_enqueue:function(a){this._queue.push(a);this._queueTimeout||(this._queueTimeout=setTimeout(G.bind(this._processQueue,this),300))},_processQueue:function(){for(var a=0;a<this._queue.length;a++)this._queue[a].call(this);this._queue.length=0;clearTimeout(this._queueTimeout);this._queueTimeout=
null},_mergeSplitClusters:function(){var a=Math.round(this._map._zoom);this._processQueue();this._zoom<a&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,a)):this._zoom>a?(this._animationStart(),this._animationZoomOut(this._zoom,a)):this._moveEnd()},_getExpandedVisibleBounds:function(){return this.options.removeOutsideVisibleBounds?
G.Browser.mobile?this._checkBoundsMaxLat(this._map.getBounds()):this._checkBoundsMaxLat(this._map.getBounds().pad(1)):this._mapBoundsInfinite},_checkBoundsMaxLat:function(a){var b=this._maxLat;void 0!==b&&(a.getNorth()>=b&&(a._northEast.lat=Infinity),a.getSouth()<=-b&&(a._southWest.lat=-Infinity));return a},_animationAddLayerNonAnimated:function(a,b){if(b===a)this._featureGroup.addLayer(a);else if(2===b._childCount){b._addToMap();var c=b.getAllChildMarkers();this._featureGroup.removeLayer(c[0]);this._featureGroup.removeLayer(c[1])}else b._updateIcon()},
_extractNonGroupLayers:function(a,b){var c=a.getLayers(),d=0,e;for(b=b||[];d<c.length;d++)e=c[d],e instanceof G.LayerGroup?this._extractNonGroupLayers(e,b):b.push(e);return b},_overrideMarkerIcon:function(a){return a.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[a]}})}});G.MarkerClusterGroup.include({_mapBoundsInfinite:new G.LatLngBounds(new G.LatLng(-Infinity,-Infinity),new G.LatLng(Infinity,Infinity))});
G.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(a,b){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,a);this._topClusterLevel._recursivelyAddChildrenToMap(null,b,this._getExpandedVisibleBounds());this.fire("animationend")},_animationZoomOut:function(a,b){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,a);this._topClusterLevel._recursivelyAddChildrenToMap(null,b,this._getExpandedVisibleBounds());
this.fire("animationend")},_animationAddLayer:function(a,b){this._animationAddLayerNonAnimated(a,b)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" bubble-cluster-anim";this._inZoomAnimation++},_animationZoomIn:function(a,b){var c=this._getExpandedVisibleBounds(),d=this._featureGroup,e;this._ignoreMove=!0;this._topClusterLevel._recursively(c,a,0,function(g){var h=g._latlng,k=g._markers;c.contains(h)||(h=null);g._isSingleParent()&&a+1===b?(d.removeLayer(g),g._recursivelyAddChildrenToMap(null,
b,c)):(g.clusterHide(),g._recursivelyAddChildrenToMap(h,b,c));for(e=k.length-1;0<=e;e--)g=k[e],c.contains(g._latlng)||d.removeLayer(g)});this._forceLayout();this._topClusterLevel._recursivelyBecomeVisible(c,b);d.eachLayer(function(a){a instanceof G.MarkerCluster||!a._icon||a.clusterShow()});this._topClusterLevel._recursively(c,a,b,function(a){a._recursivelyRestoreChildPositions(b)});this._ignoreMove=!1;this._enqueue(function(){this._topClusterLevel._recursively(c,a,0,function(a){d.removeLayer(a);
a.clusterShow()});this._animationEnd()})},_animationZoomOut:function(a,b){this._animationZoomOutSingle(this._topClusterLevel,a-1,b);this._topClusterLevel._recursivelyAddChildrenToMap(null,b,this._getExpandedVisibleBounds());this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,a,this._getExpandedVisibleBounds())},_animationAddLayer:function(a,b){var c=this,d=this._featureGroup;d.addLayer(a);b!==a&&(2<b._childCount?(b._updateIcon(),this._forceLayout(),this._animationStart(),
a._setPos(this._map.latLngToLayerPoint(b.getLatLng())),a.clusterHide(),this._enqueue(function(){d.removeLayer(a);a.clusterShow();c._animationEnd()})):(this._forceLayout(),c._animationStart(),c._animationZoomOutSingle(b,this._map.getMaxZoom(),this._map.getZoom())))}},_animationZoomOutSingle:function(a,b,c){var d=this._getExpandedVisibleBounds();a._recursivelyAnimateChildrenInAndAddSelfToMap(d,b+1,c);var e=this;this._forceLayout();a._recursivelyBecomeVisible(d,c);this._enqueue(function(){if(1===a._childCount){var g=
a._markers[0];this._ignoreMove=!0;g.setLatLng(g.getLatLng());this._ignoreMove=!1;g.clusterShow&&g.clusterShow()}else a._recursively(d,c,0,function(a){a._recursivelyRemoveChildrenFromMap(d,b+1)});e._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" bubble-cluster-anim",""));this._inZoomAnimation--;this.fire("animationend")},_forceLayout:function(){G.Util.falseFn(document.body.offsetWidth)}});G.markerClusterGroup=function(a){return new G.MarkerClusterGroup(a)};
G.MarkerClusterGroup.include({refreshClusters:function(a){a?a instanceof G.MarkerClusterGroup?a=a._topClusterLevel.getAllChildMarkers():a instanceof G.LayerGroup?a=a._layers:a instanceof G.MarkerCluster?a=a.getAllChildMarkers():a instanceof G.Marker&&(a=[a]):a=this._topClusterLevel.getAllChildMarkers();this._flagParentsIconsNeedUpdate(a);this._refreshClustersIcons();this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(a);return this},_flagParentsIconsNeedUpdate:function(a){var b,c;
for(b in a)for(c=a[b].__parent;c;)c._iconNeedsUpdate=!0,c=c.__parent},_refreshSingleMarkerModeMarkers:function(a){var b,c;for(b in a)c=a[b],this.hasLayer(c)&&c.setIcon(this._overrideMarkerIcon(c))}});G.Marker.include({refreshIconOptions:function(a,b){var c=this.options.icon;G.setOptions(c,a);this.setIcon(c);b&&this.__parent&&this.__parent._group.refreshClusters(this);return this}});
(function(){G.QuickHull={getDistant:function(a,b){return(b[0].lng-b[1].lng)*(a.lat-b[0].lat)+(b[1].lat-b[0].lat)*(a.lng-b[0].lng)},findMostDistantPointFromBaseLine:function(a,b){var c=0,d=null,e=[],g,h,k;for(g=b.length-1;0<=g;g--)h=b[g],k=this.getDistant(h,a),0<k&&(e.push(h),k>c&&(c=k,d=h));return{maxPoint:d,newPoints:e}},buildConvexHull:function(a,b){var c=[],d=this.findMostDistantPointFromBaseLine(a,b);return d.maxPoint?(c=c.concat(this.buildConvexHull([a[0],d.maxPoint],d.newPoints)),c=c.concat(this.buildConvexHull([d.maxPoint,
a[1]],d.newPoints))):[a[0]]},getConvexHull:function(a){var b=!1,c=!1,d=!1,e=!1,g=null,h=null,k=null,m=null,l;for(l=a.length-1;0<=l;l--){var p=a[l];if(!1===b||p.lat>b)g=p,b=p.lat;if(!1===c||p.lat<c)h=p,c=p.lat;if(!1===d||p.lng>d)k=p,d=p.lng;if(!1===e||p.lng<e)m=p,e=p.lng}c!==b?b=h:(b=m,g=k);return[].concat(this.buildConvexHull([b,g],a),this.buildConvexHull([g,b],a))}}})();
G.MarkerCluster.include({getConvexHull:function(){var a=this.getAllChildMarkers(),b=[],c,d;for(d=a.length-1;0<=d;d--)c=a[d].getLatLng(),b.push(c);return G.QuickHull.getConvexHull(b)}});
G.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:Math.PI/6,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var a=this.getAllChildMarkers(),b=this._group._map.latLngToLayerPoint(this._latlng);this._group._unspiderfy();this._group._spiderfied=this;a.length>=this._circleSpiralSwitchover?b=this._generatePointsSpiral(a.length,b):(b.y+=10,
b=this._generatePointsCircle(a.length,b));this._animationSpiderfy(a,b)}},unspiderfy:function(a){this._group._inZoomAnimation||(this._animationUnspiderfy(a),this._group._spiderfied=null)},_generatePointsCircle:function(a,b){var c=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+a)/this._2PI,d=this._2PI/a,e=[],g,h;e.length=a;for(g=a-1;0<=g;g--)h=this._circleStartAngle+g*d,e[g]=(new G.Point(b.x+c*Math.cos(h),b.y+c*Math.sin(h)))._round();return e},_generatePointsSpiral:function(a,
b){var c=this._group.options.spiderfyDistanceMultiplier,d=c*this._spiralLengthStart,e=c*this._spiralFootSeparation,c=c*this._spiralLengthFactor*this._2PI,g=0,h=[],k;h.length=a;for(k=a-1;0<=k;k--)g+=e/d+5E-4*k,h[k]=(new G.Point(b.x+d*Math.cos(g),b.y+d*Math.sin(g)))._round(),d+=c/g;return h},_noanimationUnspiderfy:function(){var a=this._group,b=a._map,c=a._featureGroup,d=this.getAllChildMarkers(),e,g;a._ignoreMove=!0;this.setOpacity(1);for(g=d.length-1;0<=g;g--)e=d[g],c.removeLayer(e),e._preSpiderfyLatlng&&
(e.setLatLng(e._preSpiderfyLatlng),delete e._preSpiderfyLatlng),e.setZIndexOffset&&e.setZIndexOffset(0),e._spiderLeg&&(b.removeLayer(e._spiderLeg),delete e._spiderLeg);a.fire("unspiderfied",{cluster:this,markers:d});a._ignoreMove=!1;a._spiderfied=null}});
G.MarkerClusterNonAnimated=G.MarkerCluster.extend({_animationSpiderfy:function(a,b){var c=this._group,d=c._map,e=c._featureGroup,g=this._group.options.spiderLegPolylineOptions,h,k,m,l;c._ignoreMove=!0;for(h=0;h<a.length;h++)l=d.layerPointToLatLng(b[h]),k=a[h],m=new G.Polyline([this._latlng,l],g),d.addLayer(m),k._spiderLeg=m,k._preSpiderfyLatlng=k._latlng,k.setLatLng(l),k.setZIndexOffset&&k.setZIndexOffset(1E6),e.addLayer(k);this.setOpacity(.3);c._ignoreMove=!1;c.fire("spiderfied",{cluster:this,markers:a})},
_animationUnspiderfy:function(){this._noanimationUnspiderfy()}});
G.MarkerCluster.include({_animationSpiderfy:function(a,b){var c=this,d=this._group,e=d._map,g=d._featureGroup,h=this._latlng,k=e.latLngToLayerPoint(h),m=G.Path.SVG,l=G.extend({},this._group.options.spiderLegPolylineOptions),p=l.opacity,q,r,u,D;void 0===p&&(p=G.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity);m?(l.opacity=0,l.className=(l.className||"")+" bubble-cluster-spider-leg"):l.opacity=p;d._ignoreMove=!0;for(q=0;q<a.length;q++)r=a[q],D=e.layerPointToLatLng(b[q]),u=new G.Polyline([h,
D],l),e.addLayer(u),r._spiderLeg=u,m&&(D=u._path,u=D.getTotalLength()+.1,D.style.strokeDasharray=u,D.style.strokeDashoffset=u),r.setZIndexOffset&&r.setZIndexOffset(1E6),r.clusterHide&&r.clusterHide(),g.addLayer(r),r._setPos&&r._setPos(k);d._forceLayout();d._animationStart();for(q=a.length-1;0<=q;q--)D=e.layerPointToLatLng(b[q]),r=a[q],r._preSpiderfyLatlng=r._latlng,r.setLatLng(D),r.clusterShow&&r.clusterShow(),m&&(u=r._spiderLeg,D=u._path,D.style.strokeDashoffset=0,u.setStyle({opacity:p}));this.setOpacity(.3);
d._ignoreMove=!1;setTimeout(function(){d._animationEnd();d.fire("spiderfied",{cluster:c,markers:a})},200)},_animationUnspiderfy:function(a){var b=this,c=this._group,d=c._map,e=c._featureGroup;a=a?d._latLngToNewLayerPoint(this._latlng,a.zoom,a.center):d.latLngToLayerPoint(this._latlng);var g=this.getAllChildMarkers(),h=G.Path.SVG,k,m,l,p,q;c._ignoreMove=!0;c._animationStart();this.setOpacity(1);for(m=g.length-1;0<=m;m--)k=g[m],k._preSpiderfyLatlng&&(k.setLatLng(k._preSpiderfyLatlng),delete k._preSpiderfyLatlng,
l=!0,k._setPos&&(k._setPos(a),l=!1),k.clusterHide&&(k.clusterHide(),l=!1),l&&e.removeLayer(k),h&&(l=k._spiderLeg,p=l._path,q=p.getTotalLength()+.1,p.style.strokeDashoffset=q,l.setStyle({opacity:0})));c._ignoreMove=!1;setTimeout(function(){var a=0;for(m=g.length-1;0<=m;m--)k=g[m],k._spiderLeg&&a++;for(m=g.length-1;0<=m;m--)k=g[m],k._spiderLeg&&(k.clusterShow&&k.clusterShow(),k.setZIndexOffset&&k.setZIndexOffset(0),1<a&&e.removeLayer(k),d.removeLayer(k._spiderLeg),delete k._spiderLeg);c._animationEnd();
c.fire("unspiderfied",{cluster:b,markers:g})},200)}});
G.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this);if(this._map.options.zoomAnimation)this._map.on("zoomstart",this._unspiderfyZoomStart,this);this._map.on("zoomend",this._noanimationUnspiderfy,this);G.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this);this._map.off("zoomstart",this._unspiderfyZoomStart,
this);this._map.off("zoomanim",this._unspiderfyZoomAnim,this);this._map.off("zoomend",this._noanimationUnspiderfy,this);this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){if(this._map)this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(a){G.DomUtil.hasClass(this._map._mapPane,"bubble-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(a))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(a){this._spiderfied&&
this._spiderfied.unspiderfy(a)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(a){a._spiderLeg&&(this._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow(),a.setZIndexOffset&&a.setZIndexOffset(0),this._map.removeLayer(a._spiderLeg),delete a._spiderLeg)}});
G.Marker.include({clusterHide:function(){this.options.opacityWhenUnclustered=this.options.opacity||1;return this.setOpacity(0)},clusterShow:function(){var a=this.setOpacity(this.options.opacity||this.options.opacityWhenUnclustered);delete this.options.opacityWhenUnclustered;return a}});G.Canvas.include({_updateMarker:function(a){var b=this;if(this._drawing&&!a._empty()){var c=G.point(a.getIconSize()),d=G.point(a.getIconOffset()||c&&c.divideBy(2,!0)),e=a._point,g=this._ctx;this._drawnLayers[a._goomap_id]=a;var h=new Image;h.src=a.getIconUrl();h.complete?b._updateImage(g,h,e,c,d):h.onload=function(){b._updateImage(g,h,e,c,d)}}},_updateImage:function(a,b,c,d,e){a.drawImage(b,c.x-e.x,c.y-e.y,d.x,d.y)}});
G.CanvasMarker=G.Path.extend({options:{fill:!0,iconUrl:"marker-icon.png",iconSize:[25,41],iconOffset:[12,41],iconAnchor:[14,-28],popupAnchor:[0,-40]},initialize:function(a,b){G.setOptions(this,b);this._latlng=G.latLng(a);this._iconUrl=this.options.iconUrl;this._iconSize=this.options.iconSize;this._iconOffset=this.options.iconOffset;this._iconAnchor=this.options.iconAnchor;this._popupAnchor=this.options.popupAnchor},setLatLng:function(a){this._latlng=G.latLng(a);this.redraw();return this.fire("move",
{latlng:this._latlng})},getLatLng:function(){return this._latlng},setIconUrl:function(a){this.options.iconUrl=this._iconUrl=a;return this.redraw()},getIconUrl:function(a){a=a||"icon";return(new G.Icon.Default)._detectIconPath()+this.options[a+"Url"]},setIconSize:function(a){this.options.iconSize=this._iconSize=a;return this.redraw()},getIconSize:function(){return this._iconSize},setIconOffset:function(a){this.options.iconOffset=this._iconOffset=a;return this.redraw()},getIconOffset:function(){return this._iconOffset},
setIconAnchor:function(a){this.options.iconAnchor=this._iconAnchor=a;return this.redraw()},getIconAnchor:function(){return this._iconAnchor},setPopupAnchor:function(a){this.options.popupAnchor=this._popupAnchor=a;return this.redraw()},getPopupAnchor:function(){return this._popupAnchor},setStyle:function(a){var b=a&&a.iconSize||this._iconSize,c=a&&a.iconOffset||this._iconOffset,d=a&&a.iconAnchor||this._iconAnchor,e=a&&a.popupAnchor||this._popupAnchor;this.setIconUrl(a&&a.iconUrl||this._iconUrl);this.setIconSize(b);
this.setIconOffset(c);this.setIconAnchor(d);this.setPopupAnchor(e);return this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng);this._updateBounds()},_updateBounds:function(){var a=G.point(this.getIconSize());G.point(this.getIconAnchor());var b=G.point(this.getIconOffset()),c=[a.x-b.x,a.y-b.y];this._pxBounds=new G.Bounds(this._point.subtract([a.x-Math.abs(a.x-b.x),a.y-Math.abs(a.y-b.y)]),this._point.add(c))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateMarker(this)},
_empty:function(){return this._iconUrl&&!this._renderer._bounds.intersects(this._pxBounds)},_getPopupAnchor:function(){return this.getPopupAnchor()||[0,0]},_getTooltipAnchor:function(){return this.getIconAnchor()||[0,0]},_openPopup:function(a){var b=a.layer||a.target;this._popup&&this._map&&(G.DomEvent.stop(a),this.openPopup(b.getLatLng()))}});G.canvasMarker=function(a,b){return new G.CanvasMarker(a,b)};G.CanvasMarker.prototype._containsPoint=function(a){return this._pxBounds.contains(a)};(function(a,b){"function"===typeof define&&define.amd?define(["goomap"],a):"object"===typeof exports&&(module.exports=a(require("goomap")));"undefined"!==typeof b&&b.G&&(b.G.Control.MiniMap=a(G),b.G.control.minimap=function(a,d){return new b.G.Control.MiniMap(a,d)})})(function(a){var b=a.Control.extend({options:{position:"bottomright",toggleDisplay:!1,zoomLevelOffset:-5,zoomLevelFixed:!1,centerFixed:!1,zoomAnimation:!1,autoToggleDisplay:!1,minimized:!1,width:150,height:150,collapsedWidth:19,collapsedHeight:19,
aimingRectOptions:{color:"#ff7800",weight:1,clickable:!1},shadowRectOptions:{color:"#000000",weight:1,clickable:!1,opacity:0,fillOpacity:0},strings:{hideText:"Hide MiniMap",showText:"Show MiniMap"},mapOptions:{}},initialize:function(b,d){a.Util.setOptions(this,d);this.options.aimingRectOptions.clickable=!1;this.options.shadowRectOptions.clickable=!1;this._layer=b},onAdd:function(b){this._mainMap=b;this._container=a.DomUtil.create("div","goomap-control-minimap");this._container.style.width=this.options.width+
"px";this._container.style.height=this.options.height+"px";a.DomEvent.disableClickPropagation(this._container);a.DomEvent.on(this._container,"mousewheel",a.DomEvent.stopPropagation);b={attributionControl:!1,dragging:!this.options.centerFixed,zoomControl:!1,zoomAnimation:this.options.zoomAnimation,autoToggleDisplay:this.options.autoToggleDisplay,touchZoom:this.options.centerFixed?"center":!this._isZoomLevelFixed(),scrollWheelZoom:this.options.centerFixed?"center":!this._isZoomLevelFixed(),doubleClickZoom:this.options.centerFixed?
"center":!this._isZoomLevelFixed(),boxZoom:!this._isZoomLevelFixed(),crs:b.options.crs};b=a.Util.extend(this.options.mapOptions,b);this._miniMap=new a.Map(this._container,b);this._miniMap.addLayer(this._layer);this._minimized=this._userToggledDisplay=this._miniMapMoving=this._mainMapMoving=!1;this.options.toggleDisplay&&this._addToggleButton();this._miniMap.whenReady(a.Util.bind(function(){this._aimingRect=a.rectangle(this._mainMap.getBounds(),this.options.aimingRectOptions).addTo(this._miniMap);
this._shadowRect=a.rectangle(this._mainMap.getBounds(),this.options.shadowRectOptions).addTo(this._miniMap);this._mainMap.on("moveend",this._onMainMapMoved,this);this._mainMap.on("move",this._onMainMapMoving,this);this._miniMap.on("movestart",this._onMiniMapMoveStarted,this);this._miniMap.on("move",this._onMiniMapMoving,this);this._miniMap.on("moveend",this._onMiniMapMoved,this)},this));return this._container},addTo:function(b){a.Control.prototype.addTo.call(this,b);b=this.options.centerFixed||this._mainMap.getCenter();
this._miniMap.setView(b,this._decideZoom(!0));this._setDisplay(this.options.minimized);return this},onRemove:function(a){this._mainMap.off("moveend",this._onMainMapMoved,this);this._mainMap.off("move",this._onMainMapMoving,this);this._miniMap.off("moveend",this._onMiniMapMoved,this);this._miniMap.removeLayer(this._layer)},changeLayer:function(a){this._miniMap.removeLayer(this._layer);this._layer=a;this._miniMap.addLayer(this._layer)},_addToggleButton:function(){this._toggleDisplayButton=this.options.toggleDisplay?
this._createButton("",this.options.strings.hideText,"goomap-control-minimap-toggle-display goomap-control-minimap-toggle-display-"+this.options.position,this._container,this._toggleDisplayButtonClicked,this):void 0;this._toggleDisplayButton.style.width=this.options.collapsedWidth+"px";this._toggleDisplayButton.style.height=this.options.collapsedHeight+"px"},_createButton:function(b,d,e,g,h,k){e=a.DomUtil.create("a",e,g);e.innerHTML=b;e.href="#";e.title=d;b=a.DomEvent.stopPropagation;a.DomEvent.on(e,
"click",b).on(e,"mousedown",b).on(e,"dblclick",b).on(e,"click",a.DomEvent.preventDefault).on(e,"click",h,k);return e},_toggleDisplayButtonClicked:function(){this._userToggledDisplay=!0;this._minimized?this._restore():this._minimize()},_setDisplay:function(a){a!==this._minimized&&(this._minimized?this._restore():this._minimize())},_minimize:function(){this.options.toggleDisplay?(this._container.style.width=this.options.collapsedWidth+7+"px",this._container.style.height=this.options.collapsedHeight+
7+"px",this._toggleDisplayButton.className+=" minimized-"+this.options.position,this._toggleDisplayButton.title=this.options.strings.showText):this._container.style.display="none";this._minimized=!0},_restore:function(){this.options.toggleDisplay?(this._container.style.width=this.options.width+"px",this._container.style.height=this.options.height+"px",this._toggleDisplayButton.className=this._toggleDisplayButton.className.replace("minimized-"+this.options.position,""),this._toggleDisplayButton.title=
this.options.strings.hideText):this._container.style.display="block";this._minimized=!1},_onMainMapMoved:function(a){this._miniMapMoving?this._miniMapMoving=!1:(a=this.options.centerFixed||this._mainMap.getCenter(),this._mainMapMoving=!0,this._miniMap.setView(a,this._decideZoom(!0)),this._setDisplay(this._decideMinimized()));this._aimingRect.setBounds(this._mainMap.getBounds())},_onMainMapMoving:function(a){this._aimingRect.setBounds(this._mainMap.getBounds())},_onMiniMapMoveStarted:function(a){if(!this.options.centerFixed){var b=
this._aimingRect.getBounds();a=this._miniMap.latLngToContainerPoint(b.getSouthWest());b=this._miniMap.latLngToContainerPoint(b.getNorthEast());this._lastAimingRectPosition={sw:a,ne:b}}},_onMiniMapMoving:function(b){this.options.centerFixed||this._mainMapMoving||!this._lastAimingRectPosition||(this._shadowRect.setBounds(new a.LatLngBounds(this._miniMap.containerPointToLatLng(this._lastAimingRectPosition.sw),this._miniMap.containerPointToLatLng(this._lastAimingRectPosition.ne))),this._shadowRect.setStyle({opacity:1,
fillOpacity:.3}))},_onMiniMapMoved:function(a){this._mainMapMoving?this._mainMapMoving=!1:(this._miniMapMoving=!0,this._mainMap.setView(this._miniMap.getCenter(),this._decideZoom(!1)),this._shadowRect.setStyle({opacity:0,fillOpacity:0}))},_isZoomLevelFixed:function(){var a=this.options.zoomLevelFixed;return this._isDefined(a)&&this._isInteger(a)},_decideZoom:function(a){if(this._isZoomLevelFixed())return a?this.options.zoomLevelFixed:this._mainMap.getZoom();if(a)return this._mainMap.getZoom()+this.options.zoomLevelOffset;
a=this._miniMap.getZoom()-this._mainMap.getZoom();var b=this._miniMap.getZoom()-this.options.zoomLevelOffset;a>this.options.zoomLevelOffset&&this._mainMap.getZoom()<this._miniMap.getMinZoom()-this.options.zoomLevelOffset?this._miniMap.getZoom()>this._lastMiniMapZoom?(a=this._mainMap.getZoom()+1,this._miniMap.setZoom(this._miniMap.getZoom()-1)):a=this._mainMap.getZoom():a=b;this._lastMiniMapZoom=this._miniMap.getZoom();return a},_decideMinimized:function(){return this._userToggledDisplay?this._minimized:
this.options.autoToggleDisplay?this._mainMap.getBounds().contains(this._miniMap.getBounds())?!0:!1:this._minimized},_isInteger:function(a){return"number"===typeof a},_isDefined:function(a){return"undefined"!==typeof a}});a.Map.mergeOptions({miniMapControl:!1});a.Map.addInitHook(function(){this.options.miniMapControl&&(this.miniMapControl=(new b).addTo(this))});return b},window);G.TileLayer.ChinaProvider=G.TileLayer.extend({initialize:function(a,b){var c=G.TileLayer.ChinaProvider.providers,d=a.split("."),e=d[0],d=c[e][d[1]][d[2]];b.subdomains=c[e].Subdomains;G.TileLayer.prototype.initialize.call(this,d,b)}});
G.TileLayer.ChinaProvider.providers={TianDiTu:{Normal:{Map:"http://t{s}.tianditu.cn/DataServer?T=vec_w&X={x}&Y={y}&L={z}&tk=3de2f50033d7ed47d7f041399e3e4743",Annotion:"http://t{s}.tianditu.cn/DataServer?T=cva_w&X={x}&Y={y}&L={z}&tk=3de2f50033d7ed47d7f041399e3e4743"},Satellite:{Map:"http://t{s}.tianditu.cn/DataServer?T=img_w&X={x}&Y={y}&L={z}&tk=3de2f50033d7ed47d7f041399e3e4743",Annotion:"http://t{s}.tianditu.cn/DataServer?T=cia_w&X={x}&Y={y}&L={z}&tk=3de2f50033d7ed47d7f041399e3e4743"},Terrain:{Map:"http://t{s}.tianditu.cn/DataServer?T=ter_w&X={x}&Y={y}&L={z}&tk=3de2f50033d7ed47d7f041399e3e4743",
Annotion:"http://t{s}.tianditu.cn/DataServer?T=cta_w&X={x}&Y={y}&L={z}&tk=3de2f50033d7ed47d7f041399e3e4743"},Subdomains:"01234567".split("")},MapABC:{Normal:{Map:"http://emap{s}.mapabc.com/mapabc/maptile?&x={x}&y={y}&z={z}"},Subdomains:["0","1","2","3"]},GaoDe:{Normal:{Map:"http://webrd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}"},Satellite:{Map:"http://webst0{s}.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}",Annotion:"http://webst0{s}.is.autonavi.com/appmaptile?style=8&x={x}&y={y}&z={z}"},
Annotion:{Map:"http://webst0{s}.is.autonavi.com/appmaptile?style=8&x={x}&y={y}&z={z}"},RoadNet:{Map:"http://wprd0{s}.is.autonavi.com/appmaptile?style=8&x={x}&y={y}&z={z}"},Traffic:{Map:"http://tm.amap.com/trafficengine/mapabc/traffictile?v=1.0&;t=1&z={z}&x={x}&y={y}&t="+(new Date).getTime().toString()},Subdomains:["1","2","3","4"]},Google:{Normal:{Map:"http://mt{s}.google.cn/vt/lyrs=r&hl=zh-CN&gl=CN&x={x}&y={y}&z={z}"},Satellite:{Map:"http://mt{s}.google.cn/vt/lyrs=s&hl=zh-CN&gl=CN&x={x}&y={y}&z={z}",
Annotion:"http://mt{s}.google.cn/vt/lyrs=h&hl=zh-CN&gl=CN&x={x}&y={y}&z={z}"},Terrain:{Map:"http://mt{s}.google.cn/vt/lyrs=t&hl=zh-CN&gl=CN&x={x}&y={y}&z={z}"},Subdomains:["1","2","3"]}};G.tileLayer.chinaProvider=function(a,b){return new G.TileLayer.ChinaProvider(a,b)};G.Google=G.Class.extend({includes:G.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",opacity:1,continuousWorld:!1,noWrap:!1},initialize:function(a,b){G.Util.setOptions(this,b);(this._ready=void 0!=google.maps.Map)||G.Google.asyncWait.push(this);this._type=a||"SATELLITE"},onAdd:function(a,b){this._map=a;this._insertAtTheBottom=b;this._initContainer();this._initMapObject();a.on("viewreset",this._resetCallback,this);this._limitedUpdate=G.Util.limitExecByInterval(this._update,
150,this);a.on("move",this._update,this);a._controlCorners.bottomright.style.marginBottom="1em";this._reset();this._update()},onRemove:function(a){this._map._container.removeChild(this._container);this._map.off("viewreset",this._resetCallback,this);this._map.off("move",this._update,this);a._controlCorners.bottomright.style.marginBottom="0em"},getAttribution:function(){return this.options.attribution},setOpacity:function(a){this.options.opacity=a;1>a&&G.DomUtil.setOpacity(this._container,a)},setElementSize:function(a,
b){a.style.width=b.x+"px";a.style.height=b.y+"px"},_initContainer:function(){var a=this._map._container,b=a.firstChild;this._container||(this._container=G.DomUtil.create("div","goomap-google-layer goomap-top goomap-left"),this._container.id="_GMapContainer_"+G.Util.stamp(this),this._container.style.zIndex="auto");a.insertBefore(this._container,b);this.setOpacity(this.options.opacity);this.setElementSize(this._container,this._map.getSize())},_initMapObject:function(){if(this._ready){this._google_center=
new google.maps.LatLng(0,0);var a=new google.maps.Map(this._container,{center:this._google_center,zoom:0,tilt:0,mapTypeId:google.maps.MapTypeId[this._type],disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,streetViewControl:!1}),b=this;this._reposition=google.maps.event.addListenerOnce(a,"center_changed",function(){b.onReposition()});a.backgroundColor="#ff0000";this._google=a}},_resetCallback:function(a){this._reset(a.hard)},_reset:function(a){this._initContainer()},
_update:function(){if(this._google){this._resize();var a=this._map.getBounds(),b=a.getNorthEast(),a=a.getSouthWest();new google.maps.LatLngBounds(new google.maps.LatLng(a.lat,a.lng),new google.maps.LatLng(b.lat,b.lng));b=this._map.getCenter();b=new google.maps.LatLng(b.lat,b.lng);this._google.setCenter(b);this._google.setZoom(this._map.getZoom())}},_resize:function(){var a=this._map.getSize();if(this._container.style.width!=a.x||this._container.style.height!=a.y)this.setElementSize(this._container,
a),this.onReposition()},onReposition:function(){this._google&&google.maps.event.trigger(this._google,"resize")}});G.Google.asyncWait=[];G.Google.asyncInitialize=function(){var a;for(a=0;a<G.Google.asyncWait.length;a++){var b=G.Google.asyncWait[a];b._ready=!0;b._container&&(b._initMapObject(),b._update())}G.Google.asyncWait=[]};G.TileLayer.Ajax=G.TileLayer.extend({_requests:[],_addTile:function(a){var b={datum:null,processed:!1};this._tiles[a.x+":"+a.y]=b;this._loadTile(b,a)},_xhrHandler:function(a,b,c,d){return function(){if(4===a.readyState){var e=a.status;if(200<=e&&300>e||304===e)c.datum=JSON.parse(a.responseText);b._tileLoaded(c,d)}}},_loadTile:function(a,b){this._adjustTilePoint(b);var c=new XMLHttpRequest;this._requests.push(c);c.onreadystatechange=this._xhrHandler(c,this,a,b);c.open("GET",this.getTileUrl(b),!0);
c.send()},_reset:function(){G.TileLayer.prototype._reset.apply(this,arguments);for(var a in this._requests)this._requests[a].abort();this._requests=[]},_update:function(){this._map&&this._map._panTransition&&this._map._panTransition._inProgress||(0>this._tilesToLoad&&(this._tilesToLoad=0),G.TileLayer.prototype._update.apply(this,arguments))}});
G.TileLayer.GeoJSON=G.TileLayer.Ajax.extend({_keyLayers:{},_clipPathRectangles:{},initialize:function(a,b,c){G.TileLayer.Ajax.prototype.initialize.call(this,a,b);this.geojsonLayer=new G.GeoJSON(null,c)},onAdd:function(a){this._map=a;G.TileLayer.Ajax.prototype.onAdd.call(this,a);a.addLayer(this.geojsonLayer)},onRemove:function(a){a.removeLayer(this.geojsonLayer);G.TileLayer.Ajax.prototype.onRemove.call(this,a)},_reset:function(){this.geojsonLayer.clearLayers();this._keyLayers={};this._removeOldClipPaths();
G.TileLayer.Ajax.prototype._reset.apply(this,arguments)},_removeOldClipPaths:function(){for(var a in this._clipPathRectangles){var b=a.split("_").slice(1);parseInt(b[0],10)!==this._map.getZoom()&&(this._map.removeLayer(this._clipPathRectangles[a]),b=document.getElementById(a),null!==b&&b.parentNode.removeChild(b),delete this._clipPathRectangles[a])}},_recurseLayerUntilPath:function(a,b){b instanceof G.Path?a(b):b instanceof G.LayerGroup&&b.getLayers().forEach(this._recurseLayerUntilPath.bind(this,
a),this)},_clipLayerToTileBoundary:function(a,b){if(G.Path.SVG&&this._map){this._map._pathRoot||(this._map._pathRoot=G.Path.prototype._createElement("svg"),this._map._panes.overlayPane.appendChild(this._map._pathRoot));var c=this._map._pathRoot,d=null;0===c.getElementsByTagName("defs").length?(d=document.createElementNS(G.Path.SVG_NS,"defs"),c.insertBefore(d,c.firstChild)):d=c.getElementsByTagName("defs")[0];var e="tileClipPath_"+b.z+"_"+b.x+"_"+b.y,c=document.getElementById(e);if(null===c){c=document.createElementNS(G.Path.SVG_NS,
"clipPath");c.id=e;var g=this.options.tileSize,h=b.multiplyBy(g),g=h.add([g,g]),h=this._map.unproject(h),g=this._map.unproject(g);this._clipPathRectangles[e]=new G.Rectangle(new G.LatLngBounds([h,g]),{opacity:0,fillOpacity:0,clickable:!1,noClip:!0});this._map.addLayer(this._clipPathRectangles[e]);h=document.createElementNS(G.Path.SVG_NS,"path");g=this._clipPathRectangles[e].getPathString();h.setAttribute("d",g);c.appendChild(h);d.appendChild(c)}this._recurseLayerUntilPath(function(a){a._container.setAttribute("clip-path",
"url(#"+e+")")},a)}},addTileData:function(a,b){var c=G.Util.isArray(a)?a:a.features,d,e,g;if(c){d=0;for(e=c.length;d<e;d++)g=c[d],(g.geometries||g.geometry||g.features||g.coordinates)&&this.addTileData(c[d],b);return this}c=this.geojsonLayer.options;if(!c.filter||c.filter(a)){d=this.geojsonLayer;e=null;if(this.options.unique&&"function"===typeof this.options.unique){g=this.options.unique(a);g in this._keyLayers&&"GeometryCollection"!==a.geometry.type||(a.geometry={type:"GeometryCollection",geometries:[a.geometry]});
try{e=G.GeoJSON.geometryToLayer(a,c.pointToLayer,c.coordsToLatLng)}catch(h){return this}e.feature=G.GeoJSON.asFeature(a);g in this._keyLayers?(d=this._keyLayers[g],d.feature.geometry.geometries.push(a.geometry)):this._keyLayers[g]=e}else{try{e=G.GeoJSON.geometryToLayer(a,c.pointToLayer,c.coordsToLatLng)}catch(h){return this}e.feature=G.GeoJSON.asFeature(a)}e.defaultOptions=e.options;this.geojsonLayer.resetStyle(e);if(c.onEachFeature)c.onEachFeature(a,e);d.addLayer(e);this.options.clipTiles&&this._clipLayerToTileBoundary(e,
b);return this}},_tileLoaded:function(a,b){G.TileLayer.Ajax.prototype._tileLoaded.apply(this,arguments);if(null===a.datum)return null;this.addTileData(a.datum,b)}});G.TileLayer.WMTS=G.TileLayer.extend({defaultWmtsParams:{service:"WMTS",request:"GetTile",version:"1.0.0",layer:"",style:"",tilematrixSet:"",format:"image/jpeg"},initialize:function(a,b){this._url=a;var c=G.extend({},this.defaultWmtsParams),d=b.tileSize||this.options.tileSize;c.width=b.detectRetina&&G.Browser.retina?c.height=2*d:c.height=d;for(var e in b)this.options.hasOwnProperty(e)||"matrixIds"==e||(c[e]=b[e]);this.wmtsParams=c;this.matrixIds=b.matrixIds||this.getDefaultMatrix();G.setOptions(this,
b)},onAdd:function(a){G.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a,b){var c=this._map;crs=c.options.crs;tileSize=this.options.tileSize;nwPoint=a.multiplyBy(tileSize);nwPoint.x+=1;--nwPoint.y;sePoint=nwPoint.add(new G.Point(tileSize,tileSize));nw=crs.project(c.unproject(nwPoint,b));se=crs.project(c.unproject(sePoint,b));tilewidth=se.x-nw.x;b=this._getZoomForUrl();ident=this.matrixIds[b].identifier;X0=this.matrixIds[b].topLeftCorner.lng;Y0=this.matrixIds[b].topLeftCorner.lat;tilecol=
Math.floor((nw.x-X0)/tilewidth);tilerow=-Math.floor((nw.y-Y0)/tilewidth);url=G.Util.template(this._url,{s:this._getSubdomain(a)});return url+G.Util.getParamString(this.wmtsParams,url)+"&tilematrix="+ident+"&tilerow="+tilerow+"&tilecol="+tilecol},setParams:function(a,b){G.extend(this.wmtsParams,a);b||this.redraw();return this},getDefaultMatrix:function(){for(var a=Array(22),b=0;22>b;b++)a[b]={identifier:""+b,topLeftCorner:new G.LatLng(2.00375083428E7,-2.00375083428E7)};return a}});
G.tileLayer.wmts=function(a,b){return new G.TileLayer.WMTS(a,b)};G.TileLayer.BetterWMS=G.TileLayer.WMS.extend({onAdd:function(a){G.TileLayer.WMS.prototype.onAdd.call(this,a);a.on("click",this.getFeatureInfo,this)},onRemove:function(a){G.TileLayer.WMS.prototype.onRemove.call(this,a);a.off("click",this.getFeatureInfo,this)},getFeatureInfo:function(a){var b=this.getFeatureInfoUrl(a.latlng),c=G.Util.bind(this.showGetFeatureInfo,this);$.ajax({url:b,beforeSend:!1,complete:!1,success:function(b,e,g){c("object"===typeof b?null:b,a.latlng,b)},error:function(a,b,g){c(g)}})},
getFeatureInfoUrl:function(a){a=this._map.latLngToContainerPoint(a,this._map.getZoom());var b=this._map.getSize(),b={request:"GetFeatureInfo",service:"WMS",srs:"EPSG:4326",styles:this.wmsParams.styles,transparent:this.wmsParams.transparent,version:this.wmsParams.version,format:this.wmsParams.format,bbox:this._map.getBounds().toBBoxString(),height:b.y,width:b.x,layers:this.wmsParams.layers,query_layers:this.wmsParams.layers,info_format:this.wmsParams.infoFormat||"text/html"};b["1.3.0"===b.version?
"i":"x"]=a.x;b["1.3.0"===b.version?"j":"y"]=a.y;return this._url+G.Util.getParamString(b,this._url,!0)},showGetFeatureInfo:function(a,b,c){a?console.log(a):G.popup({maxWidth:800}).setLatLng(b).setContent(c).openOn(this._map)}});G.tileLayer.betterWms=function(a,b){return new G.TileLayer.BetterWMS(a,b)};(function(a,b){"function"===typeof define&&define.amd?define(function(){return b()}):"undefined"!==typeof module&&"object"===typeof exports?module.exports=b():a.Wkt=b()})(this,function(){var a,b,c;c=function(a){if(a instanceof c)return a;if(!(this instanceof c))return new c(a);this._wrapped=a};a=function(a,b){return a.substring(0,b.length)===b};b=function(a,b){return a.substring(a.length-b.length)===b};c.delimiter=" ";c.isArray=function(a){return!(!a||a.constructor!==Array)};c.trim=function(c,e){for(e=
e||" ";a(c,e);)c=c.substring(1);for(;b(c,e);)c=c.substring(0,c.length-1);return c};c.Wkt=function(a){this.delimiter=c.delimiter||" ";this.wrapVertices=!0;this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+|\+/,numeric:/-*\d+(\.*\d+)?/,comma:/\s*,\s*/,parenComma:/\)\s*,\s*\(/,coord:/-*\d+\.*\d+ -*\d+\.*\d+/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/,ogcTypes:/^(multi)?(point|line|polygon|box)?(string)?$/i,crudeJson:/^{.*"(type|coordinates|geometries|features)":.*}$/};
this.components=void 0;a&&"string"===typeof a?this.read(a):a&&this.fromObject(a)};c.Wkt.prototype.isCollection=function(){switch(this.type.slice(0,5)){case "multi":return!0;case "polyg":return!0;default:return!1}};c.Wkt.prototype.sameCoords=function(a,b){return a.x===b.x&&a.y===b.y};c.Wkt.prototype.fromObject=function(a){a=a.hasOwnProperty("type")&&a.hasOwnProperty("coordinates")?this.fromJson(a):this.deconstruct.call(this,a);this.components=a.components;this.isRectangle=a.isRectangle||!1;this.type=
a.type;return this};c.Wkt.prototype.toObject=function(a){a=this.construct[this.type].call(this,a);"object"!==typeof a||c.isArray(a)||(a.properties=this.properties);return a};c.Wkt.prototype.toString=function(a){return this.write()};c.Wkt.prototype.fromJson=function(a){var b,d,h,k,m;this.type=a.type.toLowerCase();this.components=[];if(a.hasOwnProperty("geometry"))return this.fromJson(a.geometry),this.properties=a.properties,this;a=a.coordinates;if(!c.isArray(a[0]))this.components.push({x:a[0],y:a[1]});
else for(b in a)if(a.hasOwnProperty(b))if(c.isArray(a[b][0])){m=[];for(d in a[b])if(a[b].hasOwnProperty(d))if(c.isArray(a[b][d][0])){k=[];for(h in a[b][d])a[b][d].hasOwnProperty(h)&&k.push({x:a[b][d][h][0],y:a[b][d][h][1]});m.push(k)}else m.push({x:a[b][d][0],y:a[b][d][1]});this.components.push(m)}else"multipoint"===this.type?this.components.push([{x:a[b][0],y:a[b][1]}]):this.components.push({x:a[b][0],y:a[b][1]});return this};c.Wkt.prototype.toJson=function(){var a,b,g,h,k,m,l;a=this.components;
m=this.regExes.ogcTypes.exec(this.type).slice(1);l=[];for(b in m)m.hasOwnProperty(b)&&void 0!==m[b]&&l.push(m[b].toLowerCase().slice(0,1).toUpperCase()+m[b].toLowerCase().slice(1));b={coordinates:[],type:l.join("")};if("box"===this.type.toLowerCase()){b.type="Polygon";b.bbox=[];for(g in a)a.hasOwnProperty(g)&&(b.bbox=b.bbox.concat([a[g].x,a[g].y]));b.coordinates=[[[a[0].x,a[0].y],[a[0].x,a[1].y],[a[1].x,a[1].y],[a[1].x,a[0].y],[a[0].x,a[0].y]]];return b}for(g in a)if(a.hasOwnProperty(g))if(c.isArray(a[g])){l=
[];for(h in a[g])if(a[g].hasOwnProperty(h))if(c.isArray(a[g][h])){m=[];for(k in a[g][h])a[g][h].hasOwnProperty(k)&&m.push([a[g][h][k].x,a[g][h][k].y]);l.push(m)}else 1<a[g].length?l.push([a[g][h].x,a[g][h].y]):l=l.concat([a[g][h].x,a[g][h].y]);b.coordinates.push(l)}else 1<a.length?b.coordinates.push([a[g].x,a[g].y]):b.coordinates=b.coordinates.concat([a[g].x,a[g].y]);return b};c.Wkt.prototype.merge=function(a){var b=this.type.slice(0,5);if(this.type!==a.type&&this.type.slice(5,this.type.length)!==
a.type)throw TypeError("The input geometry types must agree or the calling this.Wkt.Wkt instance must be a multigeometry of the other");switch(b){case "point":this.components=[this.components.concat(a.components)];break;case "multi":this.components=this.components.concat("multi"===a.type.slice(0,5)?a.components:[a.components]);break;default:this.components=[this.components,a.components]}"multi"!==b&&(this.type="multi"+this.type);return this};c.Wkt.prototype.read=function(a){var b;if(b=this.regExes.typeStr.exec(a))this.type=
b[1].toLowerCase(),this.base=b[2],this.ingest[this.type]&&(this.components=this.ingest[this.type].apply(this,[this.base]));else if(this.regExes.crudeJson.test(a))if("object"===typeof JSON&&"function"===typeof JSON.parse)this.fromJson(JSON.parse(a));else throw console.log("JSON.parse() is not available; cannot parse GeoJSON strings"),{name:"JSONError",message:"JSON.parse() is not available; cannot parse GeoJSON strings"};else throw console.log("Invalid WKT string provided to read()"),{name:"WKTError",
message:"Invalid WKT string provided to read()"};return this};c.Wkt.prototype.write=function(a){var b,c,d;a=a||this.components;c=[];c.push(this.type.toUpperCase()+"(");for(b=0;b<a.length;b+=1){this.isCollection()&&0<b&&c.push(",");if(!this.extract[this.type])return null;d=this.extract[this.type].apply(this,[a[b]]);this.isCollection()&&"multipoint"!==this.type?c.push("("+d+")"):(c.push(d),b!==a.length-1&&"multipoint"!==this.type&&c.push(","))}c.push(")");return c.join("")};c.Wkt.prototype.extract=
{point:function(a){return String(a.x)+this.delimiter+String(a.y)},multipoint:function(a){var b,c=[],d;for(b=0;b<a.length;b+=1)d=this.extract.point.apply(this,[a[b]]),this.wrapVertices&&(d="("+d+")"),c.push(d);return c.join(",")},linestring:function(a){return this.extract.point.apply(this,[a])},multilinestring:function(a){var b,c=[];if(a.length)for(b=0;b<a.length;b+=1)c.push(this.extract.linestring.apply(this,[a[b]]));else c.push(this.extract.point.apply(this,[a]));return c.join(",")},polygon:function(a){return this.extract.multilinestring.apply(this,
[a])},multipolygon:function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push("("+this.extract.polygon.apply(this,[a[b]])+")");return c.join(",")},box:function(a){return this.extract.linestring.apply(this,[a])},geometrycollection:function(a){console.log("The geometrycollection WKT type is not yet supported.")}};c.Wkt.prototype.ingest={point:function(a){a=c.trim(a).split(this.regExes.spaces);return[{x:parseFloat(this.regExes.numeric.exec(a[0])[0]),y:parseFloat(this.regExes.numeric.exec(a[1])[0])}]},multipoint:function(a){var b,
d;b=[];d=c.trim(a).split(this.regExes.comma);for(a=0;a<d.length;a+=1)b.push(this.ingest.point.apply(this,[d[a]]));return b},linestring:function(a){var b,c;b=this.ingest.multipoint.apply(this,[a]);c=[];for(a=0;a<b.length;a+=1)c=c.concat(b[a]);return c},multilinestring:function(a){var b,d,h;b=[];h=c.trim(a).split(this.regExes.doubleParenComma);1===h.length&&(h=c.trim(a).split(this.regExes.parenComma));for(a=0;a<h.length;a+=1)d=h[a].replace(this.regExes.trimParens,"$1"),b.push(this.ingest.linestring.apply(this,
[d]));return b},polygon:function(a){var b,d,h,k,m;m=c.trim(a).split(this.regExes.parenComma);d=[];for(a=0;a<m.length;a+=1){k=m[a].replace(this.regExes.trimParens,"$1").split(this.regExes.comma);h=[];for(b=0;b<k.length;b+=1){var l=k[b].split(this.regExes.spaces);2<l.length&&(l=l.filter(function(a){return""!=a}));if(2===l.length){var p=l[1];h.push({x:parseFloat(l[0]),y:parseFloat(p)})}}d.push(h)}return d},box:function(a){var b,c;b=this.ingest.multipoint.apply(this,[a]);c=[];for(a=0;a<b.length;a+=1)c=
c.concat(b[a]);return c},multipolygon:function(a){var b,d,h;b=[];h=c.trim(a).split(this.regExes.doubleParenComma);for(a=0;a<h.length;a+=1)d=h[a].replace(this.regExes.trimParens,"$1"),b.push(this.ingest.polygon.apply(this,[d]));return b},geometrycollection:function(a){console.log("The geometrycollection WKT type is not yet supported.")}};return c});/*


  Copyright (C) 2012 K. Arthur Endsley (kaendsle@mtu.edu)
  Michigan Tech Research Institute (MTRI)
  3600 Green Court, Suite 100, Ann Arbor, MI, 48105

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.

*/
Wkt.Wkt.prototype.isRectangle=!1;Wkt.Wkt.prototype.trunc=function(a){var b,c=[];for(b=0;b<a.length;b+=1)Wkt.isArray(a[b])?c.push(this.trunc(a[b])):0!==b&&this.sameCoords(a[0],a[b])||c.push(a[b]);return c};
Wkt.Wkt.prototype.construct={point:function(a,b){var c=b||this.components;c instanceof Array&&(c=c[0]);return G.marker(this.coordsToLatLng(c),a)},multipoint:function(a){var b,c=[],d=this.components;for(b=0;b<d.length;b+=1)c.push(this.construct.point.call(this,a,d[b]));return G.featureGroup(c,a)},linestring:function(a,b){var c=this.coordsToLatLngs(b||this.components);return G.polyline(c,a)},multilinestring:function(a){var b=this.coordsToLatLngs(this.components,1);return G.multiPolyline?G.multiPolyline(b,
a):G.polyline(b,a)},polygon:function(a){var b=this.trunc(this.components),b=this.coordsToLatLngs(b,1);return G.polygon(b,a)},multipolygon:function(a){var b=this.trunc(this.components),b=this.coordsToLatLngs(b,2);return G.multiPolygon?G.multiPolygon(b,a):G.polygon(b,a)},geometrycollection:function(a){var b,c,d;b=this.trunc(this.components);d=[];for(c=0;c<this.components.length;c+=1)d.push(this.construct[b[c].type].call(this,b[c]));return G.featureGroup(d,a)}};
G.Util.extend(Wkt.Wkt.prototype,{coordsToLatLng:function(a,b){return G.latLng(b?a.x:a.y,b?a.y:a.x,!0)},coordsToLatLngs:function(a,b){return G.GeoJSON.coordsToLatLngs(a,b,this.coordsToLatLng)}});
Wkt.Wkt.prototype.deconstruct=function(a){var b,c,d,e,g,h;c=function(a){var b,d;d=[];for(b=0;b<a.length;b+=1)Wkt.isArray(a[b])?d.push(c(a[b])):d.push({x:a[b].lng,y:a[b].lat});return d};if(a.constructor===G.Marker||a.constructor===G.marker)return{type:"point",components:[{x:a.getLatLng().lng,y:a.getLatLng().lat}]};if(a.constructor===G.Rectangle||a.constructor===G.rectangle)return h=a.getBounds(),{type:"polygon",isRectangle:!0,components:[[{x:h.getSouthWest().lng,y:h.getNorthEast().lat},{x:h.getNorthEast().lng,
y:h.getNorthEast().lat},{x:h.getNorthEast().lng,y:h.getSouthWest().lat},{x:h.getSouthWest().lng,y:h.getSouthWest().lat},{x:h.getSouthWest().lng,y:h.getNorthEast().lat}]]};if(a.constructor===G.Polyline||a.constructor===G.polyline)if(e=[],h=a.getLatLngs(),!h[0].equals(h[h.length-1])){for(b=0;b<h.length;b+=1)e.push({x:h[b].lng,y:h[b].lat});return{type:"linestring",components:e}}if(a.constructor===G.Polygon||a.constructor===G.polygon){g=[];e=[];h=a.getLatLngs()[0];for(b=0;b<h.length;b+=1)e.push({x:h[b].lng,
y:h[b].lat});e.push({x:h[0].lng,y:h[0].lat});g.push(e);if(a._holes&&0<a._holes.length)for(e=c(a._holes),b=0;b<e.length;b++)e[b].push(e[b][0]),g.push(e[b]);return{type:"polygon",components:g}}if(a.constructor===G.MultiPolyline||a.constructor===G.MultiPolygon||a.constructor===G.LayerGroup||a.constructor===G.FeatureGroup){d=[];h=a._layers;for(b in h)h.hasOwnProperty(b)&&(h[b].getLatLngs||h[b].getLatLng)&&d.push(this.deconstruct(h[b]));return{type:function(){switch(a.constructor){case G.MultiPolyline:return"multilinestring";
case G.MultiPolygon:return"multipolygon";case G.FeatureGroup:var b,c,d,e;e=d=c=!0;for(b in a._layers)a._layers.hasOwnProperty(b)&&(a._layers[b].constructor!==G.Marker&&(e=!1),a._layers[b].constructor!==G.Polyline&&(d=!1),a._layers[b].constructor!==G.Polygon&&(c=!1));return e?"multipoint":d?"multilinestring":c?"multipolygon":"geometrycollection";default:return"geometrycollection"}}(),components:function(){var a,b;b=[];for(a=0;a<d.length;a+=1)d[a].components&&b.push(d[a].components);return b}()}}a.constructor===
G.Circle||a.constructor===G.circle?console.log("Deconstruction of G.Circle objects is not yet supported"):console.log("The passed object does not have any recognizable properties.")};G.Control.DistanceMeasure=G.Control.extend({options:{position:"topleft",guidelineDistance:20},onAdd:function(a){a=G.DomUtil.create("div","goomap-control-zoom goomap-bar goomap-control");this._createButton("","\u6d4b\u91cf\u8ddd\u79bb(\u53cc\u51fb\u6216\u6309ESC\u7ed3\u675f\u6d4b\u91cf)","goomap-control-measure goomap-bar-part goomap-bar-part-top-and-bottom",a,this._startMeasuring,this);return a},_createButton:function(a,b,c,d,e,g){c=G.DomUtil.create("a",c,d);c.innerHTML=a;c.href="#";c.title=b;G.DomEvent.on(c,
"click",G.DomEvent.stopPropagation).on(c,"click",e,g).on(c,"mousedown",G.DomEvent.stopPropagation).on(c,"dblclick",G.DomEvent.stopPropagation).on(c,"touchstart",G.DomEvent.stopPropagation).on(c,"click",G.DomEvent.preventDefault);return c},_toggleMeasure:function(){(this._measuring=!this._measuring)?(G.DomUtil.addClass(this._container,"goomap-control-measure-on"),this._startMeasuring()):(G.DomUtil.removeClass(this._container,"goomap-control-measure-on"),this._stopMeasuring())},_startMeasuring:function(){this._measuring?
this._stopMeasuring():(this._map.dragging.disable(),this._measuring=!0,G.DomUtil.addClass(this._container,"goomap-control-measure-on"),this._oldCursor=this._map._container.style.cursor,this._map._container.style.cursor="crosshair",this._doubleClickZoom=this._map.doubleClickZoom.enabled(),this._map.doubleClickZoom.disable(),G.DomEvent.on(this._map,"mousemove",this._mouseMove,this).on(this._map,"click",this._mouseClick,this).on(document,"keydown",this._onKeyDown,this),this._layerPaints||(this._layerPaints=
[]),this._layerPaint||(this._layerPaint=G.layerGroup().addTo(this._map)),this._points||(this._points=[]))},_stopMeasuring:function(a){this._map.dragging.enable();G.DomUtil.removeClass(this._container,"goomap-control-measure-on");this._map._container.style.cursor=this._oldCursor;G.DomEvent.off(document,"keydown",this._onKeyDown,this).off(this._map,"mousemove",this._mouseMove,this).off(this._map,"click",this._mouseClick,this);this._doubleClickZoom&&this._map.doubleClickZoom.enable();if(a)a.clearLayers();
else for(var b in this._layerPaints)this._layerPaints[b].clearLayers();this._measuring=!1;this._restartPath()},_mouseMove:function(a){a.latlng&&this._lastPoint&&(this._layerPaintPathTemp?this._layerPaintPathTemp.setLatLngs([this._lastPoint,a.latlng]):this._layerPaintPathTemp=G.polyline([this._lastPoint,a.latlng],{color:"#ff0000",weight:2,clickable:!1,dashArray:"6,3"}).addTo(this._layerPaint),this._tooltip&&(this._distance||(this._distance=0),this._updateTooltipPosition(a.latlng),a=a.latlng.distanceTo(this._lastPoint),
this._updateTooltipDistance(this._distance+a,a)))},_mouseClick:function(a){if(a.latlng){if(this._lastPoint&&this._tooltip){this._distance||(this._distance=0);this._updateTooltipPosition(a.latlng);var b=a.latlng.distanceTo(this._lastPoint);this._updateTooltipDistance(this._distance+b,b);this._distance+=b}this._createTooltip(a.latlng);this._lastPoint&&!this._layerPaintPath&&(this._layerPaintPath=G.polyline([this._lastPoint],{color:"#ff0000",weight:3,clickable:!1}).addTo(this._layerPaint),this._layerPaintPath.bringToBack());
this._layerPaintPath&&this._layerPaintPath.addLatLng(a.latlng);b=(new G.CircleMarker(a.latlng,{color:"#ff0000",opacity:1,weight:2,fillColor:"#ffffff",fillOpacity:1,radius:4,clickable:this._lastPoint?!0:!1})).addTo(this._layerPaint);G.DomEvent.on(b,"click",G.DomEvent.stopPropagation).on(b,"click",G.DomEvent.preventDefault).on(b,"click",this._finishPath,this).on(b,"dblclick",G.DomEvent.stopPropagation);this._lastPoint=a.latlng}},_finishPath:function(){if(this._lastPoint){var a=G.icon({iconUrl:(new G.Icon.Default)._detectIconPath()+
"/measure-close.png",iconSize:[12,12],iconAnchor:[6,18]});this._closeButton=(new G.Marker(this._lastPoint,{icon:a,zIndexOffset:4E3})).addTo(this._layerPaint);this._layerPaints.push(this._layerPaint);var b=this._layerPaint;this._closeButton.on("click",function(){this._stopMeasuring(b)},this)}this._tooltip&&this._layerPaint.removeLayer(this._tooltip);this._layerPaint&&this._layerPaintPathTemp&&this._layerPaint.removeLayer(this._layerPaintPathTemp);this._map._container.style.cursor=this._oldCursor;G.DomUtil.removeClass(this._container,
"goomap-control-measure-on");G.DomEvent.off(document,"keydown",this._onKeyDown,this).off(this._map,"mousemove",this._mouseMove,this).off(this._map,"click",this._mouseClick,this);this._doubleClickZoom&&this._map.doubleClickZoom.enable();this._map.dragging.enable();this._restartPath()},_restartPath:function(){this._distance=0;this._measuring=this._closeButton=this._layerPaintPathTemp=this._layerPaintPath=this._layerPaint=this._lastPoint=this._tooltip=void 0},_createTooltip:function(a){var b=G.divIcon({className:"goomap-measure-tooltip",
iconAnchor:[-5,-5]});this._tooltip=G.marker(a,{icon:b,zIndexOffset:400,clickable:!1}).addTo(this._layerPaint)},_updateTooltipPosition:function(a){this._tooltip.setLatLng(a)},_updateTooltipDistance:function(a,b){var c,d,e;1<=a/1E3?(d=this._round(a),c='<div class="goomap-measure-tooltip-total">'+d+"km</div>"):(d=this._toFixed(a),c='<div class="goomap-measure-tooltip-total">'+d+"m</div>");1<=b/1E3?(e=this._round(b),0<e&&d!=e&&(c+='<div class="goomap-measure-tooltip-difference">(+'+e+"km)</div>")):(e=
this._toFixed(b),0<e&&d!=e&&(c+='<div class="goomap-measure-tooltip-difference">(+'+e+"m)</div>"));this._tooltip._icon.innerHTML=c},_round:function(a){return 0==Math.round(a/1E3*100)/100?this._toFixed(a/1E3):Math.round(a/1E3*100)/100},_toFixed:function(a){return 0==Math.round(a)?a.toFixed(2):Math.round(a)},_onKeyDown:function(a){27==a.keyCode&&(this._lastPoint?this._finishPath():this._toggleMeasure())}});G.Map.mergeOptions({distanceMeasureControl:!1});
G.Map.addInitHook(function(){this.options.distanceMeasureControl&&(this.distanceMeasureControl=new G.Control.DistanceMeasure,this.addControl(this.distanceMeasureControl))});G.control.distanceMeasure=function(a){return new G.Control.DistanceMeasure(a)};G.Control.AreaMeasure=G.Control.extend({options:{position:"topleft"},onAdd:function(a){a=G.DomUtil.create("div","goomap-control-zoom goomap-bar goomap-control");this._createButton("","\u6d4b\u91cf\u9762\u79ef(\u53cc\u51fb\u6216\u6309ESC\u7ed3\u675f\u6d4b\u91cf)","goomap-control-area-measure goomap-bar-part goomap-bar-part-top-and-bottom",a,this._startMeasuring,this);return a},_createButton:function(a,b,c,d,e,g){c=G.DomUtil.create("a",c,d);c.innerHTML=a;c.href="#";c.title=b;G.DomEvent.on(c,"click",
G.DomEvent.stopPropagation).on(c,"click",G.DomEvent.preventDefault).on(c,"click",e,g).on(c,"dblclick",G.DomEvent.stopPropagation);return c},_startMeasuring:function(){this._measuring?this._stopMeasuring():(this._measuring=!0,G.DomUtil.addClass(this._container,"goomap-control-area-measure-on"),this._oldCursor=this._map._container.style.cursor,this._map._container.style.cursor="crosshair",this._doubleClickZoom=this._map.doubleClickZoom.enabled(),this._map.doubleClickZoom.disable(),G.DomEvent.on(this._map,
"mousemove",this._mouseMove,this).on(this._map,"click",this._mouseClick,this).on(document,"keydown",this._onKeyDown,this),this._layerPaints||(this._layerPaints=[]),this._layerPaint||(this._layerPaint=G.layerGroup().addTo(this._map)),this._points||(this._points=[]))},_stopMeasuring:function(a){G.DomUtil.removeClass(this._container,"goomap-control-area-measure-on");this._map._container.style.cursor=this._oldCursor;G.DomEvent.off(document,"keydown",this._onKeyDown,this).off(this._map,"mousemove",this._mouseMove,
this).off(this._map,"click",this._mouseClick,this);this._doubleClickZoom&&this._map.doubleClickZoom.enable();if(a)a.clearLayers();else for(i in this._layerPaints)this._layerPaints[i].clearLayers();this._measuring=!1;this._restartPath()},_mouseMove:function(a){if(a.latlng&&this._lastPoint&&(this._layerPaintPathTemp?this._layerPaintPathTemp.setLatLngs([this._lastPoint,a.latlng]):this._layerPaintPathTemp=G.polyline([this._lastPoint,a.latlng],{color:"#ff0000",weight:2,clickable:!1,dashArray:"6,3"}).addTo(this._layerPaint),
this._tooltip)){this._area||(this._area=0);this._updateTooltipPosition(a.latlng);var b=this._layerPaintPath.getLatLngs()[0];b.push(a.latlng);a=G.GeometryUtil.geodesicArea(b);this._updateTooltipArea(a)}},_mouseClick:function(a){if(a.latlng){(this._lastPoint=a.latlng)&&!this._layerPaintPath&&(this._layerPaintPath=G.polygon([this._lastPoint],{color:"#ff0000",weight:3,clickable:!1}).addTo(this._layerPaint));this._layerPaintPath&&this._layerPaintPath.addLatLng(a.latlng);var b=(new G.CircleMarker(a.latlng,
{color:"#ff0000",opacity:1,weight:2,fillColor:"#ffffff",fillOpacity:1,radius:4,clickable:this._lastPoint?!0:!1})).addTo(this._layerPaint);G.DomEvent.on(b,"click",G.DomEvent.stopPropagation).on(b,"click",G.DomEvent.preventDefault).on(b,"click",this._finishPath,this).on(b,"dblclick",G.DomEvent.stopPropagation);this._lastPoint=a.latlng}},_finishPath:function(){if(this._layerPaintPath){var a=this._layerPaintPath.getLatLngs();G.Polyline._flat(a)||(a=a[0]);3<=a.length&&(this._area=G.GeometryUtil.geodesicArea(a))}if(this._lastPoint){this._createTooltip(this._lastPoint);
this._updateTooltipArea(this._area);a=G.icon({iconUrl:(new G.Icon.Default)._detectIconPath()+"/measure-close.png",iconSize:[12,12],iconAnchor:[6,18]});this._closeButton=(new G.Marker(this._lastPoint,{icon:a,zIndexOffset:4E3})).addTo(this._layerPaint);this._layerPaints.push(this._layerPaint);var b=this._layerPaint;this._closeButton.on("click",function(){this._stopMeasuring(b)},this)}this._layerPaint&&this._layerPaintPathTemp&&this._layerPaint.removeLayer(this._layerPaintPathTemp);this._map._container.style.cursor=
this._oldCursor;G.DomUtil.removeClass(this._container,"goomap-control-area-measure-on");G.DomEvent.off(document,"keydown",this._onKeyDown,this).off(this._map,"mousemove",this._mouseMove,this).off(this._map,"click",this._mouseClick,this);this._doubleClickZoom&&this._map.doubleClickZoom.enable();this._restartPath()},_restartPath:function(){this._area=0;this._measuring=this._closeButton=this._layerPaintPathTemp=this._layerPaintPath=this._layerPaint=this._lastPoint=this._tooltip=void 0},_createTooltip:function(a){var b=
G.divIcon({className:"goomap-area-measure-tooltip",iconAnchor:[-5,-5]});this._tooltip=G.marker(a,{icon:b,zIndexOffset:400,clickable:!1}).addTo(this._layerPaint)},_updateTooltipPosition:function(a){this._tooltip.setLatLng(a)},_updateTooltipArea:function(a){a="\u603b\u9762\u79ef\uff1a"+G.GeometryUtil.readableArea(a,!0);this._tooltip._icon.innerHTML=a},_onKeyDown:function(a){27==a.keyCode&&this._finishPath()}});G.Map.mergeOptions({areaMeasureControl:!1});
G.Map.addInitHook(function(){this.options.areaMeasureControl&&(this.areaMeasureControl=new G.Control.AreaMeasure,this.addControl(this.areaMeasureControl))});G.control.areaMeasure=function(a){return new G.Control.AreaMeasure(a)};G.Control.GroupedLayers=G.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,exclusiveGroups:[],groupCheckboxes:!1},initialize:function(a,b,c){var d,e;G.Util.setOptions(this,c);this._layers=[];this._lastZIndex=0;this._handlingClick=!1;this._groupList=[];this._domGroups=[];for(d in a)this._addLayer(a[d],d);for(d in b)for(e in b[d])this._addLayer(b[d][e],e,d,!0)},onAdd:function(a){this._initLayout();this._update();a.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,
this);return this._container},onRemove:function(a){a.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(a,b){this._addLayer(a,b);this._update();return this},addOverlay:function(a,b,c){this._addLayer(a,b,c,!0);this._update();return this},removeLayer:function(a){a=G.Util.stamp(a);(a=this._getLayer(a))&&delete this._layers[this._layers.indexOf(a)];this._update();return this},_getLayer:function(a){for(var b=0;b<this._layers.length;b++)if(this._layers[b]&&
G.stamp(this._layers[b].layer)===a)return this._layers[b]},_initLayout:function(){var a=this._container=G.DomUtil.create("div","goomap-control-layers");a.setAttribute("aria-haspopup",!0);if(G.Browser.touch)G.DomEvent.on(a,"click",G.DomEvent.stopPropagation);else G.DomEvent.disableClickPropagation(a),G.DomEvent.on(a,"wheel",G.DomEvent.stopPropagation);var b=this._form=G.DomUtil.create("form","goomap-control-layers-list");if(this.options.collapsed){if(!G.Browser.android)G.DomEvent.on(a,"mouseover",
this._expand,this).on(a,"mouseout",this._collapse,this);var c=this._layersLink=G.DomUtil.create("a","goomap-control-layers-toggle",a);c.href="#";c.title="Layers";if(G.Browser.touch)G.DomEvent.on(c,"click",G.DomEvent.stop).on(c,"click",this._expand,this);else G.DomEvent.on(c,"focus",this._expand,this);this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=G.DomUtil.create("div","goomap-control-layers-base",b);this._separator=G.DomUtil.create("div","goomap-control-layers-separator",
b);this._overlaysList=G.DomUtil.create("div","goomap-control-layers-overlays",b);a.appendChild(b)},_addLayer:function(a,b,c,d){G.Util.stamp(a);b={layer:a,name:b,overlay:d};this._layers.push(b);c=c||"";d=this._indexOf(this._groupList,c);-1===d&&(d=this._groupList.push(c)-1);var e=-1!==this._indexOf(this.options.exclusiveGroups,c);b.group={name:c,id:d,exclusive:e};this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML=
"";this._overlaysList.innerHTML="";this._domGroups.length=0;var a=!1,b=!1,c,d;for(c=0;c<this._layers.length;c++)d=this._layers[c],this._addItem(d),b=b||d.overlay,a=a||!d.overlay;this._separator.style.display=b&&a?"":"none"}},_onLayerChange:function(a){var b=this._getLayer(G.Util.stamp(a.layer));b&&(this._handlingClick||this._update(),(a=b.overlay?"layeradd"===a.type?"overlayadd":"overlayremove":"layeradd"===a.type?"baselayerchange":null)&&this._map.fire(a,b))},_createRadioElement:function(a,b){var c=
'<input type="radio" class="goomap-control-layers-selector" name="'+a+'"';b&&(c+=' checked="checked"');var c=c+"/>",d=document.createElement("div");d.innerHTML=c;return d.firstChild},_addItem:function(a){var b=document.createElement("label"),c,d=this._map.hasLayer(a.layer);a.overlay?a.group.exclusive?(c="goomap-exclusive-group-layer-"+a.group.id,c=this._createRadioElement(c,d)):(c=document.createElement("input"),c.type="checkbox",c.className="goomap-control-layers-selector",c.defaultChecked=d):c=
this._createRadioElement("goomap-base-layers",d);c.layerId=G.Util.stamp(a.layer);c.groupID=a.group.id;G.DomEvent.on(c,"click",this._onInputClick,this);d=document.createElement("span");d.innerHTML=" "+a.name;b.appendChild(c);b.appendChild(d);if(a.overlay){c=this._overlaysList;d=this._domGroups[a.group.id];if(!d){d=document.createElement("div");d.className="goomap-control-layers-group";d.id="goomap-control-layers-group-"+a.group.id;var e=document.createElement("label");e.className="goomap-control-layers-group-label";
if(""!==a.group.name&&!a.group.exclusive&&this.options.groupCheckboxes){var g=document.createElement("input");g.type="checkbox";g.className="goomap-control-layers-group-selector";g.groupID=a.group.id;g.legend=this;G.DomEvent.on(g,"click",this._onGroupInputClick,g);e.appendChild(g)}g=document.createElement("span");g.className="goomap-control-layers-group-name";g.innerHTML=a.group.name;e.appendChild(g);d.appendChild(e);c.appendChild(d);this._domGroups[a.group.id]=d}c=d}else c=this._baseLayersList;c.appendChild(b);
return b},_onGroupInputClick:function(){var a,b,c,d=this.legend;d._handlingClick=!0;var e=d._form.getElementsByTagName("input"),g=e.length;for(a=0;a<g;a++)b=e[a],b.groupID===this.groupID&&"goomap-control-layers-selector"===b.className&&(b.checked=this.checked,c=d._getLayer(b.layerId),b.checked&&!d._map.hasLayer(c.layer)?d._map.addLayer(c.layer):!b.checked&&d._map.hasLayer(c.layer)&&d._map.removeLayer(c.layer));d._handlingClick=!1},_onInputClick:function(){var a,b,c,d=this._form.getElementsByTagName("input"),
e=d.length;this._handlingClick=!0;for(a=0;a<e;a++)b=d[a],"goomap-control-layers-selector"===b.className&&(c=this._getLayer(b.layerId),b.checked&&!this._map.hasLayer(c.layer)?this._map.addLayer(c.layer):!b.checked&&this._map.hasLayer(c.layer)&&this._map.removeLayer(c.layer));this._handlingClick=!1},_expand:function(){G.DomUtil.addClass(this._container,"goomap-control-layers-expanded");var a=this._map._size.y-4*this._container.offsetTop;a<this._form.clientHeight&&(G.DomUtil.addClass(this._form,"goomap-control-layers-scrollbar"),
this._form.style.height=a+"px")},_collapse:function(){this._container.className=this._container.className.replace(" goomap-control-layers-expanded","")},_indexOf:function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}});G.control.groupedLayers=function(a,b,c){return new G.Control.GroupedLayers(a,b,c)};(function(a){a.ChinaProj={x_PI:52.35987755982988,PI:3.141592653589793,a:6378245,ee:.006693421622965943,bd09togcj02:function(b){var c=this.x_PI,d=b.lng-.0065,e=b.lat-.006;b=Math.sqrt(d*d+e*e)-2E-5*Math.sin(e*c);c=Math.atan2(e,d)-3E-6*Math.cos(d*c);return a.latLng(b*Math.sin(c),b*Math.cos(c))},gcj02tobd09:function(b){var c=b.lat,d=b.lng;b=Math.sqrt(d*d+c*c)+2E-5*Math.sin(c*this.x_PI);c=Math.atan2(c,d)+3E-6*Math.cos(d*this.x_PI);return a.latLng(b*Math.sin(c)+.006,b*Math.cos(c)+.0065)},wgs84togcj02:function(b){var c=
b.lat,d=b.lng;if(this.out_of_china(d,c))return b;b=this.transformlat(d-105,c-35);var e=this.transformlng(d-105,c-35),g=c/180*this.PI,h=Math.sin(g),h=1-this.ee*h*h,k=Math.sqrt(h);b=180*b/(this.a*(1-this.ee)/(h*k)*this.PI);e=180*e/(this.a/k*Math.cos(g)*this.PI);return a.latLng(c+b,d+e)},gcj02towgs84:function(b){var c=b.lat,d=b.lng;if(this.out_of_china(d,c))return b;b=this.transformlat(d-105,c-35);var e=this.transformlng(d-105,c-35),g=c/180*this.PI,h=Math.sin(g),h=1-this.ee*h*h,k=Math.sqrt(h);b=180*
b/(this.a*(1-this.ee)/(h*k)*this.PI);e=180*e/(this.a/k*Math.cos(g)*this.PI);return a.latLng(2*c-(c+b),2*d-(d+e))},wgs84tobd09:function(a){return this.gcj02tobd09(this.wgs84togcj02(a))},bd09towgs84:function(a){return this.gcj02towgs84(this.bd09togcj02(a))},transformlat:function(a,c){var b=-100+2*a+3*c+.2*c*c+.1*a*c+.2*Math.sqrt(Math.abs(a)),b=b+2*(20*Math.sin(6*a*this.PI)+20*Math.sin(2*a*this.PI))/3,b=b+2*(20*Math.sin(c*this.PI)+40*Math.sin(c/3*this.PI))/3;return b+=2*(160*Math.sin(c/12*this.PI)+320*
Math.sin(c*this.PI/30))/3},transformlng:function(a,c){var b=300+a+2*c+.1*a*a+.1*a*c+.1*Math.sqrt(Math.abs(a)),b=b+2*(20*Math.sin(6*a*this.PI)+20*Math.sin(2*a*this.PI))/3,b=b+2*(20*Math.sin(a*this.PI)+40*Math.sin(a/3*this.PI))/3;return b+=2*(150*Math.sin(a/12*this.PI)+300*Math.sin(a/30*this.PI))/3},out_of_china:function(a,c){return 72.004>a||137.8347<a||.8293>c||55.8271<c||!1}}})(G);G.Control.Dialog=G.Control.extend({options:{size:[300,300],minSize:[100,100],maxSize:[350,350],anchor:[250,250],position:"topleft",initOpen:!0},initialize:function(a){G.setOptions(this,a);this._attributions={}},onAdd:function(a){this._initLayout();this._map=a;this.update();this.options.initOpen||this.close();return this._container},open:function(){if(this._map)return this._container.style.visibility="",this._map.fire("dialog:opened",this),this},close:function(){this._container.style.visibility="hidden";
this._map.fire("dialog:closed",this);return this},destroy:function(){if(!this._map)return this;this.removeFrom(this._map);if(this.onRemove)this.onRemove(this._map);this._map.fire("dialog:destroyed",this);return this},setLocation:function(a){a=a||[250,250];this.options.anchor[0]=0;this.options.anchor[1]=0;this._oldMousePos.x=0;this._oldMousePos.y=0;this._move(a[1],a[0]);return this},setSize:function(a){a=a||[300,300];this.options.size[0]=0;this.options.size[1]=0;this._oldMousePos.x=0;this._oldMousePos.y=
0;this._resize(a[0],a[1]);return this},lock:function(){this._resizerNode.style.visibility="hidden";this._grabberNode.style.visibility="hidden";this._closeNode.style.visibility="hidden";this._map.fire("dialog:locked",this);return this},unlock:function(){this._resizerNode.style.visibility="";this._grabberNode.style.visibility="";this._closeNode.style.visibility="";this._map.fire("dialog:unlocked",this);return this},freeze:function(){this._resizerNode.style.visibility="hidden";this._grabberNode.style.visibility=
"hidden";this._map.fire("dialog:frozen",this);return this},unfreeze:function(){this._resizerNode.style.visibility="";this._grabberNode.style.visibility="";this._map.fire("dialog:unfrozen",this);return this},setContent:function(a){this._content=a;this.update();return this},getContent:function(){return this._content},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._container.style.visibility=
"",this._map.fire("dialog:updated",this))},_initLayout:function(){var a=this._container=G.DomUtil.create("div","goomap-control-dialog");a.style.width=this.options.size[0]+"px";a.style.height=this.options.size[1]+"px";a.style.top=this.options.anchor[0]+"px";a.style.left=this.options.anchor[1]+"px";var b=G.DomEvent.stopPropagation;G.DomEvent.on(a,"click",b).on(a,"mousedown",b).on(a,"touchstart",b).on(a,"dblclick",b).on(a,"mousewheel",b).on(a,"contextmenu",b).on(a,"MozMousePixelScroll",b);var b=this._innerContainer=
G.DomUtil.create("div","goomap-control-dialog-inner"),c=this._grabberNode=G.DomUtil.create("div","goomap-control-dialog-grabber"),d=G.DomUtil.create("i","fa fa-arrows");c.appendChild(d);G.DomEvent.on(c,"mousedown",this._handleMoveStart,this);var d=this._closeNode=G.DomUtil.create("div","goomap-control-dialog-close"),e=G.DomUtil.create("i","fa fa-times");d.appendChild(e);G.DomEvent.on(d,"click",this._handleClose,this);var e=this._resizerNode=G.DomUtil.create("div","goomap-control-dialog-resizer"),
g=G.DomUtil.create("i","fa fa-arrows-h fa-rotate-45");e.appendChild(g);G.DomEvent.on(e,"mousedown",this._handleResizeStart,this);g=this._contentNode=G.DomUtil.create("div","goomap-control-dialog-contents");a.appendChild(b);b.appendChild(g);b.appendChild(c);b.appendChild(d);b.appendChild(e);this._oldMousePos={x:0,y:0}},_handleClose:function(){this.close()},_handleResizeStart:function(a){this._oldMousePos.x=a.clientX;this._oldMousePos.y=a.clientY;G.DomEvent.on(this._map,"mousemove",this._handleMouseMove,
this);G.DomEvent.on(this._map,"mouseup",this._handleMouseUp,this);this._map.fire("dialog:resizestart",this);this._resizing=!0},_handleMoveStart:function(a){this._oldMousePos.x=a.clientX;this._oldMousePos.y=a.clientY;G.DomEvent.on(this._map,"mousemove",this._handleMouseMove,this);G.DomEvent.on(this._map,"mouseup",this._handleMouseUp,this);this._map.fire("dialog:movestart",this);this._moving=!0},_handleMouseMove:function(a){var b=a.originalEvent.clientX-this._oldMousePos.x,c=a.originalEvent.clientY-
this._oldMousePos.y;a.originalEvent.stopPropagation&&a.originalEvent.stopPropagation();a.originalEvent.preventDefault&&a.originalEvent.preventDefault();this._resizing&&this._resize(b,c);this._moving&&this._move(b,c)},_handleMouseUp:function(){G.DomEvent.off(this._map,"mousemove",this._handleMouseMove,this);G.DomEvent.off(this._map,"mouseup",this._handleMouseUp,this);this._resizing&&(this._resizing=!1,this._map.fire("dialog:resizeend",this));this._moving&&(this._moving=!1,this._map.fire("dialog:moveend",
this))},_move:function(a,b){var c=this.options.anchor[1]+a;this.options.anchor[0]+=b;this.options.anchor[1]=c;this._container.style.top=this.options.anchor[0]+"px";this._container.style.left=this.options.anchor[1]+"px";this._map.fire("dialog:moving",this);this._oldMousePos.y+=b;this._oldMousePos.x+=a},_resize:function(a,b){var c=this.options.size[0]+a,d=this.options.size[1]+b;c<=this.options.maxSize[0]&&c>=this.options.minSize[0]&&(this.options.size[0]=c,this._container.style.width=this.options.size[0]+
"px",this._oldMousePos.x+=a);d<=this.options.maxSize[1]&&d>=this.options.minSize[1]&&(this.options.size[1]=d,this._container.style.height=this.options.size[1]+"px",this._oldMousePos.y+=b);this._map.fire("dialog:resizing",this)},_updateContent:function(){if(this._content){var a=this._contentNode,b="function"===typeof this._content?this._content(this):this._content;if("string"===typeof b)a.innerHTML=b;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(b)}}},_updateLayout:function(){this._container.style.width=
this.options.size[0]+"px";this._container.style.height=this.options.size[1]+"px";this._container.style.top=this.options.anchor[0]+"px";this._container.style.left=this.options.anchor[1]+"px"}});G.control.dialog=function(a){return new G.Control.Dialog(a)};G.Control.MousePosition=G.Control.extend({options:{position:"bottomleft",separator:" : ",emptyString:"Unavailable",lngFirst:!1,numDigits:5,lngFormatter:void 0,latFormatter:void 0,prefix:""},onAdd:function(a){this._container=G.DomUtil.create("div","goomap-control-mouseposition");G.DomEvent.disableClickPropagation(this._container);a.on("mousemove",this._onMouseMove,this);this._container.innerHTML=this.options.emptyString;return this._container},onRemove:function(a){a.off("mousemove",this._onMouseMove)},
_onMouseMove:function(a){var b=this.options.lngFormatter?this.options.lngFormatter(a.latlng.lng):G.Util.formatNum(a.latlng.lng,this.options.numDigits);a=this.options.latFormatter?this.options.latFormatter(a.latlng.lat):G.Util.formatNum(a.latlng.lat,this.options.numDigits);this._container.innerHTML=this.options.prefix+" "+(this.options.lngFirst?b+this.options.separator+a:a+this.options.separator+b)}});G.Map.mergeOptions({positionControl:!1});
G.Map.addInitHook(function(){this.options.positionControl&&(this.positionControl=new G.Control.MousePosition,this.addControl(this.positionControl))});G.control.mousePosition=function(a){return new G.Control.MousePosition(a)};G.AnimatedMarker=G.Marker.extend({options:{distance:200,interval:1E3,autoStart:!0,onEnd:function(){},clickable:!1},initialize:function(a,b){this.setLine(a);G.Marker.prototype.initialize.call(this,a[0],b)},_chunk:function(a){var b,c=a.length,d=[];for(b=1;b<c;b++){var e=a[b-1],g=a[b],h=e.distanceTo(g),k=this.options.distance/h,m=k*(g.lat-e.lat),k=k*(g.lng-e.lng);if(h>this.options.distance)for(;h>this.options.distance;)e=new G.LatLng(e.lat+m,e.lng+k),h=e.distanceTo(g),d.push(e);else d.push(e)}d.push(a[c-
1]);return d},onAdd:function(a){G.Marker.prototype.onAdd.call(this,a);this.options.autoStart&&this.start()},animate:function(){var a=this,b=this._latlngs.length,c=this.options.interval;this._i<b&&0<this._i&&(c=this._latlngs[this._i-1].distanceTo(this._latlngs[this._i])/this.options.distance*this.options.interval);G.DomUtil.TRANSITION&&(this._icon&&(this._icon.style[G.DomUtil.TRANSITION]="all "+c+"ms linear"),this._shadow&&(this._shadow.style[G.DomUtil.TRANSITION]="all "+c+"ms linear"));this.setLatLng(this._latlngs[this._i]);
this._i++;this._tid=setTimeout(function(){a._i===b?a.options.onEnd.apply(a,Array.prototype.slice.call(arguments)):a.animate()},c)},start:function(){this.animate()},stop:function(){this._tid&&clearTimeout(this._tid)},setLine:function(a){G.DomUtil.TRANSITION?this._latlngs=a:(this._latlngs=this._chunk(a),this.options.distance=10,this.options.interval=30);this._i=0}});G.animatedMarker=function(a,b){return new G.AnimatedMarker(a,b)};(function(a,b,c){G.ExtraMarkers={};G.ExtraMarkers.version="1.0.6";G.ExtraMarkers.Icon=G.Icon.extend({options:{iconSize:[35,45],iconAnchor:[17,42],popupAnchor:[1,-32],tooltipAnchor:[16,-28],shadowAnchor:[10,12],shadowSize:[36,16],className:"",prefix:"",extraClasses:"",shape:"circle",icon:"",innerHTML:"",markerColor:"red",svgBorderColor:"#fff",svgOpacity:1,iconColor:"#fff",number:"",svg:!1},initialize:function(a){G.Util.setOptions(this,a)},createIcon:function(){var a=b.createElement("div"),c=this.options;
c.icon&&(a.innerHTML=this._createInner());c.innerHTML&&(a.innerHTML=c.innerHTML);c.bgPos&&(a.style.backgroundPosition=-c.bgPos.x+"px "+-c.bgPos.y+"px");c.svg?this._setIconStyles(a,"svg"):this._setIconStyles(a,c.shape+"-"+c.markerColor);return a},_createInner:function(){var a="",b="",c=this.options;c.iconColor&&(a="style='color: "+c.iconColor+"' ");c.number&&(b="number='"+c.number+"' ");if(c.svg){var h='<svg xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 69.529271 95.44922" style="fill:'+
c.markerColor+";stroke:"+c.svgBorderColor+";fill-opacity:"+c.svgOpacity+';" height="100%" width="100%" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/"><g transform="translate(-139.52 -173.21)"><path d="m174.28 173.21c-19.199 0.00035-34.764 15.355-34.764 34.297 0.007 6.7035 1.5591 12.813 5.7461 18.854l0.0234 0.0371 28.979 42.262 28.754-42.107c3.1982-5.8558 5.9163-11.544 6.0275-19.045-0.0001-18.942-15.565-34.298-34.766-34.297z"/></g></svg>';"square"==
c.shape&&(h='<svg xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 69.457038 96.523441" style="fill:'+c.markerColor+";stroke:"+c.svgBorderColor+";fill-opacity:"+c.svgOpacity+';" height="100%" width="100%" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/"><g transform="translate(-545.27 -658.39)"><path d="m545.27 658.39v65.301h22.248l12.48 31.223 12.676-31.223h22.053v-65.301h-69.457z"/></g></svg>');
"star"==c.shape&&(h='<svg style="top:0; fill:'+c.markerColor+";stroke:"+c.svgBorderColor+";fill-opacity:"+c.svgOpacity+';" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="100%" width="100%" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 77.690999 101.4702"><g transform="translate(-101.15 -162.97)"><g transform="matrix(1 0 0 1.0165 -65.712 -150.28)"><path d="m205.97 308.16-11.561 11.561h-16.346v16.346l-11.197 11.197 11.197 11.197v15.83h15.744l11.615 33.693 11.467-33.568 0.125-0.125h16.346v-16.346l11.197-11.197-11.197-11.197v-15.83h-15.83l-11.561-11.561z"/></g></g></svg>');
"penta"==c.shape&&(h='<svg style="fill:'+c.markerColor+";stroke:"+c.svgBorderColor+";fill-opacity:"+c.svgOpacity+';"   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 71.550368 96.362438" height="100%" width="100%" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/"><g transform="translate(-367.08 -289.9)"><path d="m367.08 322.5 17.236-32.604h36.151l18.164 32.25-35.665 64.112z"/></g></svg>');return h+
"<i "+b+a+"class='"+c.extraClasses+" "+c.prefix+" "+c.icon+"'></i>"}return"<i "+b+a+"class='"+c.extraClasses+" "+c.prefix+" "+c.icon+"'></i>"},_setIconStyles:function(a,b){var c=this.options,d=G.point(c["shadow"===b?"shadowSize":"iconSize"]),e,m;"shadow"===b?(e=G.point(c.shadowAnchor||c.iconAnchor),m="shadow"):(e=G.point(c.iconAnchor),m="icon");!e&&d&&(e=d.divideBy(2,!0));a.className="goomap-marker-"+m+" extra-marker extra-marker-"+b+" "+c.className;e&&(a.style.marginLeft=-e.x+"px",a.style.marginTop=
-e.y+"px");d&&(a.style.width=d.x+"px",a.style.height=d.y+"px")},createShadow:function(){var a=b.createElement("div");this._setIconStyles(a,"shadow");return a}});G.ExtraMarkers.icon=function(a){return new G.ExtraMarkers.Icon(a)}})(window,document);(function(a){if("function"===typeof define&&define.amd)define(["goomap"],a);else if("undefined"!==typeof module)module.exports=a(require("goomap"));else{if("undefined"===typeof window.G)throw Error("GooMap must be loaded first");a(window.G)}})(function(a){a.Control.Fullscreen=a.Control.extend({options:{position:"topleft",title:{"false":"\u5168\u5c4f","true":"\u9000\u51fa\u5168\u5c4f"}},onAdd:function(b){var c=a.DomUtil.create("div","goomap-control-fullscreen goomap-bar goomap-control");this.link=
a.DomUtil.create("a","goomap-control-fullscreen-button goomap-bar-part",c);this.link.href="#";this._map=b;this._map.on("fullscreenchange",this._toggleTitle,this);this._toggleTitle();a.DomEvent.on(this.link,"click",this._click,this);return c},_click:function(b){a.DomEvent.stopPropagation(b);a.DomEvent.preventDefault(b);this._map.toggleFullscreen(this.options)},_toggleTitle:function(){this.link.title=this.options.title[this._map.isFullscreen()]}});a.Map.include({isFullscreen:function(){return this._isFullscreen||
!1},toggleFullscreen:function(a){var b=this.getContainer();this.isFullscreen()?a&&a.pseudoFullscreen?this._disablePseudoFullscreen(b):document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():this._disablePseudoFullscreen(b):a&&a.pseudoFullscreen?this._enablePseudoFullscreen(b):b.requestFullscreen?b.requestFullscreen():b.mozRequestFullScreen?
b.mozRequestFullScreen():b.webkitRequestFullscreen?b.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):b.msRequestFullscreen?b.msRequestFullscreen():this._enablePseudoFullscreen(b)},_enablePseudoFullscreen:function(b){a.DomUtil.addClass(b,"goomap-pseudo-fullscreen");this._setFullscreen(!0);this.fire("fullscreenchange")},_disablePseudoFullscreen:function(b){a.DomUtil.removeClass(b,"goomap-pseudo-fullscreen");this._setFullscreen(!1);this.fire("fullscreenchange")},_setFullscreen:function(b){this._isFullscreen=
b;var c=this.getContainer();b?a.DomUtil.addClass(c,"goomap-fullscreen-on"):a.DomUtil.removeClass(c,"goomap-fullscreen-on");this.invalidateSize()},_onFullscreenChange:function(a){a=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;a!==this.getContainer()||this._isFullscreen?a!==this.getContainer()&&this._isFullscreen&&(this._setFullscreen(!1),this.fire("fullscreenchange")):(this._setFullscreen(!0),this.fire("fullscreenchange"))}});
a.Map.mergeOptions({fullscreenControl:!1});a.Map.addInitHook(function(){this.options.fullscreenControl&&(this.fullscreenControl=new a.Control.Fullscreen(this.options.fullscreenControl),this.addControl(this.fullscreenControl));var b;"onfullscreenchange"in document?b="fullscreenchange":"onmozfullscreenchange"in document?b="mozfullscreenchange":"onwebkitfullscreenchange"in document?b="webkitfullscreenchange":"onmsfullscreenchange"in document&&(b="MSFullscreenChange");if(b){var c=a.bind(this._onFullscreenChange,
this);this.whenReady(function(){a.DomEvent.on(document,b,c)});this.on("unload",function(){a.DomEvent.off(document,b,c)})}});a.control.fullscreen=function(b){return new a.Control.Fullscreen(b)}});(function(){var a=G.Marker.prototype._initIcon,b=G.Marker.prototype._setPos,c="msTransform"===G.DomUtil.TRANSFORM;G.Marker.addInitHook(function(){var a=this.options.icon&&this.options.icon.options&&this.options.icon.options.iconAnchor;a&&(a=a[0]+"px "+a[1]+"px");this.options.rotationOrigin=this.options.rotationOrigin||a||"center bottom";this.options.rotationAngle=this.options.rotationAngle||0;this.on("drag",function(a){a.target._applyRotation()})});G.Marker.include({_initIcon:function(){a.call(this)},
_setPos:function(a){b.call(this,a);this._applyRotation()},_applyRotation:function(){this.options.rotationAngle&&(this._icon.style[G.DomUtil.TRANSFORM+"Origin"]=this.options.rotationOrigin,this._icon.style[G.DomUtil.TRANSFORM]=c?"rotate("+this.options.rotationAngle+"deg)":this._icon.style[G.DomUtil.TRANSFORM]+(" rotateZ("+this.options.rotationAngle+"deg)"))},setRotationAngle:function(a){this.options.rotationAngle=a;this.update();return this},setRotationOrigin:function(a){this.options.rotationOrigin=
a;this.update();return this}})})();(function(){function a(a,d){this.title=a.title;this.stateName=a.stateName?a.stateName:"unnamed-state";this.icon=G.DomUtil.create("span","");G.DomUtil.addClass(this.icon,"button-state state-"+this.stateName.replace(/(^\s*|\s*$)/g,""));this.icon.innerHTML=b(a.icon);this.onClick=G.Util.bind(a.onClick?a.onClick:function(){},d)}function b(a){var b;a.match(/[&;=<>"']/)?b=a:(a=a.replace(/(^\s*|\s*$)/g,""),b=G.DomUtil.create("span",""),0===a.indexOf("fa-")?G.DomUtil.addClass(b,"fa "+a):0===a.indexOf("glyphicon-")?
G.DomUtil.addClass(b,"glyphicon "+a):G.DomUtil.addClass(b,a),b=b.outerHTML);return b}G.Control.EasyBar=G.Control.extend({options:{position:"topleft",id:null,goomapClasses:!0},initialize:function(a,b){b&&G.Util.setOptions(this,b);this._buildContainer();this._buttons=[];for(var c=0;c<a.length;c++)a[c]._bar=this,a[c]._container=a[c].button,this._buttons.push(a[c]),this.container.appendChild(a[c].button)},_buildContainer:function(){this._container=this.container=G.DomUtil.create("div","");this.options.goomapClasses&&
G.DomUtil.addClass(this.container,"goomap-bar easy-button-container goomap-control");this.options.id&&(this.container.id=this.options.id)},enable:function(){G.DomUtil.addClass(this.container,"enabled");G.DomUtil.removeClass(this.container,"disabled");this.container.setAttribute("aria-hidden","false");return this},disable:function(){G.DomUtil.addClass(this.container,"disabled");G.DomUtil.removeClass(this.container,"enabled");this.container.setAttribute("aria-hidden","true");return this},onAdd:function(){return this.container},
addTo:function(a){this._map=a;for(var b=0;b<this._buttons.length;b++)this._buttons[b]._map=a;var b=this._container=this.onAdd(a),c=this.getPosition();a=a._controlCorners[c];G.DomUtil.addClass(b,"goomap-control");-1!==c.indexOf("bottom")?a.insertBefore(b,a.firstChild):a.appendChild(b);return this}});G.easyBar=function(){for(var a=[G.Control.EasyBar],b=0;b<arguments.length;b++)a.push(arguments[b]);return new (Function.prototype.bind.apply(G.Control.EasyBar,a))};G.Control.EasyButton=G.Control.extend({options:{position:"topleft",
id:null,type:"replace",states:[],goomapClasses:!0,tagName:"button"},initialize:function(b,d,e,g){this.options.states=[];null!=g&&(this.options.id=g);this.storage={};"object"===typeof arguments[arguments.length-1]&&G.Util.setOptions(this,arguments[arguments.length-1]);0===this.options.states.length&&"string"===typeof b&&"function"===typeof d&&this.options.states.push({icon:b,onClick:d,title:"string"===typeof e?e:""});this._states=[];for(var c=0;c<this.options.states.length;c++)this._states.push(new a(this.options.states[c],
this));this._buildButton();this._activateState(this._states[0])},_buildButton:function(){this.button=G.DomUtil.create(this.options.tagName,"");"button"===this.options.tagName&&this.button.setAttribute("type","button");this.options.id&&(this.button.id=this.options.id);this.options.goomapClasses&&G.DomUtil.addClass(this.button,"easy-button-button goomap-bar-part goomap-interactive");G.DomEvent.addListener(this.button,"dblclick",G.DomEvent.stop);G.DomEvent.addListener(this.button,"mousedown",G.DomEvent.stop);
G.DomEvent.addListener(this.button,"click",function(a){G.DomEvent.stop(a);this._currentState.onClick(this,this._map?this._map:null);this._map&&this._map.getContainer().focus()},this);if("replace"==this.options.type)this.button.appendChild(this._currentState.icon);else for(var a=0;a<this._states.length;a++)this.button.appendChild(this._states[a].icon)},_currentState:{stateName:"unnamed",icon:document.createElement("span")},_states:null,state:function(a){"string"==typeof a?this._activateStateNamed(a):
"number"==typeof a&&this._activateState(this._states[a]);return this},_activateStateNamed:function(a){for(var b=0;b<this._states.length;b++)this._states[b].stateName==a&&this._activateState(this._states[b])},_activateState:function(a){if(a!==this._currentState){"replace"==this.options.type&&(this.button.appendChild(a.icon),this.button.removeChild(this._currentState.icon));a.title?this.button.title=a.title:this.button.removeAttribute("title");for(var b=0;b<this._states.length;b++)G.DomUtil.removeClass(this._states[b].icon,
this._currentState.stateName+"-active"),G.DomUtil.addClass(this._states[b].icon,a.stateName+"-active");G.DomUtil.removeClass(this.button,this._currentState.stateName+"-active");G.DomUtil.addClass(this.button,a.stateName+"-active");this._currentState=a}},enable:function(){G.DomUtil.addClass(this.button,"enabled");G.DomUtil.removeClass(this.button,"disabled");this.button.setAttribute("aria-hidden","false");return this},disable:function(){G.DomUtil.addClass(this.button,"disabled");G.DomUtil.removeClass(this.button,
"enabled");this.button.setAttribute("aria-hidden","true");return this},onAdd:function(a){this._anonymousBar=a=G.easyBar([this],{position:this.options.position,goomapClasses:this.options.goomapClasses});this._container=a.container;return this._anonymousBar.container},removeFrom:function(a){this._map===a&&this.remove();return this}});G.easyButton=function(){var a=Array.prototype.concat.apply([G.Control.EasyButton],arguments);return new (Function.prototype.bind.apply(G.Control.EasyButton,a))}})();/*

*/
G.Path.include({_transform:function(a){this._renderer&&(a?this._renderer.transformPath(this,a):(this._renderer._resetTransformPath(this),this._update()));return this},_onMouseClick:function(a){this.dragging&&this.dragging.moved()||this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(a)}});var END={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"};
function distance(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)}
G.Handler.PathDrag=G.Handler.extend({statics:{DRAGGING_CLS:"goomap-path-draggable"},initialize:function(a){this._path=a;this._dragStartPoint=this._startPoint=this._matrix=null;this._mapDraggingWasEnabled=!1},addHooks:function(){this._path.on("mousedown",this._onDragStart,this);this._path.options.className=this._path.options.className?this._path.options.className+" "+G.Handler.PathDrag.DRAGGING_CLS:G.Handler.PathDrag.DRAGGING_CLS;this._path._path&&G.DomUtil.addClass(this._path._path,G.Handler.PathDrag.DRAGGING_CLS)},
removeHooks:function(){this._path.off("mousedown",this._onDragStart,this);this._path.options.className=this._path.options.className.replace(new RegExp("\\s+"+G.Handler.PathDrag.DRAGGING_CLS),"");this._path._path&&G.DomUtil.removeClass(this._path._path,G.Handler.PathDrag.DRAGGING_CLS)},moved:function(){return this._path._dragMoved},_onDragStart:function(a){var b=a.originalEvent._simulated?"touchstart":a.originalEvent.type;this._mapDraggingWasEnabled=!1;this._startPoint=a.containerPoint.clone();this._dragStartPoint=
a.containerPoint.clone();this._matrix=[1,0,0,1,0,0];G.DomEvent.stop(a.originalEvent);G.DomUtil.addClass(this._path._renderer._container,"goomap-interactive");G.DomEvent.on(document,MOVE[b],this._onDrag,this).on(document,END[b],this._onDragEnd,this);this._path._map.dragging.enabled()&&(this._path._map.dragging.disable(),this._mapDraggingWasEnabled=!0);this._path._dragMoved=!1;this._path._popup&&this._path._popup._close();this._replaceCoordGetters(a)},_onDrag:function(a){G.DomEvent.stop(a);var b=this._path._map.mouseEventToContainerPoint(a.touches&&
1<=a.touches.length?a.touches[0]:a);if("touchmove"!==a.type||this._path._dragMoved||!(this._dragStartPoint.distanceTo(b)<=this._path._map.options.tapTolerance)){var c=b.x,b=b.y,d=c-this._startPoint.x,e=b-this._startPoint.y;if(d||e)this._path._dragMoved||(this._path._dragMoved=!0,this._path.fire("dragstart",a),this._path.bringToFront()),this._matrix[4]+=d,this._matrix[5]+=e,this._startPoint.x=c,this._startPoint.y=b,this._path.fire("predrag",a),this._path._transform(this._matrix),this._path.fire("drag",
a)}},_onDragEnd:function(a){var b=this._path._map.mouseEventToContainerPoint(a),c=this.moved();c&&(this._transformPoints(this._matrix),this._path._updatePath(),this._path._project(),this._path._transform(null),G.DomEvent.stop(a));G.DomEvent.off(document,"mousemove touchmove",this._onDrag,this);G.DomEvent.off(document,"mouseup touchend",this._onDragEnd,this);this._restoreCoordGetters();if(c){this._path.fire("dragend",{distance:distance(this._dragStartPoint,b)});var d=this._path._containsPoint;this._path._containsPoint=
G.Util.falseFn;G.Util.requestAnimFrame(function(){G.DomEvent.skipped({type:"click"});this._path._containsPoint=d},this)}this._dragStartPoint=this._startPoint=this._matrix=null;this._path._dragMoved=!1;this._mapDraggingWasEnabled&&(c&&G.DomEvent.fakeStop({type:"click"}),this._path._map.dragging.enable())},_transformPoints:function(a,b){var c=this._path,d,e,g,h=G.point(a[4],a[5]),k=c._map.options.crs;d=k.transformation;e=k.scale(c._map.getZoom());var k=k.projection,m=d.untransform(h,e).subtract(d.untransform(G.point(0,
0),e)),l=!b;c._bounds=new G.LatLngBounds;if(c._point)b=k.unproject(k.project(c._latlng)._add(m)),l&&(c._latlng=b,c._point._add(h));else if(c._rings||c._parts){var p=c._rings||c._parts,q=c._latlngs;b=b||q;G.Util.isArray(q[0])||(q=[q],b=[b]);d=0;for(e=p.length;d<e;d++){b[d]=b[d]||[];for(var r=0,u=p[d].length;r<u;r++)g=q[d][r],b[d][r]=k.unproject(k.project(g)._add(m)),l&&(c._bounds.extend(q[d][r]),p[d][r]._add(h))}}return b},_replaceCoordGetters:function(){this._path.getLatLng?(this._path.getLatLng_=
this._path.getLatLng,this._path.getLatLng=G.Util.bind(function(){return this.dragging._transformPoints(this.dragging._matrix,{})},this._path)):this._path.getLatLngs&&(this._path.getLatLngs_=this._path.getLatLngs,this._path.getLatLngs=G.Util.bind(function(){return this.dragging._transformPoints(this.dragging._matrix,[])},this._path))},_restoreCoordGetters:function(){this._path.getLatLng_?(this._path.getLatLng=this._path.getLatLng_,delete this._path.getLatLng_):this._path.getLatLngs_&&(this._path.getLatLngs=
this._path.getLatLngs_,delete this._path.getLatLngs_)}});G.Handler.PathDrag.makeDraggable=function(a){a.dragging=new G.Handler.PathDrag(a);return a};G.Path.prototype.makeDraggable=function(){return G.Handler.PathDrag.makeDraggable(this)};G.Path.addInitHook(function(){this.options.draggable?(this.options.interactive=!0,this.dragging||G.Handler.PathDrag.makeDraggable(this),this.dragging.enable()):this.dragging&&this.dragging.disable()});
G.SVG.include({_resetTransformPath:function(a){a._path.setAttributeNS(null,"transform","")},transformPath:function(a,b){a._path.setAttributeNS(null,"transform","matrix("+b.join(" ")+")")}});
G.SVG.include(G.Browser.vml?{_resetTransformPath:function(a){a._skew&&(a._skew.on=!1,a._path.removeChild(a._skew),a._skew=null)},transformPath:function(a,b){var c=a._skew;c||(c=G.SVG.create("skew"),a._path.appendChild(c),c.style.behavior="url(#default#VML)",a._skew=c);var d=b[0].toFixed(8)+" "+b[1].toFixed(8)+" "+b[2].toFixed(8)+" "+b[3].toFixed(8)+" 0 0",e=Math.floor(b[4]).toFixed()+", "+Math.floor(b[5]).toFixed()+"",g=this._path.style,h=parseFloat(g.left),k=parseFloat(g.top),m=parseFloat(g.width),
g=parseFloat(g.height);isNaN(h)&&(h=0);isNaN(k)&&(k=0);if(isNaN(m)||!m)m=1;if(isNaN(g)||!g)g=1;h=(-h/m-.5).toFixed(8)+" "+(-k/g-.5).toFixed(8);c.on="f";c.matrix=d;c.origin=h;c.offset=e;c.on=!0}}:{});function TRUE_FN(){return!0}
G.Canvas.include({_resetTransformPath:function(a){this._containerCopy&&(delete this._containerCopy,a._containsPoint_&&(a._containsPoint=a._containsPoint_,delete a._containsPoint_,this._requestRedraw(a)))},transformPath:function(a,b){var c=this._containerCopy,d=this._ctx,e,g=G.Browser.retina?2:1,h=this._bounds,k=h.getSize(),m=h.min;c||(c=this._containerCopy=document.createElement("canvas"),e=c.getContext("2d"),c.width=g*k.x,c.height=g*k.y,this._removePath(a),this._redraw(),e.translate(g*h.min.x,g*
h.min.y),e.drawImage(this._container,0,0),this._initPath(a),a._containsPoint_=a._containsPoint,a._containsPoint=TRUE_FN);d.save();d.clearRect(m.x,m.y,k.x*g,k.y*g);d.setTransform(1,0,0,1,0,0);d.restore();d.save();d.drawImage(this._containerCopy,0,0,k.x,k.y);d.transform.apply(d,b);this._drawing=!0;a._updatePath();this._drawing=!1;d.restore()}});(function(a,b){"object"===typeof exports&&"undefined"!==typeof module?b(require("goomap")):"function"===typeof define&&define.amd?define(["goomap"],b):b(a.G)})(this,function(a){function b(a){if("string"===typeof a&&-1!==a.indexOf("%"))return{value:parseFloat(a)/100,isInPixels:!1};a=a?parseFloat(a):0;return{value:a,isInPixels:0<a}}function c(a){return a.reduce(function(a,b,c,d){var e;if(e=0<c)e=d[c-1],e=!(b.x===e.x&&b.y===e.y);if(e){c=d[c-1];d=0<a.length?a[a.length-1].distB:0;e=b.x-c.x;var h=b.y-c.y;
a.push({a:c,b:b,distA:d,distB:d+Math.sqrt(e*e+h*h),heading:(180*Math.atan2(b.y-c.y,b.x-c.x)/Math.PI+450)%360})}return a},[])}function d(a,b){var d=c(a),h=d.length;if(0===h)return[];var g=d[h-1].distB,k=e(b.offset,g),r=e(b.endOffset,g),u=e(b.repeat,g),u=g*u,r=0<r?g*r:0,D=[],k=0<k?g*k:0;do D.push(k),k+=u;while(0<u&&k<g-r);var ea=0,I=d[0];return D.map(function(a){for(;a>I.distB&&ea<h-1;)ea++,I=d[ea];a=(a-I.distA)/(I.distB-I.distA);var b=I.a,c=I.b;a=c.x!==b.x?{x:b.x+a*(c.x-b.x),y:b.y+a*(c.y-b.y)}:{x:b.x,
y:b.y+(c.y-b.y)*a};return{pt:a,heading:I.heading}})}a=a&&a.hasOwnProperty("default")?a["default"]:a;var e=function(a,b){var c=a.value;return a.isInPixels?c/b:c};(function(){var b=a.Marker.prototype._initIcon,c=a.Marker.prototype._setPos,d="msTransform"===a.DomUtil.TRANSFORM;a.Marker.addInitHook(function(){var a=this.options.icon&&this.options.icon.options&&this.options.icon.options.iconAnchor;a&&(a=a[0]+"px "+a[1]+"px");this.options.rotationOrigin=this.options.rotationOrigin||a||"center bottom";this.options.rotationAngle=
this.options.rotationAngle||0;this.on("drag",function(a){a.target._applyRotation()})});a.Marker.include({_initIcon:function(){b.call(this)},_setPos:function(a){c.call(this,a);this._applyRotation()},_applyRotation:function(){this.options.rotationAngle&&(this._icon.style[a.DomUtil.TRANSFORM+"Origin"]=this.options.rotationOrigin,this._icon.style[a.DomUtil.TRANSFORM]=d?"rotate("+this.options.rotationAngle+"deg)":this._icon.style[a.DomUtil.TRANSFORM]+(" rotateZ("+this.options.rotationAngle+"deg)"))},setRotationAngle:function(a){this.options.rotationAngle=
a;this.update();return this},setRotationOrigin:function(a){this.options.rotationOrigin=a;this.update();return this}})})();a.Symbol=a.Symbol||{};a.Symbol.Dash=a.Class.extend({options:{pixelSize:10,pathOptions:{}},initialize:function(b){a.Util.setOptions(this,b);this.options.pathOptions.clickable=!1},buildSymbol:function(b,c,d,e,g){c=this.options;g=Math.PI/180;if(1>=c.pixelSize)return a.polyline([b.latLng,b.latLng],c.pathOptions);e=d.project(b.latLng);b=-(b.heading-90)*g;b=a.point(e.x+c.pixelSize*Math.cos(b+
Math.PI)/2,e.y+c.pixelSize*Math.sin(b)/2);e=e.add(e.subtract(b));return a.polyline([d.unproject(b),d.unproject(e)],c.pathOptions)}});a.Symbol.dash=function(b){return new a.Symbol.Dash(b)};a.Symbol.ArrowHead=a.Class.extend({options:{polygon:!0,pixelSize:10,headAngle:60,pathOptions:{stroke:!1,weight:2}},initialize:function(b){a.Util.setOptions(this,b);this.options.pathOptions.clickable=!1},buildSymbol:function(b,c,d,e,g){return this.options.polygon?a.polygon(this._buildArrowPath(b,d),this.options.pathOptions):
a.polyline(this._buildArrowPath(b,d),this.options.pathOptions)},_buildArrowPath:function(b,c){var d=Math.PI/180,e=c.project(b.latLng),g=-(b.heading-90)*d,h=this.options.headAngle/2*d,d=g+h,g=g-h,d=a.point(e.x-this.options.pixelSize*Math.cos(d),e.y+this.options.pixelSize*Math.sin(d)),e=a.point(e.x-this.options.pixelSize*Math.cos(g),e.y+this.options.pixelSize*Math.sin(g));return[c.unproject(d),b.latLng,c.unproject(e)]}});a.Symbol.arrowHead=function(b){return new a.Symbol.ArrowHead(b)};a.Symbol.Marker=
a.Class.extend({options:{markerOptions:{},rotate:!1},initialize:function(b){a.Util.setOptions(this,b);this.options.markerOptions.clickable=!1;this.options.markerOptions.draggable=!1},buildSymbol:function(b,c,d,e,g){this.options.rotate&&(this.options.markerOptions.rotationAngle=b.heading+(this.options.angleCorrection||0));return a.marker(b.latLng,this.options.markerOptions)}});a.Symbol.marker=function(b){return new a.Symbol.Marker(b)};var g=function(b){var c;if(c=Array.isArray(b))b=b[0],c=b instanceof
a.LatLng||Array.isArray(b)&&2===b.length&&"number"===typeof b[0];return c};a.PolylineDecorator=a.FeatureGroup.extend({options:{patterns:[]},initialize:function(b,c){a.FeatureGroup.prototype.initialize.call(this);a.Util.setOptions(this,c);this._map=null;this._paths=this._initPaths(b);this._bounds=this._initBounds();this._patterns=this._initPatterns(this.options.patterns)},_initPaths:function(b,c){var d=this;return g(b)?[c?b.concat([b[0]]):b]:b instanceof a.Polyline?this._initPaths(b.getLatLngs(),b instanceof
a.Polygon):Array.isArray(b)?b.reduce(function(a,b){return a.concat(d._initPaths(b,c))},[]):[]},_initPatterns:function(a){return a.map(this._parsePatternDef)},setPatterns:function(a){this.options.patterns=a;this._patterns=this._initPatterns(this.options.patterns);this.redraw()},setPaths:function(a){this._paths=this._initPaths(a);this._bounds=this._initBounds();this.redraw()},_parsePatternDef:function(a,c){return{symbolFactory:a.symbol,offset:b(a.offset),endOffset:b(a.endOffset),repeat:b(a.repeat)}},
onAdd:function(a){this._map=a;this._draw();this._map.on("moveend",this.redraw,this)},onRemove:function(b){this._map.off("moveend",this.redraw,this);this._map=null;a.FeatureGroup.prototype.onRemove.call(this,b)},_initBounds:function(){var b=this._paths.reduce(function(a,b){return a.concat(b)},[]);return a.latLngBounds(b)},getBounds:function(){return this._bounds},_buildSymbols:function(a,b,c){var d=this;return c.map(function(e,g){return b.buildSymbol(e,a,d._map,g,c.length)})},_getDirectionPoints:function(b,
c){var e=this;if(2>b.length)return[];var g=b.map(function(a){return e._map.project(a)});return d(g,c).map(function(b){return{latLng:e._map.unproject(a.point(b.pt)),heading:b.heading}})},redraw:function(){this._map&&(this.clearLayers(),this._draw())},_getPatternLayers:function(b){var c=this,d=this._map.getBounds().pad(.1);return this._paths.map(function(e){var g=c._getDirectionPoints(e,b).filter(function(a){return d.contains(a.latLng)});return a.featureGroup(c._buildSymbols(e,b.symbolFactory,g))})},
_draw:function(){var b=this;this._patterns.map(function(a){return b._getPatternLayers(a)}).forEach(function(c){b.addLayer(a.featureGroup(c))})}});a.polylineDecorator=function(b,c){return new a.PolylineDecorator(b,c)}});(function(){function a(b,c){if(!(this instanceof a))return new a(b,c);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));c&&this._initFormat(c);this.clear()}function b(a,b){a.bbox=c(a,0,a.children.length,b)}function c(a,b,c,e){for(var g=[Infinity,Infinity,-Infinity,-Infinity],h;b<c;b++)h=a.children[b],d(g,a.leaf?e(h):h.bbox);return g}function d(a,b){a[0]=Math.min(a[0],b[0]);a[1]=Math.min(a[1],b[1]);a[2]=Math.max(a[2],b[2]);a[3]=Math.max(a[3],b[3]);return a}
function e(a,b){return a.bbox[0]-b.bbox[0]}function g(a,b){return a.bbox[1]-b.bbox[1]}function h(a){return(a[2]-a[0])*(a[3]-a[1])}function k(a){return a[2]-a[0]+(a[3]-a[1])}function m(a,b){return a[0]<=b[0]&&a[1]<=b[1]&&b[2]<=a[2]&&b[3]<=a[3]}function l(a,b){return b[0]<=a[2]&&b[1]<=a[3]&&b[2]>=a[0]&&b[3]>=a[1]}function p(a,b,c,d,e){for(var g=[b,c],h;g.length;)c=g.pop(),b=g.pop(),c-b<=d||(h=b+Math.ceil((c-b)/d/2)*d,q(a,b,c,h,e),g.push(b,h,h,c))}function q(a,b,c,d,e){for(var g,h,k,l,m;c>b;){600<c-
b&&(g=c-b+1,h=d-b+1,k=Math.log(g),l=.5*Math.exp(2*k/3),m=.5*Math.sqrt(k*l*(g-l)/g)*(0>h-g/2?-1:1),k=Math.max(b,Math.floor(d-h*l/g+m)),h=Math.min(c,Math.floor(d+(g-h)*l/g+m)),q(a,k,h,d,e));g=a[d];h=b;l=c;r(a,b,d);for(0<e(a[c],g)&&r(a,b,c);h<l;){r(a,h,l);h++;for(l--;0>e(a[h],g);)h++;for(;0<e(a[l],g);)l--}0===e(a[b],g)?r(a,b,l):(l++,r(a,l,c));l<=d&&(b=l+1);d<=l&&(c=l-1)}}function r(a,b,c){var d=a[b];a[b]=a[c];a[c]=d}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=
this.data,c=[],d=this.toBBox;if(!l(a,b.bbox))return c;for(var e=[],g,h,k,p;b;){g=0;for(h=b.children.length;g<h;g++)k=b.children[g],p=b.leaf?d(k):k.bbox,l(a,p)&&(b.leaf?c.push(k):m(a,p)?this._all(k,c):e.push(k));b=e.pop()}return c},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,c=a.length;b<c;b++)this.insert(a[b]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<
a.height&&(b=this.data,this.data=a,a=b),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},clear:function(){this.data={children:[],height:1,bbox:[Infinity,Infinity,-Infinity,-Infinity],leaf:!0};return this},remove:function(a){if(!a)return this;for(var b=this.data,c=this.toBBox(a),d=[],e=[],g,h,k,l;b||d.length;){b||(b=d.pop(),h=d[d.length-1],g=e.pop(),l=!0);if(b.leaf&&(k=b.children.indexOf(a),-1!==k)){b.children.splice(k,
1);d.push(b);this._condense(d);break}l||b.leaf||!m(b.bbox,c)?h?(g++,b=h.children[g],l=!1):b=null:(d.push(b),e.push(g),g=0,h=b,b=b.children[0])}return this},toBBox:function(a){return a},compareMinX:function(a,b){return a[0]-b[0]},compareMinY:function(a,b){return a[1]-b[1]},toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,b){for(var c=[];a;)a.leaf?b.push.apply(b,a.children):c.push.apply(c,a.children),a=c.pop();return b},_build:function(a,c,d,e){var g=
d-c+1,h=this._maxEntries,k;if(g<=h)return k={children:a.slice(c,d+1),height:1,bbox:null,leaf:!0},b(k,this.toBBox),k;e||(e=Math.ceil(Math.log(g)/Math.log(h)),h=Math.ceil(g/Math.pow(h,e-1)));k={children:[],height:e,bbox:null};var g=Math.ceil(g/h),h=g*Math.ceil(Math.sqrt(h)),l,m,q;for(p(a,c,d,h,this.compareMinX);c<=d;c+=h)for(m=Math.min(c+h-1,d),p(a,c,m,g,this.compareMinY),l=c;l<=m;l+=g)q=Math.min(l+g-1,m),k.children.push(this._build(a,l,q,e-1));b(k,this.toBBox);return k},_chooseSubtree:function(a,b,
c,d){for(var e,g,k,l,m,p,q,u;;){d.push(b);if(b.leaf||d.length-1===c)break;q=u=Infinity;e=0;for(g=b.children.length;e<g;e++)k=b.children[e],m=h(k.bbox),p=k.bbox,p=(Math.max(p[2],a[2])-Math.min(p[0],a[0]))*(Math.max(p[3],a[3])-Math.min(p[1],a[1]))-m,p<u?(u=p,q=m<q?m:q,l=k):p===u&&m<q&&(q=m,l=k);b=l}return b},_insert:function(a,b,c){var e=this.toBBox;c=c?a.bbox:e(a);var e=[],g=this._chooseSubtree(c,this.data,b,e);g.children.push(a);for(d(g.bbox,c);0<=b;)if(e[b].children.length>this._maxEntries)this._split(e,
b),b--;else break;this._adjustParentBBoxes(c,e,b)},_split:function(a,c){var d=a[c],e=d.children.length,g=this._minEntries;this._chooseSplitAxis(d,g,e);e={children:d.children.splice(this._chooseSplitIndex(d,g,e)),height:d.height};d.leaf&&(e.leaf=!0);b(d,this.toBBox);b(e,this.toBBox);c?a[c-1].children.push(e):this._splitRoot(d,e)},_splitRoot:function(a,c){this.data={children:[a,c],height:a.height+1};b(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,d){var e,g,k,l,m,p,q;m=p=Infinity;for(e=b;e<=
d-b;e++)g=c(a,0,e,this.toBBox),k=c(a,e,d,this.toBBox),l=Math.max(0,Math.min(g[2],k[2])-Math.max(g[0],k[0]))*Math.max(0,Math.min(g[3],k[3])-Math.max(g[1],k[1])),g=h(g)+h(k),l<m?(m=l,q=e,p=g<p?g:p):l===m&&g<p&&(p=g,q=e);return q},_chooseSplitAxis:function(a,b,c){var d=a.leaf?this.compareMinX:e,h=a.leaf?this.compareMinY:g,k=this._allDistMargin(a,b,c,d);b=this._allDistMargin(a,b,c,h);k<b&&a.children.sort(d)},_allDistMargin:function(a,b,e,g){a.children.sort(g);g=this.toBBox;var h=c(a,0,b,g),l=c(a,e-b,
e,g),m=k(h)+k(l),p,q;for(p=b;p<e-b;p++)q=a.children[p],d(h,a.leaf?g(q):q.bbox),m+=k(h);for(p=e-b-1;p>=b;p--)q=a.children[p],d(l,a.leaf?g(q):q.bbox),m+=k(l);return m},_adjustParentBBoxes:function(a,b,c){for(;0<=c;c--)d(b[c].bbox,a)},_condense:function(a){for(var c=a.length-1,d;0<=c;c--)0===a[c].children.length?0<c?(d=a[c-1].children,d.splice(d.indexOf(a[c]),1)):this.clear():b(a[c],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));
this.compareMinY=new Function("a","b",b.join(a[1]));this.toBBox=new Function("a","return [a"+a.join(", a")+"];")}};"function"===typeof define&&define.amd?define("rbush",function(){return a}):"undefined"!==typeof module?module.exports=a:"undefined"!==typeof self?self.rbush=a:window.rbush=a})();var isMSIE8=!("getComputedStyle"in window&&"function"===typeof window.getComputedStyle);
function extensions(a){return{initialize:function(b){a.prototype.initialize.call(this,b);this._originalLayers=[];this._visibleLayers=[];this._staticLayers=[];this._rbush=[];this._cachedRelativeBoxes=[];this._margin=b.margin||0;this._rbush=null},addLayer:function(b){"options"in b&&"icon"in b.options?(this._originalLayers.push(b),this._map&&this._maybeAddLayerToRBush(b)):(this._staticLayers.push(b),a.prototype.addLayer.call(this,b))},removeLayer:function(b){this._rbush.remove(this._cachedRelativeBoxes[b._leaflet_id]);
delete this._cachedRelativeBoxes[b._leaflet_id];a.prototype.removeLayer.call(this,b);var c;c=this._originalLayers.indexOf(b);-1!==c&&this._originalLayers.splice(c,1);c=this._visibleLayers.indexOf(b);-1!==c&&this._visibleLayers.splice(c,1);c=this._staticLayers.indexOf(b);-1!==c&&this._staticLayers.splice(c,1)},clearLayers:function(){this._rbush=rbush();this._originalLayers=[];this._visibleLayers=[];this._staticLayers=[];this._cachedRelativeBoxes=[];a.prototype.clearLayers.call(this)},onAdd:function(a){this._map=
a;for(var b in this._staticLayers)a.addLayer(this._staticLayers[b]);this._onZoomEnd();a.on("zoomend",this._onZoomEnd,this)},onRemove:function(b){for(var c in this._staticLayers)b.removeLayer(this._staticLayers[c]);b.off("zoomend",this._onZoomEnd,this);a.prototype.onRemove.call(this,b)},_maybeAddLayerToRBush:function(b){this._map.getZoom();var c=this._rbush,d=this._cachedRelativeBoxes[b._leaflet_id],e=!1;if(!d){a.prototype.addLayer.call(this,b);var e=!0,g=this._getIconBox(b._icon),d=this._getRelativeBoxes(b._icon.children,
g);d.push(g);this._cachedRelativeBoxes[b._leaflet_id]=d}for(var d=this._positionBoxes(this._map.latLngToLayerPoint(b.getLatLng()),d),g=!1,h=0;h<d.length&&!g;h++)g=0<c.search(d[h]).length;g?a.prototype.removeLayer.call(this,b):(e||a.prototype.addLayer.call(this,b),this._visibleLayers.push(b),c.load(d))},_getIconBox:function(a){if(isMSIE8)return[0,0,a.offsetWidth,a.offsetHeight];a=window.getComputedStyle(a);return[parseInt(a.marginLeft),parseInt(a.marginTop),parseInt(a.marginLeft)+parseInt(a.width),
parseInt(a.marginTop)+parseInt(a.height)]},_getRelativeBoxes:function(a,c){for(var b=[],e=0;e<a.length;e++){var g=a[e],h=[g.offsetLeft,g.offsetTop,g.offsetLeft+g.offsetWidth,g.offsetTop+g.offsetHeight],h=this._offsetBoxes(h,c);b.push(h);if(g.children.length){var k=c;if(!isMSIE8){var m=window.getComputedStyle(g).position;if("absolute"===m||"relative"===m)k=h}b=b.concat(this._getRelativeBoxes(g.children,k))}}return b},_offsetBoxes:function(a,c){return[a[0]+c[0],a[1]+c[1],a[2]+c[0],a[3]+c[1]]},_positionBoxes:function(a,
c){for(var b=[],e=0;e<c.length;e++)b.push(this._positionBox(a,c[e]));return b},_positionBox:function(a,c){return[c[0]+a.x-this._margin,c[1]+a.y-this._margin,c[2]+a.x+this._margin,c[3]+a.y+this._margin]},_onZoomEnd:function(){for(var b=0;b<this._visibleLayers.length;b++)a.prototype.removeLayer.call(this,this._visibleLayers[b]);this._rbush=rbush();for(b=0;b<this._originalLayers.length;b++)this._maybeAddLayerToRBush(this._originalLayers[b])}}}G.LayerGroup.Collision=G.LayerGroup.extend(extensions(G.LayerGroup));
G.FeatureGroup.Collision=G.FeatureGroup.extend(extensions(G.FeatureGroup));G.GeoJSON.Collision=G.GeoJSON.extend(extensions(G.GeoJSON));G.LayerGroup.collision=function(a){return new G.LayerGroup.Collision(a||{})};G.FeatureGroup.collision=function(a){return new G.FeatureGroup.Collision(a||{})};G.GeoJSON.collision=function(a){return new G.GeoJSON.Collision(a||{})};G.layerGroup.collision=function(a){return new G.LayerGroup.Collision(a||{})};
G.featureGroup.collision=function(a){return new G.FeatureGroup.Collision(a||{})};G.geoJson.collision=function(a){return new G.GeoJSON.Collision(a||{})};(function(a,b,c){G.Control.Custom=G.Control.extend({version:"1.0.0",options:{position:"topright",id:"",title:"",classes:"",content:"",style:{},datas:{},events:{}},container:null,onAdd:function(a){this.container=G.DomUtil.create("div");this.container.id=this.options.id;this.container.title=this.options.title;this.container.className=this.options.classes;this.container.innerHTML=this.options.content;for(var b in this.options.style)this.container.style[b]=this.options.style[b];for(var c in this.options.datas)this.container.dataset[c]=
this.options.datas[c];G.DomEvent.disableClickPropagation(this.container);G.DomEvent.on(this.container,"contextmenu",function(a){G.DomEvent.stopPropagation(a)});G.DomEvent.disableScrollPropagation(this.container);for(var d in this.options.events)G.DomEvent.on(this.container,d,this.options.events[d],this.container);return this.container},onRemove:function(a){for(var b in this.options.events)G.DomEvent.off(this.container,b,this.options.events[b],this.container)}});G.control.custom=function(a){return new G.Control.Custom(a)}})(window,
document);G.Control.Sidebar=G.Control.extend({includes:G.Evented.prototype||G.Mixin.Events,options:{position:"left"},initialize:function(a,b){var c,d;G.setOptions(this,b);this._sidebar=G.DomUtil.get(a);G.DomUtil.addClass(this._sidebar,"sidebar-"+this.options.position);G.Browser.touch&&G.DomUtil.addClass(this._sidebar,"goomap-touch");for(c=this._sidebar.children.length-1;0<=c;c--)d=this._sidebar.children[c],"DIV"==d.tagName&&G.DomUtil.hasClass(d,"sidebar-content")&&(this._container=d);this._tabitems=this._sidebar.querySelectorAll("ul.sidebar-tabs > li, .sidebar-tabs > ul > li");
for(c=this._tabitems.length-1;0<=c;c--)this._tabitems[c]._sidebar=this;this._panes=[];this._closeButtons=[];for(c=this._container.children.length-1;0<=c;c--)if(d=this._container.children[c],"DIV"==d.tagName&&G.DomUtil.hasClass(d,"sidebar-pane")){this._panes.push(d);d=d.querySelectorAll(".sidebar-close");for(var e=0,g=d.length;e<g;e++)this._closeButtons.push(d[e])}},addTo:function(a){var b;this._map=a;for(a=this._tabitems.length-1;0<=a;a--){b=this._tabitems[a];var c=b.querySelector("a");if(c.hasAttribute("href")&&
"#"==c.getAttribute("href").slice(0,1))G.DomEvent.on(c,"click",G.DomEvent.preventDefault).on(c,"click",this._onClick,b)}for(a=this._closeButtons.length-1;0<=a;a--)b=this._closeButtons[a],G.DomEvent.on(b,"click",this._onCloseClick,this);return this},removeFrom:function(a){console.log("removeFrom() has been deprecated, please use remove() instead as support for this function will be ending soon.");this.remove(a)},remove:function(a){var b;this._map=null;for(a=this._tabitems.length-1;0<=a;a--)b=this._tabitems[a],
G.DomEvent.off(b.querySelector("a"),"click",this._onClick);for(a=this._closeButtons.length-1;0<=a;a--)b=this._closeButtons[a],G.DomEvent.off(b,"click",this._onCloseClick,this);return this},open:function(a){var b,c;for(b=this._panes.length-1;0<=b;b--)c=this._panes[b],c.id==a?G.DomUtil.addClass(c,"active"):G.DomUtil.hasClass(c,"active")&&G.DomUtil.removeClass(c,"active");for(b=this._tabitems.length-1;0<=b;b--)c=this._tabitems[b],c.querySelector("a").hash=="#"+a?G.DomUtil.addClass(c,"active"):G.DomUtil.hasClass(c,
"active")&&G.DomUtil.removeClass(c,"active");this.fire("content",{id:a});G.DomUtil.hasClass(this._sidebar,"collapsed")&&(this.fire("opening"),G.DomUtil.removeClass(this._sidebar,"collapsed"));return this},close:function(){for(var a=this._tabitems.length-1;0<=a;a--){var b=this._tabitems[a];G.DomUtil.hasClass(b,"active")&&G.DomUtil.removeClass(b,"active")}G.DomUtil.hasClass(this._sidebar,"collapsed")||(this.fire("closing"),G.DomUtil.addClass(this._sidebar,"collapsed"));return this},_onClick:function(){G.DomUtil.hasClass(this,
"active")?this._sidebar.close():G.DomUtil.hasClass(this,"disabled")||this._sidebar.open(this.querySelector("a").hash.slice(1))},_onCloseClick:function(){this.close()}});G.control.sidebar=function(a,b){return new G.Control.Sidebar(a,b)};/*
 goomap.wms.js
 A collection of GooMap utilities for working with Web Mapping services.
 (c) 2014-2016, Houston Engineering, Inc.
 MIT License
*/
(function(a){if("function"===typeof define&&define.amd)define(["goomap"],a);else if("undefined"!==typeof module)module.exports=a(require("goomap"));else{if("undefined"===typeof this.G)throw"GooMap must be loaded first!";this.G.WMS=this.G.wms=a(this.G)}})(function(a){function b(a,b){var c=this,d=new XMLHttpRequest;d.onreadystatechange=function(){4===d.readyState&&(200===d.status?b.call(c,d.responseText):b.call(c,"error"))};d.open("GET",a);d.send()}var c={};"keys"in Object||(Object.keys=function(a){var b=
[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c);return b});c.Source=a.Layer.extend({options:{untiled:!0,identify:!0},initialize:function(b,c){a.setOptions(this,c);this.options.tiled&&(this.options.untiled=!1);this._url=b;this._subLayers={};this._overlay=this.createOverlay(this.options.untiled)},createOverlay:function(a){var b={},d;for(d in this.options)"untiled"!=d&&"identify"!=d&&(b[d]=this.options[d]);return a?c.overlay(this._url,b):c.tileLayer(this._url,b)},onAdd:function(){this.refreshOverlay()},
getEvents:function(){return this.options.identify?{click:this.identify}:{}},setOpacity:function(a){this.options.opacity=a;this._overlay&&this._overlay.setOpacity(a)},bringToBack:function(){this.options.isBack=!0;this._overlay&&this._overlay.bringToBack()},bringToFront:function(){this.options.isBack=!1;this._overlay&&this._overlay.bringToFront()},getLayer:function(a){return c.layer(this,a)},addSubLayer:function(a){this._subLayers[a]=!0;this.refreshOverlay()},removeSubLayer:function(a){delete this._subLayers[a];
this.refreshOverlay()},refreshOverlay:function(){var a=Object.keys(this._subLayers).join(",");this._map&&(a?(this._overlay.setParams({layers:a}),this._overlay.addTo(this._map)):this._overlay.remove())},identify:function(a){var b=this.getIdentifyLayers();b.length&&this.getFeatureInfo(a.containerPoint,a.latlng,b,this.showFeatureInfo)},getFeatureInfo:function(b,c,d,k){b=this.getFeatureInfoParams(b,d);var e=this._url+a.Util.getParamString(b,this._url);this.showWaiting();this.ajax(e,function(a){this.hideWaiting();
a=this.parseFeatureInfo(a,e);k.call(this,c,a)})},ajax:function(a,c){b.call(this,a,c)},getIdentifyLayers:function(){return this.options.identifyLayers?this.options.identifyLayers:Object.keys(this._subLayers)},getFeatureInfoParams:function(b,c){var d;this.options.untiled?d=this._overlay.wmsParams:(d=this.createOverlay(!0),d.updateWmsParams(this._map),d=d.wmsParams,d.layers=c.join(","));var e={request:"GetFeatureInfo",query_layers:c.join(","),X:Math.round(b.x),Y:Math.round(b.y)};return a.extend({},d,
e)},parseFeatureInfo:function(a,b){"error"==a&&(a="<iframe src='"+b+"' style='border:none'>");return a},showFeatureInfo:function(a,b){this._map&&this._map.openPopup(b,a)},showWaiting:function(){this._map&&(this._map._container.style.cursor="progress")},hideWaiting:function(){this._map&&(this._map._container.style.cursor="default")}});c.source=function(a,b){return new c.Source(a,b)};c.Layer=a.Layer.extend({initialize:function(b,d,h){a.setOptions(this,h);b.addSubLayer||(b=c.getSourceForUrl(b,h));this._source=
b;this._name=d},onAdd:function(){this._source._map||this._source.addTo(this._map);this._source.addSubLayer(this._name)},onRemove:function(){this._source.removeSubLayer(this._name)},setOpacity:function(a){this._source.setOpacity(a)},bringToBack:function(){this._source.bringToBack()},bringToFront:function(){this._source.bringToFront()}});c.layer=function(a,b){return new c.Layer(a,b)};var d={};c.getSourceForUrl=function(a,b){d[a]||(d[a]=c.source(a,b));return d[a]};c.TileLayer=a.TileLayer.WMS;c.tileLayer=
a.tileLayer.wms;c.Overlay=a.Layer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},options:{crs:null,uppercase:!1,attribution:"",opacity:1,isBack:!1,minZoom:0,maxZoom:18},initialize:function(b,c){this._url=b;var d={},e={},g;for(g in c)g in this.options?e[g]=c[g]:d[g]=c[g];a.setOptions(this,e);this.wmsParams=a.extend({},this.defaultWmsParams,d)},setParams:function(b){a.extend(this.wmsParams,b);this.update()},getAttribution:function(){return this.options.attribution},
onAdd:function(){this.update()},onRemove:function(a){this._currentOverlay&&(a.removeLayer(this._currentOverlay),delete this._currentOverlay);this._currentUrl&&delete this._currentUrl},getEvents:function(){return{moveend:this.update}},update:function(){if(this._map){this.updateWmsParams();var b=this.getImageUrl();if(this._currentUrl!=b){this._currentUrl=b;var c=this._map.getBounds(),d=a.imageOverlay(b,c,{opacity:0});d.addTo(this._map);d.once("load",function(){this._map&&(d._url!=this._currentUrl?this._map.removeLayer(d):
(this._currentOverlay&&this._map.removeLayer(this._currentOverlay),this._currentOverlay=d,d.setOpacity(this.options.opacity?this.options.opacity:1),!0===this.options.isBack&&d.bringToBack(),!1===this.options.isBack&&d.bringToFront()))},this);(this._map.getZoom()<this.options.minZoom||this._map.getZoom()>this.options.maxZoom)&&this._map.removeLayer(d)}}},setOpacity:function(a){this.options.opacity=a;this._currentOverlay&&this._currentOverlay.setOpacity(a)},bringToBack:function(){this.options.isBack=
!0;this._currentOverlay&&this._currentOverlay.bringToBack()},bringToFront:function(){this.options.isBack=!1;this._currentOverlay&&this._currentOverlay.bringToFront()},updateWmsParams:function(b,c){b||(b=this._map);var d=b.getBounds(),e=b.getSize(),g=parseFloat(this.wmsParams.version),l=this.options.crs||b.options.crs,p=1.3<=g?"crs":"srs",q=l.project(d.getNorthWest()),d=l.project(d.getSouthEast()),e={width:e.x,height:e.y};e[p]=l.code;e.bbox=(1.3<=g&&l===a.CRS.EPSG4326?[d.y,q.x,q.y,d.x]:[q.x,d.y,d.x,
q.y]).join(",");a.extend(this.wmsParams,e)},getImageUrl:function(){var b=a.Util.getParamString(this.wmsParams,this._url,this.options.uppercase||!1);return this._url+b}});c.overlay=function(a,b){return new c.Overlay(a,b)};return c});(function(a,b,c){"undefined"!==typeof module&&module.exports?module.exports=c():"function"===typeof define&&define.amd?define(c):b[a]=c()})("h337",this,function(){var a={defaultRadius:40,defaultRenderer:"canvas2d",defaultGradient:{"0.25":"rgb(0,0,255)","0.55":"rgb(0,255,0)","0.85":"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}},b=function(){var b=function(a){this._coordinator={};this._data=
[];this._radi=[];this._min=10;this._max=1;this._xField=a.xField||a.defaultXField;this._yField=a.yField||a.defaultYField;this._valueField=a.valueField||a.defaultValueField;a.radius&&(this._cfgRadius=a.radius)},c=a.defaultRadius;b.prototype={_organiseData:function(a,b){var d=a[this._xField],e=a[this._yField],g=this._radi,h=this._data,k=this._max,l=this._min,m=a[this._valueField]||1,P=a.radius||this._cfgRadius||c;h[d]||(h[d]=[],g[d]=[]);h[d][e]?h[d][e]+=m:(h[d][e]=m,g[d][e]=P);g=h[d][e];return g>k?(b?
this.setDataMax(g):this._max=g,!1):g<l?(b?this.setDataMin(g):this._min=g,!1):{x:d,y:e,value:m,radius:P,min:l,max:k}},_unOrganizeData:function(){var a=[],b=this._data,c=this._radi,d;for(d in b)for(var e in b[d])a.push({x:d,y:e,radius:c[d][e],value:b[d][e]});return{min:this._min,max:this._max,data:a}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(a){if(0<a.length)for(var b=a.length;b--;)this.addData.call(this,a[b]);else if(a=this._organiseData(a,
!0))0===this._data.length&&(this._min=this._max=a.value),this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[a]});return this},setData:function(a){var b=a.data,c=b.length;this._data=[];this._radi=[];for(var d=0;d<c;d++)this._organiseData(b[d],!1);this._max=a.max;this._min=a.min||0;this._onExtremaChange();this._coordinator.emit("renderall",this._getInternalData());return this},removeData:function(){},setDataMax:function(a){this._max=a;this._onExtremaChange();this._coordinator.emit("renderall",
this._getInternalData());return this},setDataMin:function(a){this._min=a;this._onExtremaChange();this._coordinator.emit("renderall",this._getInternalData());return this},setCoordinator:function(a){this._coordinator=a},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}};return b}(),c=function(){function a(a){var c=a.container,d=this.shadowCanvas=document.createElement("canvas"),e=this.canvas=a.canvas||document.createElement("canvas");
this._renderBoundaries=[1E4,1E4,0,0];var g=getComputedStyle(a.container)||{};e.className="heatmap-canvas";this._width=e.width=d.width=a.width||+g.width.replace(/px/,"");this._height=e.height=d.height=a.height||+g.height.replace(/px/,"");this.shadowCtx=d.getContext("2d");this.ctx=e.getContext("2d");e.style.cssText=d.style.cssText="position:absolute;left:0;top:0;";c.style.position="relative";c.appendChild(e);this._palette=b(a);this._templates={};this._setStyles(a)}var b=function(a){a=a.gradient||a.defaultGradient;
var b=document.createElement("canvas"),c=b.getContext("2d");b.width=256;b.height=1;var b=c.createLinearGradient(0,0,256,1),d;for(d in a)b.addColorStop(d,a[d]);c.fillStyle=b;c.fillRect(0,0,256,1);return c.getImageData(0,0,256,1).data},c=function(a){var b=[],c=a.min,d=a.max,e=a.radi;a=a.data;for(var g=Object.keys(a),h=g.length;h--;)for(var k=g[h],l=Object.keys(a[k]),m=l.length;m--;){var M=l[m];b.push({x:k,y:M,value:a[k][M],radius:e[k][M]})}return{min:c,max:d,data:b}};a.prototype={renderPartial:function(a){0<
a.data.length&&(this._drawAlpha(a),this._colorize())},renderAll:function(a){this._clear();0<a.data.length&&(this._drawAlpha(c(a)),this._colorize())},_updateGradient:function(a){this._palette=b(a)},updateConfig:function(a){a.gradient&&this._updateGradient(a);this._setStyles(a)},setDimensions:function(a,b){this._width=a;this._height=b;this.canvas.width=this.shadowCanvas.width=a;this.canvas.height=this.shadowCanvas.height=b},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height);this.ctx.clearRect(0,
0,this._width,this._height)},_setStyles:function(a){this._blur=0==a.blur?0:a.blur||a.defaultBlur;a.backgroundColor&&(this.canvas.style.backgroundColor=a.backgroundColor);this._width=this.canvas.width=this.shadowCanvas.width=a.width||this._width;this._height=this.canvas.height=this.shadowCanvas.height=a.height||this._height;this._opacity=255*(a.opacity||0);this._maxOpacity=255*(a.maxOpacity||a.defaultMaxOpacity);this._minOpacity=255*(a.minOpacity||a.defaultMinOpacity);this._useGradientOpacity=!!a.useGradientOpacity},
_drawAlpha:function(a){var b=this._min=a.min,c=this._max=a.max;a=a.data||[];for(var d=a.length,e=1-this._blur;d--;){var g=a[d],h=g.radius,k=Math.min(g.value,c),l=g.x-h,g=g.y-h,m=this.shadowCtx,M;if(this._templates[h])M=this._templates[h];else{M=this._templates;var v=h,w=h,C=e,O=document.createElement("canvas"),H=O.getContext("2d"),E=w,y=w;O.width=O.height=2*w;1==C?(H.beginPath(),H.arc(E,y,w,0,2*Math.PI,!1),H.fillStyle="rgba(0,0,0,1)",H.fill()):(C=H.createRadialGradient(E,y,w*C,E,y,w),C.addColorStop(0,
"rgba(0,0,0,1)"),C.addColorStop(1,"rgba(0,0,0,0)"),H.fillStyle=C,H.fillRect(0,0,2*w,2*w));M[v]=M=O}k=(k-b)/(c-b);m.globalAlpha=.01>k?.01:k;m.drawImage(M,l,g);l<this._renderBoundaries[0]&&(this._renderBoundaries[0]=l);g<this._renderBoundaries[1]&&(this._renderBoundaries[1]=g);l+2*h>this._renderBoundaries[2]&&(this._renderBoundaries[2]=l+2*h);g+2*h>this._renderBoundaries[3]&&(this._renderBoundaries[3]=g+2*h)}},_colorize:function(){var a=this._renderBoundaries[0],b=this._renderBoundaries[1],c=this._renderBoundaries[2]-
a,d=this._renderBoundaries[3]-b,e=this._width,g=this._height,h=this._opacity,k=this._maxOpacity,m=this._minOpacity,W=this._useGradientOpacity;0>a&&(a=0);0>b&&(b=0);a+c>e&&(c=e-a);b+d>g&&(d=g-b);for(var c=this.shadowCtx.getImageData(a,b,c,d),d=c.data,e=d.length,g=this._palette,M=3;M<e;M+=4){var v=d[M],w=4*v;w&&(v=0<h?h:v<k?v<m?m:v:k,d[M-3]=g[w],d[M-2]=g[w+1],d[M-1]=g[w+2],d[M]=W?g[w+3]:v)}c.data=d;this.ctx.putImageData(c,a,b);this._renderBoundaries=[1E3,1E3,0,0]},getValueAt:function(a){a=this.shadowCtx.getImageData(a.x,
a.y,1,1).data[3];return a/255*Math.abs(this._max-this._min)>>0},getDataURL:function(){return this.canvas.toDataURL()}};return a}(),d=function(){var b=!1;"canvas2d"===a.defaultRenderer&&(b=c);return b}(),e={merge:function(){for(var a={},b=arguments.length,c=0;c<b;c++){var d=arguments[c],e;for(e in d)a[e]=d[e]}return a}},g=function(){function c(c){c=this._config=e.merge(a,c||{});this._coordinator=new g;if(c.plugin){var h=c.plugin;if(a.plugins[h])h=a.plugins[h],this._renderer=new h.renderer(c),this._store=
new h.store(c);else throw Error("Plugin '"+h+"' not found. Maybe it was not registered.");}else this._renderer=new d(c),this._store=new b(c);m(this)}var g=function(){function a(){this.cStore={}}a.prototype={on:function(a,b,c){var d=this.cStore;d[a]||(d[a]=[]);d[a].push(function(a){return b.call(c,a)})},emit:function(a,b){var c=this.cStore;if(c[a])for(var d=c[a].length,e=0;e<d;e++)(0,c[a][e])(b)}};return a}(),m=function(a){var b=a._renderer,c=a._coordinator,d=a._store;c.on("renderpartial",b.renderPartial,
b);c.on("renderall",b.renderAll,b);c.on("extremachange",function(b){a._config.onExtremaChange&&a._config.onExtremaChange({min:b.min,max:b.max,gradient:a._config.gradient||a._config.defaultGradient})});d.setCoordinator(c)};c.prototype={addData:function(){this._store.addData.apply(this._store,arguments);return this},removeData:function(){this._store.removeData&&this._store.removeData.apply(this._store,arguments);return this},setData:function(){this._store.setData.apply(this._store,arguments);return this},
setDataMax:function(){this._store.setDataMax.apply(this._store,arguments);return this},setDataMin:function(){this._store.setDataMin.apply(this._store,arguments);return this},configure:function(a){this._config=e.merge(this._config,a);this._renderer.updateConfig(this._config);this._coordinator.emit("renderall",this._store._getInternalData());return this},repaint:function(){this._coordinator.emit("renderall",this._store._getInternalData());return this},getData:function(){return this._store.getData()},
getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(a){return this._store.getValueAt?this._store.getValueAt(a):this._renderer.getValueAt?this._renderer.getValueAt(a):null}};return c}();return{create:function(a){return new g(a)},register:function(b,c){a.plugins[b]=c}}});(function(a,b,c){if("undefined"!==typeof module&&module.exports)module.exports=c(require("goomap.heatmap.js"),require("goomap"));else if("function"===typeof define&&define.amd)define(["goomap.heatmap.js","goomap"],c);else{if("undefined"===typeof window.h337)throw Error("goomap.heatmap.js must be loaded before the goomap heatmap plugin");if("undefined"===typeof window.G)throw Error("Goomap must be loaded before the goomap heatmap plugin");b[a]=c(window.h337,window.G)}})("HeatmapOverlay",this,function(a,
b){"undefined"===typeof b.Layer&&(b.Layer=b.Class);var c=b.Layer.extend({initialize:function(a){this.cfg=a;this._el=b.DomUtil.create("div","goomap-zoom-hide");this._data=[];this._max=1;this._min=0;this.cfg.container=this._el},onAdd:function(c){var d=c.getSize();this._map=c;this._width=d.x;this._height=d.y;this._el.style.width=d.x+"px";this._el.style.height=d.y+"px";this._el.style.position="absolute";this._origin=this._map.layerPointToLatLng(new b.Point(0,0));c.getPanes().overlayPane.appendChild(this._el);
this._heatmap||(this._heatmap=a.create(this.cfg));c.on("moveend",this._reset,this);this._draw()},addTo:function(a){a.addLayer(this);return this},onRemove:function(a){a.getPanes().overlayPane.removeChild(this._el);a.off("moveend",this._reset,this)},_draw:function(){if(this._map){var a=this._map.getPanes().mapPane._goomap_pos;this._el.style[c.CSS_TRANSFORM]="translate("+-Math.round(a.x)+"px,"+-Math.round(a.y)+"px)";this._update()}},_update:function(){var a,b,c,h={max:this._max,min:this._min,data:[]};
a=this._map.getBounds();b=this._map.getZoom();c=Math.pow(2,b);if(0==this._data.length)this._heatmap&&this._heatmap.setData(h);else{b=[];c=this.cfg.scaleRadius?c:1;for(var k=0,m=0,l=this.cfg.valueField,p=this._data.length;p--;){var q=this._data[p],r=q[l],u=q.latlng;a.contains(u)&&(k=Math.max(r,k),m=Math.min(r,m),u=this._map.latLngToContainerPoint(u),u={x:Math.round(u.x),y:Math.round(u.y)},u[l]=r,u.radius=q.radius?q.radius*c:(this.cfg.radius||2)*c,b.push(u))}this.cfg.useLocalExtrema&&(h.max=k,h.min=
m);h.data=b;this._heatmap.setData(h)}},setData:function(a){this._max=a.max||this._max;this._min=a.min||this._min;var c=this.cfg.latField||"lat",d=this.cfg.lngField||"lng",h=this.cfg.valueField||"value";a=a.data;for(var k=a.length,m=[];k--;){var l=a[k],p={latlng:new b.LatLng(l[c],l[d])};p[h]=l[h];l.radius&&(p.radius=l.radius);m.push(p)}this._data=m;this._draw()},addData:function(a){if(0<a.length)for(var c=a.length;c--;)this.addData(a[c]);else{var c=this.cfg.valueField||"value",d={latlng:new b.LatLng(a[this.cfg.latField||
"lat"],a[this.cfg.lngField||"lng"])};d[c]=a[c];this._max=Math.max(this._max,d[c]);this._min=Math.min(this._min,d[c]);a.radius&&(d.radius=a.radius);this._data.push(d);this._draw()}},_reset:function(){this._origin=this._map.layerPointToLatLng(new b.Point(0,0));var a=this._map.getSize();if(this._width!==a.x||this._height!==a.y)this._width=a.x,this._height=a.y,this._el.style.width=this._width+"px",this._el.style.height=this._height+"px",this._heatmap._renderer.setDimensions(this._width,this._height);
this._draw()}});c.CSS_TRANSFORM=function(){for(var a=document.createElement("div"),b=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],c=0;c<b.length;c++){var h=b[c];if(void 0!==a.style[h])return h}return b[0]}();return c});G.AntPath=G.FeatureGroup.extend({main:null,pulse:null,_map:null,_path:null,_animatedPathId:null,_animatedPathClass:"goomap-ant-path",_reversePathClass:"goomap-ant-path__reverse",_hardwareAccClass:"hardware-acceleration",options:{paused:!1,reverse:!1,hardwareAcceleration:!1,renderer:G.svg(),delay:400,dashArray:[10,20],weight:5,opacity:.5,color:"#0000FF",pulseColor:"#FFFFFF"},initialize:function(a,b){G.FeatureGroup.prototype.initialize.call(this);G.Util.setOptions(this,b);this._map=null;this._path=
a;this._animatedPathId="ant-path-"+(new Date).getTime()},_processOptions:function(){var a=this.options,b=this._animatedPathClass,c=this._reversePathClass,d=this._hardwareAccClass,e=this._animatedPathId,g=a.reverse,h=a.hardwareAcceleration,k=G.extend([],a),m=G.extend([],a);m.color=m.pulseColor||a.pulseColor;m.className=[b,e,g?c:"",h?b+"__"+d:""].join(" ");delete k.dashArray;Array.isArray(m.dashArray)&&(m.dashArray=String(m.dashArray));return{pathOpts:k,pulseOpts:m}},_mount:function(){var a=this._processOptions(),
b=a.pulseOpts;this.addLayer(this.main=new G.Polyline(this._path,a.pathOpts));this.addLayer(this.pulse=new G.Polyline(this._path,b))},_calculateAnimationSpeed:function(){var a=this.options,b=this._map,c=this._animatedPathId;if(!a.paused&&b){var b=b.getZoom(),c=document.getElementsByClassName(c),d=1+a.delay/3/b+"s",e=["-webkit-","-moz-","-ms-","-o-",""].map(function(a){return a+"animation-duration: "+d}).join(";");Array.from(c,function(a){a.style.cssText=e;a.setAttribute("data-animated","true")})}},
_pureReverse:function(){var a=this.pulse.getElement();a&&(this.options.reverse?a.classList.remove(this._reversePathClass):a.classList.add(this._reversePathClass))},onAdd:function(a){this._map=a;this._map.on("zoomend",this._calculateAnimationSpeed,this);this._mount();this._calculateAnimationSpeed();return this},onRemove:function(a){this._map&&(this._map.off("zoomend",this._calculateAnimationSpeed,this),this._map=null);a&&a.removeLayer(this.main).removeLayer(this.pulse);return this},pause:function(){if(!this.options.paused){var a=
this.pulse.getElement();this.options.paused=!0;a&&(a.removeAttribute("style"),a.setAttribute("data-animated","true"));return!0}return!1},resume:function(){var a=this.options;return a.paused?(a.paused=!1,this._calculateAnimationSpeed(),!0):!1},bringToFront:function(){this.main.bringToFront();this.pulse.bringToFront();return this},bringToBack:function(){this.pulse.bringToBack();this.main.bringToBack();return this},removeFrom:function(a){a&&a.hasLayer(this)&&a.removeLayer(this);return this},setStyle:function(a){var b=
a.delay,c=a.reverse;a.paused?this.pause():this.resume();b!==this.options.delay&&(this.options.delay=b,this._calculateAnimationSpeed());"undefined"!==typeof c&&c!==this.options.reverse&&this._pureReverse();this.options=G.Util.setOptions(this.options,a);a=this._processOptions();b=a.pulseOpts;this.main.setStyle(a.pathOpts);this.pulse.setStyle(b);return this},reverse:function(){this._pureReverse();this.options.reverse=!this.options.reverse;return this},redraw:function(){this.main.redraw();this.pulse.redraw();
return this},addLatLng:function(a){this._path=[this._path,a];this.main.addLatLng(a);this.pulse.addLatLng(a);return this},setLatLngs:function(a){this._path=a;this.main.setLatLngs(a);this.pulse.setLatLngs(a);return this},getLatLngs:function(){return this.main.getLatLngs()},spliceLatLngs:function(a){var b=this.main.spliceLatLngs(a);this.pulse.spliceLatLngs(a);return b},getBounds:function(){return this.main.getBounds()},toGeoJSON:function(){return this.main.toGeoJSON()}});
G.polyline.antPath=function(a,b){return new G.AntPath(a,b)};(function(a){G.Icon.Pulse=G.DivIcon.extend({options:{className:"",iconSize:[12,12],fillColor:"red",color:"red",animate:!0,heartbeat:1},initialize:function(a){G.setOptions(this,a);var b="lpi-"+(new Date).getTime()+"-"+Math.round(1E5*Math.random()),d=["background-color: "+this.options.fillColor],e=["box-shadow: 0 0 6px 2px "+this.options.color,"animation: pulsate "+this.options.heartbeat+"s ease-out","animation-iteration-count: infinite","animation-delay: "+(this.options.heartbeat+.1)+"s"];this.options.animate||
(e.push("animation: none"),e.push("box-shadow:none"));d=["."+b+"{"+d.join(";")+";}","."+b+":after{"+e.join(";")+";}"].join("");e=document.createElement("style");e.styleSheet?e.styleSheet.cssText=d:e.appendChild(document.createTextNode(d));document.getElementsByTagName("head")[0].appendChild(e);this.options.className=this.options.className+" goomap-pulsing-icon "+b;G.DivIcon.prototype.initialize.call(this,a)}});G.icon.pulse=function(a){return new G.Icon.Pulse(a)};G.Marker.Pulse=G.Marker.extend({initialize:function(a,
c){c.icon=G.icon.pulse(c);G.Marker.prototype.initialize.call(this,a,c)}});G.marker.pulse=function(a,c){return new G.Marker.Pulse(a,c)}})(window);G.Polyline.include({_snakingTimestamp:0,_snakingRings:0,_snakingVertices:0,_snakingDistance:0,_snaking:!1,snakeIn:function(){if(!this._snaking&&"performance"in window&&"now"in window.performance&&this._map)return this._snaking=!0,this._snakingTime=performance.now(),this._snakingVertices=this._snakingRings=this._snakingDistance=0,this._snakeLatLngs||(this._snakeLatLngs=G.LineUtil.isFlat(this._latlngs)?[this._latlngs]:this._latlngs),this._latlngs=[[this._snakeLatLngs[0][0],this._snakeLatLngs[0][0]]],
this._update(),this._snake(),this.fire("snakestart"),this},_snake:function(){var a=performance.now(),b=(a-this._snakingTime)*this.options.snakingSpeed/1E3;this._snakingTime=a;this._latlngs[this._snakingRings].pop();return this._snakeForward(b)},_snakeForward:function(a){if(this._map){var b=this._map.latLngToContainerPoint(this._snakeLatLngs[this._snakingRings][this._snakingVertices]),c=this._map.latLngToContainerPoint(this._snakeLatLngs[this._snakingRings][this._snakingVertices+1]),d=b.distanceTo(c);
if(this._snakingDistance+a>d){this._snakingVertices++;this._latlngs[this._snakingRings].push(this._snakeLatLngs[this._snakingRings][this._snakingVertices]);if(this._snakingVertices>=this._snakeLatLngs[this._snakingRings].length-1){if(this._snakingRings>=this._snakeLatLngs.length-1)return this._snakeEnd();this._snakingVertices=0;this._snakingRings++;this._latlngs[this._snakingRings]=[this._snakeLatLngs[this._snakingRings][this._snakingVertices]]}this._snakingDistance-=d;return this._snakeForward(a)}this._snakingDistance+=
a;a=this._snakingDistance/d;b=c.multiplyBy(a).add(b.multiplyBy(1-a));b=this._map.containerPointToLatLng(b);this._latlngs[this._snakingRings].push(b);this.setLatLngs(this._latlngs);this.fire("snake");G.Util.requestAnimFrame(this._snake,this)}},_snakeEnd:function(){this.setLatLngs(this._snakeLatLngs);this._snaking=!1;this.fire("snakeend")}});G.Polyline.mergeOptions({snakingSpeed:200});
G.LayerGroup.include({_snakingLayers:[],_snakingLayersDone:0,snakeIn:function(){if("performance"in window&&"now"in window.performance&&this._map&&!this._snaking){this._snaking=!0;this._snakingLayers=[];this._snakingLayersDone=0;var a=Object.keys(this._layers),b;for(b in a)this._snakingLayers.push(this._layers[a[b]]);this.clearLayers();this.fire("snakestart");return this._snakeNext()}},_snakeNext:function(){if(this._snakingLayersDone>=this._snakingLayers.length)this.fire("snakeend"),this._snaking=
!1;else{var a=this._snakingLayers[this._snakingLayersDone];this._snakingLayersDone++;this.addLayer(a);"snakeIn"in a?(a.once("snakeend",function(){setTimeout(this._snakeNext.bind(this),this.options.snakingPause)},this),a.snakeIn()):setTimeout(this._snakeNext.bind(this),this.options.snakingPause);this.fire("snake");return this}}});G.LayerGroup.mergeOptions({snakingPause:200});G.interpolatePosition=function(a,b,c,d){c=d/c;c=0<c?c:0;c=1<c?1:c;return G.latLng(a.lat+c*(b.lat-a.lat),a.lng+c*(b.lng-a.lng))};
G.Marker.MovingMarker=G.Marker.extend({statics:{notStartedState:0,endedState:1,pausedState:2,runState:3},options:{autostart:!1,loop:!1,angles:[]},initialize:function(a,b,c){G.Marker.prototype.initialize.call(this,a[0],c);this._latlngs=a.map(function(a,b){return G.latLng(a)});this._durations=b instanceof Array?b:this._createDurations(this._latlngs,b);this._angles=c.angles&&0<c.angles.length?c.angles:this._createAngles(this._latlngs);this._currentAngle=this._currentIndex=this._currentDuration=0;this._state=
G.Marker.MovingMarker.notStartedState;this._animId=this._pauseStartTime=this._startTimeStamp=this._startTime=0;this._animRequested=!1;this._currentLine=[];this._stations={}},isRunning:function(){return this._state===G.Marker.MovingMarker.runState},isEnded:function(){return this._state===G.Marker.MovingMarker.endedState},isStarted:function(){return this._state!==G.Marker.MovingMarker.notStartedState},isPaused:function(){return this._state===G.Marker.MovingMarker.pausedState},start:function(){this.isRunning()||
(this.isPaused()?this.resume():(this._loadLine(0),this._startAnimation(),this.fire("start")))},resume:function(){this.isPaused()&&(this._currentLine[0]=this.getLatLng(),this._currentDuration-=this._pauseStartTime-this._startTime,this._startAnimation())},pause:function(){this.isRunning()&&(this._pauseStartTime=Date.now(),this._state=G.Marker.MovingMarker.pausedState,this._stopAnimation(),this._updatePosition())},stop:function(a){this.isEnded()||(this._stopAnimation(),"undefined"===typeof a&&(a=0,this._updatePosition()),
this._state=G.Marker.MovingMarker.endedState,this.fire("end",{elapsedTime:a}))},addLatLng:function(a,b){this._latlngs.push(G.latLng(a));this._durations.push(b)},moveTo:function(a,b){this._stopAnimation();this._latlngs=[this.getLatLng(),G.latLng(a)];this._durations=[b];this._state=G.Marker.MovingMarker.notStartedState;this.start();this.options.loop=!1},addStation:function(a,b){a>this._latlngs.length-2||1>a||(this._stations[a]=b)},onAdd:function(a){G.Marker.prototype.onAdd.call(this,a);this.options.autostart&&
!this.isStarted()?this.start():this.isRunning()&&this._resumeAnimation()},onRemove:function(a){G.Marker.prototype.onRemove.call(this,a);this._stopAnimation()},_createDurations:function(a,b){for(var c=a.length-1,d=[],e=0,g,h=0;h<c;h++)g=a[h+1].distanceTo(a[h]),d.push(g),e+=g;c=b/e;e=[];for(h=0;h<d.length;h++)e.push(d[h]*c);return e},_createAngles:function(a){for(var b=a.length-1,c=[],d,e=0;e<b;e++)d=G.GeometryUtil.bearing(a[e],a[e+1]),c.push(d/2);return c},_startAnimation:function(){this._state=G.Marker.MovingMarker.runState;
this._animId=G.Util.requestAnimFrame(function(a){this._startTime=Date.now();this._startTimeStamp=a;this._animate(a)},this,!0);this._animRequested=!0},_resumeAnimation:function(){this._animRequested||(this._animRequested=!0,this._animId=G.Util.requestAnimFrame(function(a){this._animate(a)},this,!0))},_stopAnimation:function(){this._animRequested&&(G.Util.cancelAnimFrame(this._animId),this._animRequested=!1)},_updatePosition:function(){var a=Date.now()-this._startTime;this._animate(this._startTimeStamp+
a,!0)},_loadLine:function(a){this._currentIndex=a;this._currentDuration=this._durations[a];this._currentAngle=this._angles[a];this._currentLine=this._latlngs.slice(a,a+2)},_updateLine:function(a){var b=a-this._startTimeStamp;if(b<=this._currentDuration)return b;for(var c=this._currentIndex,d=this._currentDuration;b>d;){b-=d;d=this._stations[c+1];if(void 0!==d){if(b<d)return this.setLatLng(this._latlngs[c+1]),null;b-=d}c++;if(c>=this._latlngs.length-1)if(this.options.loop)c=0,this.fire("loop",{elapsedTime:b});
else return this.setLatLng(this._latlngs[this._latlngs.length-1]),this.stop(b),null;d=this._durations[c]}this._loadLine(c);this._startTimeStamp=a-b;this._startTime=Date.now()-b;return b},_animate:function(a,b){this._animRequested=!1;var c=this._updateLine(a);this.isEnded()||(null!=c&&(c=G.interpolatePosition(this._currentLine[0],this._currentLine[1],this._currentDuration,c),this.setLatLng(c),this.fire("animating",{latLng:c}),this.options.rotationAngle=this._currentAngle),b||(this._animId=G.Util.requestAnimFrame(this._animate,
this,!1),this._animRequested=!0))}});G.Marker.movingMarker=function(a,b,c){return new G.Marker.MovingMarker(a,b,c)};(function(){var a=function(a,b){if(4!==a.length)return!1;var c,d=0,h=0;for(c=0;4>c;c++){if(a[c].x!==b.min.x&&a[c].x!==b.max.x||a[c].y!==b.min.y&&a[c].y!==b.max.y)return!1;d+=a[c].x;h+=a[c].y}return d===2*(b.min.x+b.max.x)&&h===2*(b.min.y+b.max.y)},b={_toMercGeometry:function(a,b){var c=[],d,h,k,m,l,p;b||(a[0]instanceof Array?a[0][0]instanceof Array||(a=[a]):a=[[a]]);for(d=0;d<a.length;d++){m=[];for(h=0;h<a[d].length;h++){l=[];for(k=0;k<a[d][h].length;k++)p=b?G.latLng(a[d][h][k][1],a[d][h][k][0]):
a[d][h][k],l.push(this._map.project(p,0));m.push(l)}c.push(m)}return c},_getOriginalMercBoundary:function(){if(this._mercBoundary)return this._mercBoundary;var a,b;if(G.Util.isArray(this.options.boundary))this._mercBoundary=this._toMercGeometry(this.options.boundary);else{this._mercBoundary=[];var e=function(a){"GeometryCollection"===a.type?a.geometries.forEach(e):"Feature"===a.type?e(a.geometry):"FeatureCollection"===a.type?a.features.forEach(e):"Polygon"===a.type?this._mercBoundary=this._mercBoundary.concat(this._toMercGeometry([a.coordinates],
!0)):"MultiPolygon"===a.type&&(this._mercBoundary=this._mercBoundary.concat(this._toMercGeometry(a.coordinates,!0)))}.bind(this);e(this.options.boundary)}this._mercBbox=new G.Bounds;for(b=0;b<this._mercBoundary.length;b++)a=new G.Bounds(this._mercBoundary[b][0]),this._mercBbox.extend(a.min),this._mercBbox.extend(a.max);return this._mercBoundary},_getClippedGeometry:function(b,d){var c=[],g,h,k,m;for(k=0;k<b.length;k++)if(g=[],h=G.PolyUtil.clipPolygon(b[k][0],d),0!==h.length){g.push(h);for(m=1;m<b[k].length;m++)h=
G.PolyUtil.clipPolygon(b[k][m],d),0<h.length&&g.push(h);c.push(g)}if(0===c.length)return{isOut:!0};for(k=0;k<c.length;k++){if(a(c[k][0],d)){if(1===c[k].length)return{isIn:!0}}else return{geometry:c};for(m=1;m<c[k].length;m++)if(!a(c[k][m],d))return{geometry:c}}return{isOut:!0}},_getTileGeometry:function(a,b,e,g){if(!this.options.boundary)return{isIn:!0};var c=a+":"+b+":"+e,d=Math.pow(2,e),m=this._boundaryCache;if(m[c])return m[c];var l=this._getOriginalMercBoundary(),p=this.options.tileSize,d=new G.Bounds(new G.Point(a*
p/d,b*p/d),new G.Point((a+1)*p/d,(b+1)*p/d));if(!g&&!d.intersects(this._mercBbox))return{isOut:!0};if(0===e)return m[c]={geometry:l},m[c];a=this._getTileGeometry(Math.floor(a/2),Math.floor(b/2),e-1,!0);if(a.isOut||a.isIn)return a;m[c]=this._getClippedGeometry(a.geometry,d);return m[c]},_drawTileInternal:function(a,b,e,g){var c=this._getZoomForUrl(),d=this._getTileGeometry(b.x,b.y,c);if(d.isOut)g();else{var m=this.options.tileSize,l=m*b.x,p=m*b.y,q=Math.pow(2,c),r=a.getContext("2d"),u=new Image,D=
function(){var b,c,e,h;if(!d.isIn){h=d.geometry;r.beginPath();for(b=0;b<h.length;b++)for(c=0;c<h[b].length;c++)if(0!==h[b][c].length)for(r.moveTo(h[b][c][0].x*q-l,h[b][c][0].y*q-p),e=1;e<h[b][c].length;e++)r.lineTo(h[b][c][e].x*q-l,h[b][c][e].y*q-p);r.clip()}b=r.createPattern(u,"repeat");r.beginPath();r.rect(0,0,a.width,a.height);r.fillStyle=b;r.fill();g()};this.options.crossOrigin&&(u.crossOrigin="");u.onload=function(){a.complete=!0;setTimeout(D,0)};u.src=e}},onAdd:function(a){(G.TileLayer.Canvas||
G.TileLayer).prototype.onAdd.call(this,a);this.options.trackAttribution&&(a.on("moveend",this._updateAttribution,this),this._updateAttribution())},onRemove:function(a){(G.TileLayer.Canvas||G.TileLayer).prototype.onRemove.call(this,a);if(this.options.trackAttribution&&(a.off("moveend",this._updateAttribution,this),!this._attributionRemoved)){var b=G.TileLayer.BoundaryCanvas.prototype.getAttribution.call(this);a.attributionControl.removeAttribution(b)}},_updateAttribution:function(){var a=this._getOriginalMercBoundary(),
b=this._map.getBounds(),b=G.bounds(this._map.project(b.getSouthWest(),0),this._map.project(b.getNorthEast(),0)),a=this._getClippedGeometry(a,b);this._attributionRemoved!==!!a.isOut&&(b=G.TileLayer.BoundaryCanvas.prototype.getAttribution.call(this),this._map.attributionControl[a.isOut?"removeAttribution":"addAttribution"](b),this._attributionRemoved=!!a.isOut)}};G.TileLayer.BoundaryCanvas="0.8"<=G.version?G.TileLayer.extend({options:{boundary:null},includes:b,initialize:function(a,b){G.TileLayer.prototype.initialize.call(this,
a,b);this._boundaryCache={};this._mercBbox=this._mercBoundary=null;this.options.trackAttribution&&(this._attributionRemoved=!0,this.getAttribution=null)},createTile:function(a,b){var c=document.createElement("canvas"),d=this.getTileUrl(a);c.width=c.height=this.options.tileSize;this._drawTileInternal(c,a,d,G.bind(b,null,null,c));return c}}):G.TileLayer.Canvas.extend({options:{boundary:null},includes:b,initialize:function(a,b){G.Util.setOptions(this,b);G.Util.setOptions(this,{async:!0});this._url=a;
this._boundaryCache={};this._mercBbox=this._mercBoundary=null;this.options.trackAttribution&&(this._attributionRemoved=!0,this.getAttribution=null)},drawTile:function(a,b){var c=G.extend({},b);this._adjustTilePoint(c);c=this.getTileUrl(c);this._drawTileInternal(a,b,c,G.bind(this.tileDrawn,this,a));this._getTileSize()!==this.options.tileSize&&(a.style.width=a.style.height=this._getTileSize()+"px")}});G.TileLayer.boundaryCanvas=function(a,b){return new G.TileLayer.BoundaryCanvas(a,b)};G.TileLayer.BoundaryCanvas.createFromLayer=
function(a,b){return new G.TileLayer.BoundaryCanvas(a._url,G.extend({},a.options,b))}})();
